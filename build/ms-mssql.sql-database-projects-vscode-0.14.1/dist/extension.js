!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=124)}([function(e,t){e.exports=require("path")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.okString=t.noStringDefault=t.noString=t.openEulaString=t.yesString=t.sqlConnectionStringFriendly=t.databaseReferencesNodeName=t.dataSourcesNodeName=t.vscodeOpenCommand=t.schemaCompareStartCommand=t.revealFileInOsCommand=t.at=t.msec=t.sec=t.min=t.hr=t.InProgress=t.Failed=t.Success=t.PublishHistory=t.BuildHistory=t.TargetDatabase=t.TargetServer=t.TargetPlatform=t.Date=t.Time=t.Status=t.changeTargetPlatformAction=t.publishAction=t.buildAction=t.schemaCompareAction=t.addItemAction=t.edgeProjectTypeDescription=t.edgeProjectTypeDisplayName=t.edgeSqlDatabaseProjectTypeId=t.emptyProjectTypeDescription=t.emptyProjectTypeDisplayName=t.emptySqlDatabaseProjectTypeId=t.sqlProjectSdk=t.databaseSchemaProvider=t.MicrosoftDatatoolsSchemaSqlSql=t.msdbDacpac=t.msdb=t.masterDacpac=t.master=t.schemaCompareExtensionId=t.openApiSpecFileExtensions=t.sqlFileExtension=t.sqlprojExtension=t.dataSourcesFileName=void 0,t.done=t.selectDatabase=t.newText=t.enterNewDatabaseName=t.createNew=t.resetAllVars=t.enterNewValueForVar=t.chooseSqlcmdVarsToModify=t.chooseAction=t.browseForProfileWithIcon=t.dontUseProfile=t.selectProfile=t.selectProfileToUse=t.defaultUser=t.server=t.selectConnection=t.profile=t.loadSqlCmdVarsButtonTitle=t.sqlCmdValueColumn=t.sqlCmdVariableColumn=t.sqlCmdVariables=t.profileReadError=t.loadProfilePlaceholderText=t.noDataSourcesText=t.dataSourceDropdownTitle=t.connectionRadioButtonLabel=t.dataSourceRadioButtonLabel=t.targetConnectionLabel=t.databaseNameLabel=t.generateScriptButtonText=t.cancelButtonText=t.publish=t.publishDialogName=t.currentTargetPlatform=t.selectTargetPlatform=t.deleteReferenceConfirmation=t.deleteConfirmationContents=t.deleteConfirmation=t.newObjectNamePrompt=t.reloadProject=t.location=t.defaultProjectNameStarter=t.schemaObjectType=t.schema=t.objectType=t.flat=t.file=t.publishSettingsFiles=t.dacpacFiles=t.selectString=void 0,t.dockerImageEulaMessage=t.dockerImageMessage=t.cleaningDockerImagesMessage=t.publishingProjectMessage=t.publishProjectSucceed=t.deployDbTaskName=t.enterConnectionStringEnvNameDescription=t.appSettingPrompt=t.enterConnStringTemplateDescription=t.azureFunctionLocalSettingsFileName=t.defaultConnectionStringTemplate=t.defaultConnectionStringEnvVarName=t.defaultLocalServerAdminName=t.defaultLocalServerName=t.defaultPortNumber=t.startCommandName=t.dockerFileName=t.mssqlFolderName=t.commandsFolderName=t.azureSqlEdgeDockerRepository=t.sqlServerDockerRepository=t.sqlServerDockerRegistry=t.connectionNamePrefix=t.sqlServerEdgeEulaLink=t.sqlServerEulaLink=t.edgeEulaAgreementTitle=t.eulaAgreementTitle=t.eulaAgreementText=t.eulaAgreementTemplate=t.dockerImageNamePrefix=t.dockerImageLabelPrefix=t.valueCannotBeEmpty=t.portMustBeNumber=t.passwordNotMatch=t.invalidSQLPasswordMessage=t.selectBaseImage=t.confirmPassword=t.enterPassword=t.enterConnectionStringTemplate=t.enterConnectionStringEnvName=t.publishTo=t.baseDockerImage=t.confirmServerPassword=t.serverPassword=t.serverPortNumber=t.enterPortNumber=t.publishToDockerContainer=t.publishToExistingServer=t.selectPublishOption=t.nameMustNotBeEmpty=void 0,t.sourceDatabase=t.createProjectDialogOkButtonText=t.createProjectFromDatabaseDialogName=t.referenceType=t.dacpacNotOnSameDrive=t.databaseProject=t.otherSeverVariable=t.otherServer=t.databaseNameServerNameVariableRequired=t.databaseNameRequiredVariableOptional=t.enterSystemDbName=t.exampleUsage=t.suppressMissingDependenciesErrors=t.serverVariable=t.serverName=t.databaseVariable=t.databaseName=t.locationDropdownValues=t.systemDbLocationDropdownValues=t.differentDbDifferentServer=t.differentDbSameServer=t.sameDatabase=t.selectDacpac=t.dacpacText=t.systemDatabase=t.projectLabel=t.referenceRadioButtonsGroupTitle=t.addDatabaseReferenceOkButtonText=t.addDatabaseReferenceDialogName=t.retryMessage=t.retryFailedMessage=t.retrySucceedMessage=t.retryRunMessage=t.retryWaitMessage=t.dockerLogMessage=t.dockerContainerCreatedMessage=t.connectionFailedError=t.deployAppSettingUpdating=t.deployAppSettingUpdateFailed=t.publishToContainerFailed=t.taskFailedError=t.checkoutOutputMessage=t.containerAlreadyExistForProject=t.deployProjectFailedMessage=t.connectingToSqlServerOnDockerMessage=t.dockerContainerFailedToRunErrorMessage=t.dockerContainerNotRunningErrorMessage=t.dockerNotRunningError=t.runningDockerMessage=t.creatingDeploymentSettingsMessage=void 0,t.unableToCreatePublishConnection=t.invalidProjectPropertyValue=t.invalidInput=t.folderAlreadyExistsChooseNewLocation=t.folderAlreadyExists=t.fileAlreadyExists=t.cannotResolvePath=t.fileOrFolderDoesNotExist=t.noFileExist=t.projectAlreadyExists=t.projectAlreadyOpened=t.externalStreamingJobValidationPassed=t.invalidProjectReload=t.prePostDeployCount=t.parentTreeItemUnknown=t.outsideFolderPath=t.databaseReferenceAlreadyExists=t.databaseSelectionRequired=t.invalidDatabaseReference=t.invalidDataSchemaProvider=t.databaseNameRequired=t.databaseLocationRequired=t.dacpacFileLocationRequired=t.systemDatabaseReferenceRequired=t.databaseReferenceTypeRequired=t.updateProjectDatabaseReferencesForRoundTrip=t.updateProjectForRoundTrip=t.buildFailedCannotStartSchemaCompare=t.schemaCompareNotInstalled=t.extractTargetRequired=t.invalidSqlConnectionString=t.unknownDataSourceType=t.unrecognizedDataSourcesVersion=t.missingVersion=t.noDataSourcesFile=t.noSqlProjFiles=t.multipleSqlProjFiles=t.ProjectDirectoryAlreadyExistError=t.ProjectParentDirectoryNotExistError=t.selectProjectLocation=t.browseEllipsisWithIcon=t.WorkspaceFileExtension=t.folderStructureLabel=t.selectFolderStructure=t.browseButtonText=t.projectLocationPlaceholderText=t.projectNamePlaceholderText=t.projectNameLabel=t.createProjectSettings=t.targetProject=void 0,t.Version=t.PackageReference=t.Files=t.Delete=t.BeforeBuildTarget=t.Name=t.Target=t.Condition=t.Project=t.Import=t.Remove=t.Include=t.Folder=t.Build=t.ItemGroup=t.DoNotAskAgain=t.Install=t.projectsOutputChannel=t.UpdateDotnetLocation=t.NetCoreSupportedVersionInstallationConfirmation=t.DotnetInstallationConfirmation=t.postDeployScriptFriendlyName=t.preDeployScriptFriendlyName=t.externalStreamingJobFriendlyName=t.externalStreamFriendlyName=t.fileFormatFriendlyName=t.dataSourceFriendlyName=t.storedProcedureFriendlyName=t.viewFriendlyName=t.tableFriendlyName=t.scriptFriendlyName=t.folderFriendlyName=t.folderObject=t.fileObject=t.excludeAction=t.deleteAction=t.errorReadingProject=t.invalidTargetPlatform=t.invalidGuid=t.unableToFindDatabaseReference=t.unableToFindSqlCmdVariable=t.cantAddCircularProjectReference=t.notValidVariableName=t.deployScriptExists=t.unableToFindObject=t.unableToPerformAction=t.unexpectedProjectContext=t.projBuildFailed=t.errorFindingBuildFilesLocation=t.circularProjectReference=void 0,t.SqlProjPathSeparator=t.All=t.VersionNumber=t.NETFrameworkAssembly=t.ProjJsonToClean=t.DacpacRootPath=t.RoundTripSqlDbNotPresentCondition=t.RoundTripSqlDbPresentCondition=t.SqlDbNotPresentCondition=t.SqlDbPresentCondition=t.NotNetCoreCondition=t.NetCoreCondition=t.MsBuildtargets=t.SqlDbTargets=t.NetCoreTargets=t.DefaultCollation=t.DefaultCollationProperty=t.DacpacReferenceElement=t.ProjectReferenceElement=t.ProjectReferenceNameElement=t.ImportElements=t.NoneElements=t.PostDeployElements=t.PreDeployElements=t.FolderElements=t.BuildElements=t.Sdk=t.ExternalStreamingJob=t.Type=t.ProjectGuid=t.Private=t.False=t.True=t.None=t.PostDeploy=t.PreDeploy=t.TargetConnectionString=t.ProjectReference=t.RelativeOuterPath=t.Properties=t.DSP=t.ServerSqlCmdVariable=t.DatabaseSqlCmdVariable=t.DatabaseVariableLiteralValue=t.SuppressMissingDependenciesErrors=t.ArtifactReference=t.Value=t.DefaultValue=t.SqlCmdVariable=t.PrivateAssets=void 0,t.selectSetting=t.connectionStringSetting=t.sqlTableToUpsert=t.sqlTableOrViewToQuery=t.selectAzureFunction=t.selectBindingType=t.output=t.input=t.sqlBindingsHelpLink=t.placeHolderObject=t.sqlExtensionPackageName=t.hostFileName=t.getTargetPlatformFromVersion=t.defaultDSP=t.defaultTargetPlatform=t.AzureDwFolder=t.targetPlatformToVersion=t.differentDbDifferentServerExampleUsage=t.differentDbSameServerExampleUsage=t.sameDatabaseExampleUsage=t.systemDbs=t.generatingProjectFromAutorest=t.autorestProjectName=t.specSelectionText=t.multipleMostDeploymentScripts=t.noSqlFilesGenerated=t.generatingProjectFailed=t.selectSpecFile=t.runViaNpx=t.installGlobally=t.userSelectionCancelled=t.userSelectionRunNpx=t.userSelectionInstallGlobally=t.nodeButNotAutorestFoundPrompt=t.nodeNotFound=t.nodeButNotAutorestFound=t.autorestPostDeploymentScriptName=t.DatabaseProjectItemType=t.sqlAuth=t.azureMfaAuth=t.integratedAuth=t.passwordSetting=t.userIdSetting=t.activeDirectoryInteractive=t.authenticationSetting=t.integratedSecuritySetting=t.dataSourceSetting=t.initialCatalogSetting=t.targetConnectionString=t.targetDatabaseName=void 0,t.addSqlBindingPackageError=t.addPackageReferenceMessage=t.moreInformation=t.jsonParseError=t.failedToParse=t.settingAlreadyExists=t.save=t.saveChangesInFile=t.enterConnectionString=t.enterConnectionStringSettingName=t.valueMustNotBeEmpty=t.sqlConnectionStringSetting=t.createNewLocalAppSettingWithIcon=t.createNewLocalAppSetting=t.addPackage=t.noAzureFunctionsProjectsInWorkspace=t.noAzureFunctionsInFile=t.connectionStringSettingPlaceholder=void 0;const n=r(50),o=r(3),i=n.loadMessageBundle(r(0).join(__dirname,"common/constants.ts"));t.dataSourcesFileName="datasources.json",t.sqlprojExtension=".sqlproj",t.sqlFileExtension=".sql",t.openApiSpecFileExtensions=["yaml","yml","json"],t.schemaCompareExtensionId="microsoft.schema-compare",t.master="master",t.masterDacpac="master.dacpac",t.msdb="msdb",t.msdbDacpac="msdb.dacpac",t.MicrosoftDatatoolsSchemaSqlSql="Microsoft.Data.Tools.Schema.Sql.Sql",t.databaseSchemaProvider="DatabaseSchemaProvider",t.sqlProjectSdk="Microsoft.Build.Sql",t.emptySqlDatabaseProjectTypeId="EmptySqlDbProj",t.emptyProjectTypeDisplayName=i(0,null),t.emptyProjectTypeDescription=i(1,null),t.edgeSqlDatabaseProjectTypeId="SqlDbEdgeProj",t.edgeProjectTypeDisplayName=i(2,null),t.edgeProjectTypeDescription=i(3,null),t.addItemAction=i(4,null),t.schemaCompareAction=i(5,null),t.buildAction=i(6,null),t.publishAction=i(7,null),t.changeTargetPlatformAction=i(8,null),t.Status=i(9,null),t.Time=i(10,null),t.Date=i(11,null),t.TargetPlatform=i(12,null),t.TargetServer=i(13,null),t.TargetDatabase=i(14,null),t.BuildHistory=i(15,null),t.PublishHistory=i(16,null),t.Success=i(17,null),t.Failed=i(18,null),t.InProgress=i(19,null),t.hr=i(20,null),t.min=i(21,null),t.sec=i(22,null),t.msec=i(23,null),t.at=i(24,null),t.revealFileInOsCommand="revealFileInOS",t.schemaCompareStartCommand="schemaCompare.start",t.vscodeOpenCommand="vscode.open",t.dataSourcesNodeName=i(25,null),t.databaseReferencesNodeName=i(26,null),t.sqlConnectionStringFriendly=i(27,null),t.yesString=i(28,null),t.openEulaString=i(29,null),t.noString=i(30,null),t.noStringDefault=i(31,null),t.okString=i(32,null),t.selectString=i(33,null),t.dacpacFiles=i(34,null),t.publishSettingsFiles=i(35,null),t.file=i(36,null),t.flat=i(37,null),t.objectType=i(38,null),t.schema=i(39,null),t.schemaObjectType=i(40,null),t.defaultProjectNameStarter=i(41,null),t.location=i(42,null),t.reloadProject=i(43,null),t.newObjectNamePrompt=function(e){return i(44,null,e)},t.deleteConfirmation=function(e){return i(45,null,e)},t.deleteConfirmationContents=function(e){return i(46,null,e)},t.deleteReferenceConfirmation=function(e){return i(47,null,e)},t.selectTargetPlatform=function(e){return i(48,null,e)},t.currentTargetPlatform=function(e,t){return i(49,null,e,t)},t.publishDialogName=i(50,null),t.publish=i(51,null),t.cancelButtonText=i(52,null),t.generateScriptButtonText=i(53,null),t.databaseNameLabel=i(54,null),t.targetConnectionLabel=i(55,null),t.dataSourceRadioButtonLabel=i(56,null),t.connectionRadioButtonLabel=i(57,null),t.dataSourceDropdownTitle=i(58,null),t.noDataSourcesText=i(59,null),t.loadProfilePlaceholderText=i(60,null);t.profileReadError=e=>i(61,null,o.getErrorMessage(e)),t.sqlCmdVariables=i(62,null),t.sqlCmdVariableColumn=i(63,null),t.sqlCmdValueColumn=i(64,null),t.loadSqlCmdVarsButtonTitle=i(65,null),t.profile=i(66,null),t.selectConnection=i(67,null),t.server=i(68,null),t.defaultUser=i(69,null),t.selectProfileToUse=i(70,null),t.selectProfile=i(71,null),t.dontUseProfile=i(72,null),t.browseForProfileWithIcon="$(folder) "+i(73,null),t.chooseAction=i(74,null),t.chooseSqlcmdVarsToModify=i(75,null);t.enterNewValueForVar=e=>i(76,null,e),t.resetAllVars=i(77,null),t.createNew=i(78,null),t.enterNewDatabaseName=i(79,null),t.newText=i(80,null),t.selectDatabase=i(81,null),t.done=i(82,null),t.nameMustNotBeEmpty=i(83,null),t.selectPublishOption=i(84,null),t.publishToExistingServer=i(85,null),t.publishToDockerContainer=i(86,null),t.enterPortNumber=i(87,null),t.serverPortNumber=i(88,null),t.serverPassword=i(89,null),t.confirmServerPassword=i(90,null),t.baseDockerImage=i(91,null),t.publishTo=i(92,null),t.enterConnectionStringEnvName=i(93,null),t.enterConnectionStringTemplate=i(94,null),t.enterPassword=i(95,null),t.confirmPassword=i(96,null),t.selectBaseImage=i(97,null),t.invalidSQLPasswordMessage=i(98,null),t.passwordNotMatch=i(99,null),t.portMustBeNumber=i(100,null),t.valueCannotBeEmpty=i(101,null),t.dockerImageLabelPrefix="source=sqldbproject",t.dockerImageNamePrefix="sqldbproject",t.eulaAgreementTemplate=i(102,null),t.eulaAgreementText=function(e){return i(103,null,e)},t.eulaAgreementTitle=i(104,null),t.edgeEulaAgreementTitle=i(105,null),t.sqlServerEulaLink="https://go.microsoft.com/fwlink/?linkid=857698",t.sqlServerEdgeEulaLink="https://go.microsoft.com/fwlink/?linkid=2139274",t.connectionNamePrefix="SQLDbProject",t.sqlServerDockerRegistry="mcr.microsoft.com",t.sqlServerDockerRepository="mssql/server",t.azureSqlEdgeDockerRepository="azure-sql-edge",t.commandsFolderName="commands",t.mssqlFolderName=".mssql",t.dockerFileName="Dockerfile",t.startCommandName="start.sh",t.defaultPortNumber="1433",t.defaultLocalServerName="localhost",t.defaultLocalServerAdminName="sa",t.defaultConnectionStringEnvVarName="SQLConnectionString",t.defaultConnectionStringTemplate="Data Source=@@SERVER@@,@@PORT@@;Initial Catalog=@@DATABASE@@;User id=@@USER@@;Password=@@SA_PASSWORD@@;",t.azureFunctionLocalSettingsFileName="local.settings.json",t.enterConnStringTemplateDescription=i(106,null),t.appSettingPrompt=i(107,null),t.enterConnectionStringEnvNameDescription=i(108,null),t.deployDbTaskName=i(109,null),t.publishProjectSucceed=i(110,null),t.publishingProjectMessage=i(111,null),t.cleaningDockerImagesMessage=i(112,null),t.dockerImageMessage=i(113,null),t.dockerImageEulaMessage=i(114,null),t.creatingDeploymentSettingsMessage=i(115,null),t.runningDockerMessage=i(116,null),t.dockerNotRunningError=function(e){return i(117,null,e||"")},t.dockerContainerNotRunningErrorMessage=i(118,null),t.dockerContainerFailedToRunErrorMessage=i(119,null),t.connectingToSqlServerOnDockerMessage=i(120,null),t.deployProjectFailedMessage=i(121,null),t.containerAlreadyExistForProject=i(122,null),t.checkoutOutputMessage=i(123,null),t.taskFailedError=function(e,t){return i(124,null,e,t)},t.publishToContainerFailed=function(e){return i(125,null,e)},t.deployAppSettingUpdateFailed=function(e){return i(126,null,e)},t.deployAppSettingUpdating=function(e){return i(127,null,e)},t.connectionFailedError=function(e){return i(128,null,e)},t.dockerContainerCreatedMessage=function(e){return i(129,null,e)},t.dockerLogMessage=function(e){return i(130,null,e)},t.retryWaitMessage=function(e,t){return i(131,null,e,t)},t.retryRunMessage=function(e,t,r){return i(132,null,e,t,r)},t.retrySucceedMessage=function(e,t){return i(133,null,e,t)},t.retryFailedMessage=function(e,t,r){return i(134,null,e,t,r)},t.retryMessage=function(e,t){return i(135,null,e,t||"")},t.addDatabaseReferenceDialogName=i(136,null),t.addDatabaseReferenceOkButtonText=i(137,null),t.referenceRadioButtonsGroupTitle=i(138,null),t.projectLabel=i(139,null),t.systemDatabase=i(140,null),t.dacpacText=i(141,null),t.selectDacpac=i(142,null),t.sameDatabase=i(143,null),t.differentDbSameServer=i(144,null),t.differentDbDifferentServer=i(145,null),t.systemDbLocationDropdownValues=[t.differentDbSameServer],t.locationDropdownValues=[t.sameDatabase,t.differentDbSameServer,t.differentDbDifferentServer],t.databaseName=i(146,null),t.databaseVariable=i(147,null),t.serverName=i(148,null),t.serverVariable=i(149,null),t.suppressMissingDependenciesErrors=i(150,null),t.exampleUsage=i(151,null),t.enterSystemDbName=i(152,null),t.databaseNameRequiredVariableOptional=i(153,null),t.databaseNameServerNameVariableRequired=i(154,null),t.otherServer="OtherServer",t.otherSeverVariable="OtherServer",t.databaseProject=i(155,null);t.dacpacNotOnSameDrive=e=>i(156,null,e),t.referenceType=i(157,null),t.createProjectFromDatabaseDialogName=i(158,null),t.createProjectDialogOkButtonText=i(159,null),t.sourceDatabase=i(160,null),t.targetProject=i(161,null),t.createProjectSettings=i(162,null),t.projectNameLabel=i(163,null),t.projectNamePlaceholderText=i(164,null),t.projectLocationPlaceholderText=i(165,null),t.browseButtonText=i(166,null),t.selectFolderStructure=i(167,null),t.folderStructureLabel=i(168,null),t.WorkspaceFileExtension=".code-workspace",t.browseEllipsisWithIcon="$(folder) "+i(169,null),t.selectProjectLocation=i(170,null);t.ProjectParentDirectoryNotExistError=e=>i(171,null,e);t.ProjectDirectoryAlreadyExistError=(e,t)=>i(172,null,e,t),t.multipleSqlProjFiles=i(173,null),t.noSqlProjFiles=i(174,null),t.noDataSourcesFile=i(175,null,t.dataSourcesFileName),t.missingVersion=i(176,null,t.dataSourcesFileName),t.unrecognizedDataSourcesVersion=i(177,null),t.unknownDataSourceType=i(178,null),t.invalidSqlConnectionString=i(179,null),t.extractTargetRequired=i(180,null),t.schemaCompareNotInstalled=i(181,null),t.buildFailedCannotStartSchemaCompare=i(182,null),t.updateProjectForRoundTrip=function(e){return i(183,null,e)},t.updateProjectDatabaseReferencesForRoundTrip=function(e){return i(184,null,e)},t.databaseReferenceTypeRequired=i(185,null),t.systemDatabaseReferenceRequired=i(186,null),t.dacpacFileLocationRequired=i(187,null),t.databaseLocationRequired=i(188,null),t.databaseNameRequired=i(189,null),t.invalidDataSchemaProvider=i(190,null),t.invalidDatabaseReference=i(191,null),t.databaseSelectionRequired=i(192,null),t.databaseReferenceAlreadyExists=i(193,null),t.outsideFolderPath=i(194,null),t.parentTreeItemUnknown=i(195,null),t.prePostDeployCount=i(196,null),t.invalidProjectReload=i(197,null),t.externalStreamingJobValidationPassed=i(198,null),t.projectAlreadyOpened=function(e){return i(199,null,e)},t.projectAlreadyExists=function(e,t){return i(200,null,e,t)},t.noFileExist=function(e){return i(201,null,e)},t.fileOrFolderDoesNotExist=function(e){return i(202,null,e)},t.cannotResolvePath=function(e){return i(203,null,e)},t.fileAlreadyExists=function(e){return i(204,null,e)},t.folderAlreadyExists=function(e){return i(205,null,e)},t.folderAlreadyExistsChooseNewLocation=function(e){return i(206,null,e)},t.invalidInput=function(e){return i(207,null,e)},t.invalidProjectPropertyValue=function(e){return i(208,null,e)},t.unableToCreatePublishConnection=function(e){return i(209,null,e)},t.circularProjectReference=function(e,t){return i(210,null,e,t)},t.errorFindingBuildFilesLocation=function(e){return i(211,null,o.getErrorMessage(e))},t.projBuildFailed=function(e){return i(212,null,e)},t.unexpectedProjectContext=function(e){return i(213,null,e)},t.unableToPerformAction=function(e,t){return i(214,null,e,t)},t.unableToFindObject=function(e,t){return i(215,null,e,t)},t.deployScriptExists=function(e){return i(216,null,e)},t.notValidVariableName=function(e){return i(217,null,e)},t.cantAddCircularProjectReference=function(e){return i(218,null,e)},t.unableToFindSqlCmdVariable=function(e){return i(219,null,e)},t.unableToFindDatabaseReference=function(e){return i(220,null,e)},t.invalidGuid=function(e){return i(221,null,e)},t.invalidTargetPlatform=function(e,t){return i(222,null,e,t.toString())},t.errorReadingProject=function(e,t){return i(223,null,e,t)},t.deleteAction=i(224,null),t.excludeAction=i(225,null),t.fileObject=i(226,null),t.folderObject=i(227,null),t.folderFriendlyName=i(228,null),t.scriptFriendlyName=i(229,null),t.tableFriendlyName=i(230,null),t.viewFriendlyName=i(231,null),t.storedProcedureFriendlyName=i(232,null),t.dataSourceFriendlyName=i(233,null),t.fileFormatFriendlyName=i(234,null),t.externalStreamFriendlyName=i(235,null),t.externalStreamingJobFriendlyName=i(236,null),t.preDeployScriptFriendlyName=i(237,null),t.postDeployScriptFriendlyName=i(238,null),t.DotnetInstallationConfirmation=i(239,null),t.NetCoreSupportedVersionInstallationConfirmation=function(e){return i(240,null,e)},t.UpdateDotnetLocation=i(241,null),t.projectsOutputChannel=i(242,null),t.Install=i(243,null),t.DoNotAskAgain=i(244,null),t.ItemGroup="ItemGroup",t.Build="Build",t.Folder="Folder",t.Include="Include",t.Remove="Remove",t.Import="Import",t.Project="Project",t.Condition="Condition",t.Target="Target",t.Name="Name",t.BeforeBuildTarget="BeforeBuild",t.Delete="Delete",t.Files="Files",t.PackageReference="PackageReference",t.Version="Version",t.PrivateAssets="PrivateAssets",t.SqlCmdVariable="SqlCmdVariable",t.DefaultValue="DefaultValue",t.Value="Value",t.ArtifactReference="ArtifactReference",t.SuppressMissingDependenciesErrors="SuppressMissingDependenciesErrors",t.DatabaseVariableLiteralValue="DatabaseVariableLiteralValue",t.DatabaseSqlCmdVariable="DatabaseSqlCmdVariable",t.ServerSqlCmdVariable="ServerSqlCmdVariable",t.DSP="DSP",t.Properties="Properties",t.RelativeOuterPath="..",t.ProjectReference="ProjectReference",t.TargetConnectionString="TargetConnectionString",t.PreDeploy="PreDeploy",t.PostDeploy="PostDeploy",t.None="None",t.True="True",t.False="False",t.Private="Private",t.ProjectGuid="ProjectGuid",t.Type="Type",t.ExternalStreamingJob="ExternalStreamingJob",t.Sdk="Sdk",t.BuildElements=i(245,null),t.FolderElements=i(246,null),t.PreDeployElements=i(247,null),t.PostDeployElements=i(248,null),t.NoneElements=i(249,null),t.ImportElements=i(250,null),t.ProjectReferenceNameElement=i(251,null),t.ProjectReferenceElement=i(252,null),t.DacpacReferenceElement=i(253,null),t.DefaultCollationProperty="DefaultCollation",t.DefaultCollation="SQL_Latin1_General_CP1_CI_AS",t.NetCoreTargets="$(NETCoreTargetsPath)\\Microsoft.Data.Tools.Schema.SqlTasks.targets",t.SqlDbTargets="$(SQLDBExtensionsRefPath)\\Microsoft.Data.Tools.Schema.SqlTasks.targets",t.MsBuildtargets="$(MSBuildExtensionsPath)\\Microsoft\\VisualStudio\\v$(VisualStudioVersion)\\SSDT\\Microsoft.Data.Tools.Schema.SqlTasks.targets",t.NetCoreCondition="'$(NetCoreBuild)' == 'true'",t.NotNetCoreCondition="'$(NetCoreBuild)' != 'true'",t.SqlDbPresentCondition="'$(SQLDBExtensionsRefPath)' != ''",t.SqlDbNotPresentCondition="'$(SQLDBExtensionsRefPath)' == ''",t.RoundTripSqlDbPresentCondition="'$(NetCoreBuild)' != 'true' AND '$(SQLDBExtensionsRefPath)' != ''",t.RoundTripSqlDbNotPresentCondition="'$(NetCoreBuild)' != 'true' AND '$(SQLDBExtensionsRefPath)' == ''",t.DacpacRootPath="$(DacPacRootPath)",t.ProjJsonToClean="$(BaseIntermediateOutputPath)\\project.assets.json",t.NETFrameworkAssembly="Microsoft.NETFramework.ReferenceAssemblies",t.VersionNumber="1.0.0",t.All="All",t.SqlProjPathSeparator="\\",t.targetDatabaseName="TargetDatabaseName",t.targetConnectionString="TargetConnectionString",t.initialCatalogSetting="Initial Catalog",t.dataSourceSetting="Data Source",t.integratedSecuritySetting="Integrated Security",t.authenticationSetting="Authentication",t.activeDirectoryInteractive="active directory interactive",t.userIdSetting="User ID",t.passwordSetting="Password",t.integratedAuth="Integrated",t.azureMfaAuth="AzureMFA",t.sqlAuth="SqlAuth",function(e){e.project="databaseProject.itemType.project",e.folder="databaseProject.itemType.folder",e.file="databaseProject.itemType.file",e.externalStreamingJob="databaseProject.itemType.file.externalStreamingJob",e.referencesRoot="databaseProject.itemType.referencesRoot",e.reference="databaseProject.itemType.reference",e.dataSourceRoot="databaseProject.itemType.dataSourceRoot"}(t.DatabaseProjectItemType||(t.DatabaseProjectItemType={})),t.autorestPostDeploymentScriptName="PostDeploymentScript.sql",t.nodeButNotAutorestFound=i(254,null),t.nodeNotFound=i(255,null),t.nodeButNotAutorestFoundPrompt=i(256,null),t.userSelectionInstallGlobally=i(257,null),t.userSelectionRunNpx=i(258,null),t.userSelectionCancelled=i(259,null),t.installGlobally=i(260,null),t.runViaNpx=i(261,null),t.selectSpecFile=i(262,null),t.generatingProjectFailed=function(e){return i(263,null,e)},t.noSqlFilesGenerated=i(264,null),t.multipleMostDeploymentScripts=function(e){return i(265,null,t.autorestPostDeploymentScriptName,e)},t.specSelectionText=i(266,null),t.autorestProjectName=i(267,null),t.generatingProjectFromAutorest=function(e){return i(268,null,e)},t.systemDbs=["master","msdb","tempdb","model"],t.sameDatabaseExampleUsage="SELECT * FROM [Schema1].[Table1]",t.differentDbSameServerExampleUsage=function(e){return`SELECT * FROM [${e}].[Schema1].[Table1]`},t.differentDbDifferentServerExampleUsage=function(e,t){return`SELECT * FROM [${e}].[${t}].[Schema1].[Table1]`},t.targetPlatformToVersion=new Map([["SQL Server 2005","90"],["SQL Server 2008","100"],["SQL Server 2012","110"],["SQL Server 2014","120"],["SQL Server 2016","130"],["SQL Server 2017","140"],["SQL Server 2019","150"],["Microsoft Azure SQL Database","AzureV12"],["Microsoft Azure SQL Data Warehouse","Dw"]]),t.AzureDwFolder="AzureDw",t.defaultTargetPlatform="SQL Server 2019",t.defaultDSP=t.targetPlatformToVersion.get(t.defaultTargetPlatform),t.getTargetPlatformFromVersion=function(e){return Array.from(t.targetPlatformToVersion.keys()).filter(r=>t.targetPlatformToVersion.get(r)===e)[0]},t.hostFileName="host.json",t.sqlExtensionPackageName="Microsoft.Azure.WebJobs.Extensions.Sql",t.placeHolderObject="[dbo].[table1]",t.sqlBindingsHelpLink="https://github.com/Azure/azure-functions-sql-extension/blob/main/README.md",t.input=i(269,null),t.output=i(270,null),t.selectBindingType=i(271,null),t.selectAzureFunction=i(272,null),t.sqlTableOrViewToQuery=i(273,null),t.sqlTableToUpsert=i(274,null),t.connectionStringSetting=i(275,null),t.selectSetting=i(276,null),t.connectionStringSettingPlaceholder=i(277,null),t.noAzureFunctionsInFile=i(278,null),t.noAzureFunctionsProjectsInWorkspace=i(279,null),t.addPackage=i(280,null),t.createNewLocalAppSetting=i(281,null),t.createNewLocalAppSettingWithIcon="$(add) "+t.createNewLocalAppSetting,t.sqlConnectionStringSetting="SqlConnectionString",t.valueMustNotBeEmpty=i(282,null),t.enterConnectionStringSettingName=i(283,null),t.enterConnectionString=i(284,null),t.saveChangesInFile=i(285,null),t.save=i(286,null),t.settingAlreadyExists=function(e){return i(287,null,e)},t.failedToParse=function(e){return i(288,null,t.azureFunctionLocalSettingsFileName,e)},t.jsonParseError=function(e,t,r){return i(289,null,e,t,r)},t.moreInformation=i(290,null),t.addPackageReferenceMessage=i(291,null,t.sqlExtensionPackageName),t.addSqlBindingPackageError=i(292,null)},function(e,t){e.exports=require("vscode")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFoldersInFolder=t.getSqlFilesInFolder=t.globWithPattern=t.showInfoMessageWithOutputChannel=t.showErrorMessageWithOutputChannel=t.isValidSQLPassword=t.isEmptyString=t.validateSqlServerPortNumber=t.getAllProjectsInFolder=t.detectCommandInstallation=t.retry=t.createFolderIfNotExist=t.getAzdataApi=t.timeConversion=t.getPackageInfo=t.getDefaultPublishDeploymentOptions=t.getVscodeMssqlApi=t.getAzureFunctionService=t.getSchemaCompareService=t.getDacFxService=t.getDataWorkspaceExtensionApi=t.getSqlProjectsInWorkspace=t.getSqlProjectFilesInFolder=t.isValidSqlCmdVariableName=t.formatSqlCmdVariable=t.removeSqlCmdVariableFormatting=t.readSqlCmdVariables=t.convertSlashesForSqlProj=t.getPlatformSafeFileEntryPath=t.getQuotedPath=t.exists=t.ensureTrailingSlash=t.trimChars=t.trimUri=t.getErrorMessage=void 0;const n=r(2),o=r(9),i=r(1),a=r(0),s=r(125),c=r(35),l=r(201),u=r(4);function p(e){return e instanceof Error?"string"==typeof e.message?e.message:"":"string"==typeof e?e:""+JSON.stringify(e,void 0,"\t")}function d(e){if(!e||""===e)return"";if(e.length>3){let t=(e=e.trim()).startsWith("$(")?2:0,r=e.endsWith(")")?1:0;(t>0||r>0)&&(e=e.substr(t,e.length-r-t))}return e.trim()}function h(){const e=y()?"Microsoft.data-workspace":"ms-mssql.data-workspace-vscode";return n.extensions.getExtension(e).exports}async function f(){if(y()){const e=n.extensions.getExtension("Microsoft.mssql");return(await e.activate()).schemaCompare}return(await m()).schemaCompare}async function m(){return n.extensions.getExtension("ms-mssql.mssql").activate()}t.getErrorMessage=p,t.trimUri=function(e,t){let r=e.path.split("/"),n=t.path.split("/");if(a.isAbsolute(t.path)&&r.length>0&&n.length>0&&r[0].toLowerCase()!==n[0].toLowerCase())throw new Error(i.outsideFolderPath);for(;r.length>0&&n.length>0&&r[0].toLocaleLowerCase()===n[0].toLocaleLowerCase();)r=r.slice(1),n=n.slice(1);for(;r.length>1;)n.unshift(i.RelativeOuterPath),r=r.slice(1);return n.join("/")},t.trimChars=function(e,t){let r=e,n=0;for(;t.includes(r[n]);)n++;for(r=r.substr(n),n=0;t.includes(r[r.length-n-1]);)n++;return r=r.substring(0,r.length-n),r},t.ensureTrailingSlash=function(e,t=i.SqlProjPathSeparator){return e.endsWith(t)?e:e+t},t.exists=async function(e){try{return await u.promises.access(e),!0}catch{return!1}},t.getQuotedPath=function(e){return"win32"===o.platform()?function(e){return'"'+(e=e.split("\\").join("\\\\").split('"').join(""))+'"'}(e):function(e){return'"'+(e=e.split("\\").join("/").split('"').join(""))+'"'}(e)},t.getPlatformSafeFileEntryPath=function(e){return e.includes("\\")?e.split("\\").join("/"):e},t.convertSlashesForSqlProj=function(e){return e.includes("/")?e.split("/").join(i.SqlProjPathSeparator):e},t.readSqlCmdVariables=function(e,t){var r;let n={};for(let o=0;o<(null===(r=e.documentElement.getElementsByTagName(i.SqlCmdVariable))||void 0===r?void 0:r.length);o++){const r=e.documentElement.getElementsByTagName(i.SqlCmdVariable)[o],a=r.getAttribute(i.Include);t||void 0===r.getElementsByTagName(i.DefaultValue)[0]?n[a]=r.getElementsByTagName(i.Value)[0].childNodes[0].nodeValue:n[a]=r.getElementsByTagName(i.DefaultValue)[0].childNodes[0].nodeValue}return n},t.removeSqlCmdVariableFormatting=d,t.formatSqlCmdVariable=function(e){return e&&""!==e?((e=e.trim()).startsWith("$(")||e.endsWith(")")?e.startsWith("$(")&&!e.endsWith(")")&&(e+=")"):e=`$(${e})`,e):e},t.isValidSqlCmdVariableName=function(e){return!(!(e=d(e))||""===e.trim()||e.includes(" "))&&!(e.includes("$")||e.includes("@")||e.includes("#")||e.includes('"')||e.includes("'")||e.includes("-"))},t.getSqlProjectFilesInFolder=async function(e){const t=s.escapePath(e.replace(/\\/g,"/")),r=a.posix.join(t,"**","*.sqlproj");return await s(r)},t.getSqlProjectsInWorkspace=function(){return h().getProjectsInWorkspace(i.sqlprojExtension)},t.getDataWorkspaceExtensionApi=h,t.getDacFxService=async function(){if(y()){const e=n.extensions.getExtension("Microsoft.mssql");return(await e.activate()).dacFx}return(await m()).dacFx},t.getSchemaCompareService=f,t.getAzureFunctionService=async function(){if(y())throw new Error("Azure Functions service is not supported in Azure Data Studio");return(await m()).azureFunctions},t.getVscodeMssqlApi=m,t.getDefaultPublishDeploymentOptions=async function(e){const t=await f(),r=await t.schemaCompareGetDefaultOptions(),n=r.defaultDeploymentOptions;return y(),n.excludeObjectTypes=n.excludeObjectTypes.filter(e=>53!==e),e.databaseReferences.length>0&&(n.includeCompositeObjects=!0),r.defaultDeploymentOptions},t.getPackageInfo=function(e){if(e||(e=r(205)),e)return{name:e.name,fullName:`${e.publisher}.${e.name}`,version:e.version,aiKey:e.aiKey}},t.timeConversion=function(e){const t=[],r=Math.trunc(e/36e5);r>0&&(t.push(`${r} ${i.hr}`),e-=36e5*r);const n=Math.trunc(e/6e4);n>0&&(t.push(`${n} ${i.min}`),e-=6e4*n);const o=Math.trunc(e/1e3);return o>0&&t.push(`${o} ${i.sec}`),0===r&&0===n&&0===o&&t.push(`${e} ${i.msec}`),t.join(", ")};let g=void 0;try{g=r(91),(null==g?void 0:g.version)||(g=void 0)}catch{}function y(){return g}t.getAzdataApi=y,t.createFolderIfNotExist=async function(e){try{await c.mkdir(e)}catch{}},t.retry=async function(e,t,r,n,o,a=10,s=2){for(let c=0;c<a;c++){o.appendLine(i.retryWaitMessage(s,e)),await new Promise(e=>setTimeout(e,1e3*s)),o.appendLine(i.retryRunMessage(c,a,e));try{let a=await t();const s=await r(a),c=await n(a);if(s.validated)return o.appendLine(i.retrySucceedMessage(e,c)),a;o.appendLine(i.retryFailedMessage(e,c,s.errorMessage))}catch(t){o.appendLine(i.retryMessage(e,t))}}},t.detectCommandInstallation=async function(e){try{if(await l(e))return!0}catch(e){console.log(p(e))}return!1},t.getAllProjectsInFolder=async function(e,t){const r=s.escapePath(e.fsPath.replace(/\\/g,"/")),o=a.posix.join(r,"**","*"+t);return(await s(o)).map(e=>n.Uri.file(a.resolve(e)))},t.validateSqlServerPortNumber=function(e){if(!e)return!1;const t=+e;return!isNaN(t)&&t>0&&t<65535},t.isEmptyString=function(e){return void 0===e||""===e},t.isValidSQLPassword=function(e,t="sa"){const r=e&&void 0!==t&&e.toUpperCase().includes(t.toUpperCase()),n=/[A-Z]/.test(e)?1:0,o=/[a-z]/.test(e)?1:0,i=/\d/.test(e)?1:0,a=/\W/.test(e)?1:0;return!r&&e.length>=8&&e.length<=128&&n+o+i+a>=3},t.showErrorMessageWithOutputChannel=async function(e,t,r){await n.window.showErrorMessage(e(p(t)),i.checkoutOutputMessage)===i.checkoutOutputMessage&&r.show()},t.showInfoMessageWithOutputChannel=async function(e,t){await n.window.showInformationMessage(e,i.checkoutOutputMessage)===i.checkoutOutputMessage&&t.show()},t.globWithPattern=async function(e){const t=e.replace(/\\/g,"/");return await s(t)},t.getSqlFilesInFolder=async function(e,t){e=e.replace(/\\/g,"/");const r=a.posix.join(e,"**","*.sql");if(t){const t=a.posix.join(e,"bin","**","*.sql"),n=a.posix.join(e,"obj","**","*.sql");return await s(r,{ignore:[t,n]})}return await s(r)},t.getFoldersInFolder=async function(e,t){const r=s.escapePath(e.replace(/\\/g,"/")),n=a.posix.join(r,"/**");if(t){const e=a.posix.join(r,"bin"),t=a.posix.join(r,"obj");return await s(n,{onlyDirectories:!0,ignore:[e,t]})}return await s(n,{onlyDirectories:!0})}},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(94),o=r(94);t.makePatchingRequire=o.makePatchingRequire;var i=function(e){return!0},a=function(){function e(){this.version=r(215).version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(e){var t=this.subscribers[e];return!!t&&t.some((function(e){var t=e.filter;return!t||t(!1)}))},e.prototype.publish=function(e,t){if(!this.currentlyPublishing){var r=this.subscribers[e];if(r){var n={timestamp:Date.now(),data:t};this.currentlyPublishing=!0,r.forEach((function(e){var t=e.listener,r=e.filter;try{r&&r(!0)&&t(n)}catch(e){}})),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(e,t,r){void 0===r&&(r=i),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:t,filter:r})},e.prototype.unsubscribe=function(e,t,r){void 0===r&&(r=i);var n=this.subscribers[e];if(n)for(var o=0;o<n.length;++o)if(n[o].listener===t&&n[o].filter===r)return n.splice(o,1),!0;return!1},e.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(e){return e},Object.getOwnPropertyNames(this.knownPatches).forEach((function(t){return delete e.knownPatches[t]}))},e.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},e.prototype.addContextPreservation=function(e){var t=this.contextPreservationFunction;this.contextPreservationFunction=function(r){return e(t(r))}},e.prototype.registerMonkeyPatch=function(e,t){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(t)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new a,r(95).prototype.require=n.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));t.channel=global.diagnosticsSource},function(e,t,r){var n,o,i=r(4),a=r(179),s=r(180),c=r(181),l=r(20);function u(e,t){Object.defineProperty(e,n,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(n=Symbol.for("graceful-fs.queue"),o=Symbol.for("graceful-fs.previous")):(n="___graceful-fs.queue",o="___graceful-fs.previous");var p,d=function(){};if(l.debuglog?d=l.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(d=function(){var e=l.format.apply(l,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!i[n]){var h=global[n]||[];u(i,h),i.close=function(e){function t(t,r){return e.call(i,t,(function(e){e||g(),"function"==typeof r&&r.apply(this,arguments)}))}return Object.defineProperty(t,o,{value:e}),t}(i.close),i.closeSync=function(e){function t(t){e.apply(i,arguments),g()}return Object.defineProperty(t,o,{value:e}),t}(i.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){d(i[n]),r(26).equal(i[n].length,0)}))}function f(e){a(e),e.gracefulify=f,e.createReadStream=function(t,r){return new e.ReadStream(t,r)},e.createWriteStream=function(t,r){return new e.WriteStream(t,r)};var t=e.readFile;e.readFile=function(e,r,n){"function"==typeof r&&(n=r,r=null);return function e(r,n,o,i){return t(r,n,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof o&&o.apply(this,arguments):m([e,[r,n,o],t,i||Date.now(),Date.now()])}))}(e,r,n)};var r=e.writeFile;e.writeFile=function(e,t,n,o){"function"==typeof n&&(o=n,n=null);return function e(t,n,o,i,a){return r(t,n,o,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,n,o,i],r,a||Date.now(),Date.now()])}))}(e,t,n,o)};var n=e.appendFile;n&&(e.appendFile=function(e,t,r,o){"function"==typeof r&&(o=r,r=null);return function e(t,r,o,i,a){return n(t,r,o,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,r,o,i],n,a||Date.now(),Date.now()])}))}(e,t,r,o)});var o=e.copyFile;o&&(e.copyFile=function(e,t,r,n){"function"==typeof r&&(n=r,r=0);return function e(t,r,n,i,a){return o(t,r,n,(function(o){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof i&&i.apply(this,arguments):m([e,[t,r,n,i],o,a||Date.now(),Date.now()])}))}(e,t,r,n)});var i=e.readdir;if(e.readdir=function(e,t,r){"function"==typeof t&&(r=t,t=null);return function e(t,r,n,o){return i(t,r,(function(i,a){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?(a&&a.sort&&a.sort(),"function"==typeof n&&n.call(this,i,a)):m([e,[t,r,n],i,o||Date.now(),Date.now()])}))}(e,t,r)},"v0.8"===process.version.substr(0,4)){var c=s(e);h=c.ReadStream,g=c.WriteStream}var l=e.ReadStream;l&&(h.prototype=Object.create(l.prototype),h.prototype.open=function(){var e=this;v(e.path,e.flags,e.mode,(function(t,r){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r),e.read())}))});var u=e.WriteStream;u&&(g.prototype=Object.create(u.prototype),g.prototype.open=function(){var e=this;v(e.path,e.flags,e.mode,(function(t,r){t?(e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return g},set:function(e){g=e},enumerable:!0,configurable:!0});var p=h;Object.defineProperty(e,"FileReadStream",{get:function(){return p},set:function(e){p=e},enumerable:!0,configurable:!0});var d=g;function h(e,t){return this instanceof h?(l.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}function g(e,t){return this instanceof g?(u.apply(this,arguments),this):g.apply(Object.create(g.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var y=e.open;function v(e,t,r,n){return"function"==typeof r&&(n=r,r=null),function e(t,r,n,o,i){return y(t,r,n,(function(a,s){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?"function"==typeof o&&o.apply(this,arguments):m([e,[t,r,n,o],a,i||Date.now(),Date.now()])}))}(e,t,r,n)}return e.open=v,e}function m(e){d("ENQUEUE",e[0].name,e[1]),i[n].push(e),y()}function g(){for(var e=Date.now(),t=0;t<i[n].length;++t)i[n][t].length>2&&(i[n][t][3]=e,i[n][t][4]=e);y()}function y(){if(clearTimeout(p),p=void 0,0!==i[n].length){var e=i[n].shift(),t=e[0],r=e[1],o=e[2],a=e[3],s=e[4];if(void 0===a)d("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-a>=6e4){d("TIMEOUT",t.name,r);var c=r.pop();"function"==typeof c&&c.call(null,o)}else{var l=Date.now()-s,u=Math.max(s-a,1);l>=Math.min(1.2*u,100)?(d("RETRY",t.name,r),t.apply(null,r.concat([a]))):i[n].push(e)}void 0===p&&(p=setTimeout(y,0))}}global[n]||u(global,i[n]),e.exports=f(c(i)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!i.__patched&&(e.exports=f(i),i.__patched=!0)},function(e,t,r){"use strict";var n=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();e.exports=n},function(e,t,r){const n=r(45),{MAX_LENGTH:o,MAX_SAFE_INTEGER:i}=r(44),{re:a,t:s}=r(24),c=r(46),{compareIdentifiers:l}=r(67);class u{constructor(e,t){if(t=c(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],o=e.prerelease[t];if(n("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return l(r,o)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const r=this.build[t],o=e.build[t];if(n("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return l(r,o)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=u},function(e,t){e.exports=require("os")},function(e,t,r){"use strict";t.fromCallback=function(e){return Object.defineProperty((function(){if("function"!=typeof arguments[arguments.length-1])return new Promise((t,r)=>{arguments[arguments.length]=(e,n)=>{if(e)return r(e);t(n)},arguments.length++,e.apply(this,arguments)});e.apply(this,arguments)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(){const t=arguments[arguments.length-1];if("function"!=typeof t)return e.apply(this,arguments);e.apply(this,arguments).then(e=>t(null,e),t)}),"name",{value:e.name})}},function(e,t,r){"use strict";const n=(0,r(10).fromCallback)(r(183)),o=r(184);e.exports={mkdirs:n,mkdirsSync:o,mkdirp:n,mkdirpSync:o,ensureDir:n,ensureDirSync:o}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(252)),n(r(101)),n(r(267))},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},function(e,t,r){class n{constructor(e,t){if(t=i(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!f(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,r=o.get(t);if(r)return r;const n=this.options.loose,i=n?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];e=e.replace(i,C(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[u.COMPARATORTRIM],p),s("comparator trim",e,l[u.COMPARATORTRIM]),e=(e=(e=e.replace(l[u.TILDETRIM],d)).replace(l[u.CARETTRIM],h)).split(/\s+/).join(" ");const c=n?l[u.COMPARATORLOOSE]:l[u.COMPARATOR],m=e.split(" ").map(e=>y(e,this.options)).join(" ").split(/\s+/).map(e=>D(e,this.options)).filter(this.options.loose?e=>!!e.match(c):()=>!0).map(e=>new a(e,this.options)),g=(m.length,new Map);for(const e of m){if(f(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const v=[...g.values()];return o.set(t,v),v}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>g(r,t)&&e.set.some(e=>g(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(x(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const o=new(r(311))({max:1e3}),i=r(46),a=r(48),s=r(45),c=r(8),{re:l,t:u,comparatorTrimReplace:p,tildeTrimReplace:d,caretTrimReplace:h}=r(24),f=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,g=(e,t)=>{let r=!0;const n=e.slice();let o=n.pop();for(;r&&n.length;)r=n.every(e=>o.intersects(e,t)),o=n.pop();return r},y=(e,t)=>(s("comp",e,t),e=S(e,t),s("caret",e),e=b(e,t),s("tildes",e),e=P(e,t),s("xrange",e),e=_(e,t),s("stars",e),e),v=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map(e=>w(e,t)).join(" "),w=(e,t)=>{const r=t.loose?l[u.TILDELOOSE]:l[u.TILDE];return e.replace(r,(t,r,n,o,i)=>{let a;return s("tilde",e,t,r,n,o,i),v(r)?a="":v(n)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:v(o)?a=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:i?(s("replaceTilde pr",i),a=`>=${r}.${n}.${o}-${i} <${r}.${+n+1}.0-0`):a=`>=${r}.${n}.${o} <${r}.${+n+1}.0-0`,s("tilde return",a),a})},S=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{s("caret",e,t);const r=t.loose?l[u.CARETLOOSE]:l[u.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,o,i,a)=>{let c;return s("caret",e,t,r,o,i,a),v(r)?c="":v(o)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:v(i)?c="0"===r?`>=${r}.${o}.0${n} <${r}.${+o+1}.0-0`:`>=${r}.${o}.0${n} <${+r+1}.0.0-0`:a?(s("replaceCaret pr",a),c="0"===r?"0"===o?`>=${r}.${o}.${i}-${a} <${r}.${o}.${+i+1}-0`:`>=${r}.${o}.${i}-${a} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${i}-${a} <${+r+1}.0.0-0`):(s("no pr"),c="0"===r?"0"===o?`>=${r}.${o}.${i}${n} <${r}.${o}.${+i+1}-0`:`>=${r}.${o}.${i}${n} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${i} <${+r+1}.0.0-0`),s("caret return",c),c})},P=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map(e=>T(e,t)).join(" ")),T=(e,t)=>{e=e.trim();const r=t.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return e.replace(r,(r,n,o,i,a,c)=>{s("xRange",e,r,n,o,i,a,c);const l=v(o),u=l||v(i),p=u||v(a),d=p;return"="===n&&d&&(n=""),c=t.includePrerelease?"-0":"",l?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&d?(u&&(i=0),a=0,">"===n?(n=">=",u?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",u?o=+o+1:i=+i+1),"<"===n&&(c="-0"),r=`${n+o}.${i}.${a}${c}`):u?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:p&&(r=`>=${o}.${i}.0${c} <${o}.${+i+1}.0-0`),s("xRange return",r),r})},_=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[u.STAR],"")),D=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),C=e=>(t,r,n,o,i,a,s,c,l,u,p,d,h)=>`${r=v(n)?"":v(o)?`>=${n}.0.0${e?"-0":""}`:v(i)?`>=${n}.${o}.0${e?"-0":""}`:a?">="+r:`>=${r}${e?"-0":""}`} ${c=v(l)?"":v(u)?`<${+l+1}.0.0-0`:v(p)?`<${l}.${+u+1}.0-0`:d?`<=${l}.${u}.${p}-${d}`:e?`<${l}.${u}.${+p+1}-0`:"<="+c}`.trim(),x=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(s(e[r].semver),e[r].semver!==a.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconPathHelper=void 0;class n{static setExtensionContext(e){n.extensionContext=e,n.databaseProject=n.makeIcon("databaseProject"),n.colorfulSqlProject=n.makeIcon("colorfulSqlProject",!0),n.sqlEdgeProject=n.makeIcon("sqlEdgeProject",!0),n.dataSourceGroup=n.makeIcon("dataSourceGroup"),n.dataSourceSql=n.makeIcon("dataSource-sql"),n.referenceGroup=n.makeIcon("referenceGroup"),n.referenceDatabase=n.makeIcon("reference-database"),n.refresh=n.makeIcon("refresh",!0),n.folder_blue=n.makeIcon("folder_blue",!0),n.selectConnection=n.makeIcon("selectConnection",!0),n.connect=n.makeIcon("connect",!0),n.folder=n.makeIcon("folder"),n.add=n.makeIcon("add",!0),n.build=n.makeIcon("build",!0),n.publish=n.makeIcon("publish",!0),n.schemaCompare=n.makeIcon("schemaCompare",!0),n.targetPlatform=n.makeIcon("targetPlatform",!0),n.success=n.makeIcon("success",!0),n.error=n.makeIcon("error",!0),n.inProgress=n.makeIcon("inProgress",!0),n.dashboardSqlProj=n.makeIcon("dashboardSqlProj",!0)}static makeIcon(e,t=!1){return t?{dark:n.extensionContext.asAbsolutePath(`images/${e}.svg`),light:n.extensionContext.asAbsolutePath(`images/${e}.svg`)}:{dark:n.extensionContext.asAbsolutePath(`images/dark/${e}.svg`),light:n.extensionContext.asAbsolutePath(`images/light/${e}.svg`)}}}t.IconPathHelper=n},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=r(38),i=r(41),a=r(30),s=r(85),c=r(7),l=r(31),u=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&"string"==typeof r)for(var o=t+"=",i=r.split(";"),a=0;a<i.length;a++){r=i[a];if((r=e.trim(r))&&0===r.indexOf(o)){n=r.substring(o.length,i[a].length);break}}return n},e.trim=function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(e){var t=function(e,t){return String.fromCharCode(e>>t&255)},r=e.map((function(e){return t(e,24)+t(e,16)+t(e,8)+t(e,0)})).join(""),n=(Buffer.from?Buffer.from(r,"binary"):new Buffer(r,"binary")).toString("base64");return n.substr(0,n.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t,r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",o=0;o<4;o++)n+=r[15&(t=e.random32())]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+4*Math.random()|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)},e.isValidW3CId=function(e){return 32===e.length&&"00000000000000000000000000000000"!==e},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return e instanceof Error},e.isPrimitive=function(e){var t=typeof e;return"string"===t||"number"===t||"boolean"===t},e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),r=""+Math.floor(e/6e4)%60,n=""+Math.floor(e/36e5)%24,o=Math.floor(e/864e5);return t=t.indexOf(".")<2?"0"+t:t,r=r.length<2?"0"+r:r,(o>0?o+".":"")+(n=n.length<2?"0"+n:n)+":"+r+":"+t},e.extractError=function(e){var t=e;return{message:e.message,code:t.code||t.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):"function"==typeof t.toJSON?t.toJSON():t},e.validateStringMap=function(t){if("object"==typeof t){var r={};for(var n in t){var o="",i=t[n],a=typeof i;if(e.isPrimitive(i))o=i.toString();else if(null===i||"undefined"===a)o="";else{if("function"===a){c.info("key: "+n+" was function; will not serialize");continue}var s=e.isArray(i)?i:e.extractObject(i);try{o=e.isPrimitive(s)?s:JSON.stringify(s)}catch(e){o=i.constructor.name.toString()+" (Error: "+e.message+")",c.info("key: "+n+", could not be serialized")}}r[n]=o.substring(0,e.MAX_PROPERTY_LENGTH)}return r}c.info("Invalid properties dropped from payload")},e.canIncludeCorrelationHeader=function(e,t){var r=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!r||0==r.length||!t)return!0;for(var n=0;n<r.length;n++){if(new RegExp(r[n].replace(/\./g,".").replace(/\*/g,".*")).test(a.parse(t).hostname))return!1}return!0},e.getCorrelationContextTarget=function(e,t){var r=e.headers&&e.headers[l.requestContextHeader];if(r)for(var n=r.split(","),o=0;o<n.length;++o){var i=n[o].split("=");if(2==i.length&&i[0]==t)return i[1]}},e.makeRequest=function(t,r,s,l){r&&0===r.indexOf("//")&&(r="https:"+r);var u=a.parse(r),p=n({},s,{host:u.hostname,port:u.port,path:u.pathname}),d=void 0;if("https:"===u.protocol&&(d=t.proxyHttpsUrl||void 0),"http:"===u.protocol&&(d=t.proxyHttpUrl||void 0),d){0===d.indexOf("//")&&(d="http:"+d);var h=a.parse(d);"https:"===h.protocol?(c.info("Proxies that use HTTPS are not supported"),d=void 0):p=n({},p,{host:h.hostname,port:h.port||"80",path:r,headers:n({},p.headers,{Host:u.hostname})})}var f="https:"===u.protocol&&!d;return f&&void 0!==t.httpsAgent?p.agent=t.httpsAgent:f||void 0===t.httpAgent?f&&(p.agent=e.tlsRestrictedAgent):p.agent=t.httpAgent,f?i.request(p,l):o.request(p,l)},e.safeIncludeCorrelationHeader=function(t,r,n){var o;if("string"==typeof n)o=n;else if(n instanceof Array)o=n.join(",");else if(n&&"function"==typeof n.toString)try{o=n.toString()}catch(e){c.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",e,n)}o?e.addCorrelationIdHeaderFromString(t,r,o):r.setHeader(l.requestContextHeader,l.requestContextSourceKey+"="+t.config.correlationId)},e.addCorrelationIdHeaderFromString=function(e,t,r){var n=r.split(","),o=l.requestContextSourceKey+"=";n.some((function(e){return e.substring(0,o.length)===o}))||t.setHeader(l.requestContextHeader,r+","+l.requestContextSourceKey+"="+e.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new i.Agent({secureOptions:s.SSL_OP_NO_SSLv2|s.SSL_OP_NO_SSLv3|s.SSL_OP_NO_TLSv1|s.SSL_OP_NO_TLSv1_1}),e}();e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.string=t.stream=t.pattern=t.path=t.fs=t.errno=t.array=void 0;const n=r(127);t.array=n;const o=r(128);t.errno=o;const i=r(129);t.fs=i;const a=r(130);t.path=a;const s=r(131);t.pattern=s;const c=r(147);t.stream=c;const l=r(149);t.string=l},function(e,t,r){"use strict";const n=r(10).fromPromise,o=r(84);e.exports={pathExists:n((function(e){return o.access(e).then(()=>!0).catch(()=>!1)})),pathExistsSync:o.existsSync}},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("stream")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(151),o=r(152),i=r(153);function a(e={}){return e instanceof i.default?e:new i.default(e)}t.Settings=i.default,t.stat=function(e,t,r){if("function"==typeof t)return n.read(e,a(),t);n.read(e,a(t),r)},t.statSync=function(e,t){const r=a(t);return o.read(e,r)}},function(e,t,r){"use strict";var n=r(16),o=r(7),i=function(){function e(){}return e.queryCorrelationId=function(t,r){var i=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(i))r(e.completedLookups[i]);else if(e.pendingLookups[i])e.pendingLookups[i].push(r);else{e.pendingLookups[i]=[r];var a=function(){if(e.pendingLookups[i]){var r={method:"GET",disableAppInsightsAutoCollection:!0};o.info(e.TAG,r);var s=n.makeRequest(t,i,r,(function(r){if(200===r.statusCode){var n="";r.setEncoding("utf-8"),r.on("data",(function(e){n+=e})),r.on("end",(function(){o.info(e.TAG,n);var t=e.correlationIdPrefix+n;e.completedLookups[i]=t,e.pendingLookups[i]&&e.pendingLookups[i].forEach((function(e){return e(t)})),delete e.pendingLookups[i]}))}else r.statusCode>=400&&r.statusCode<500?(e.completedLookups[i]=void 0,delete e.pendingLookups[i]):setTimeout(a,t.correlationIdRetryIntervalMs)}));s&&(s.on("error",(function(t){o.warn(e.TAG,t)})),s.end())}};setTimeout(a,0)}},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",o=e.pendingLookups[n];o&&(e.pendingLookups[n]=o.filter((function(e){return e!=r})),0==e.pendingLookups[n].length&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){"."!==(t="|"==t[0]?t:"|"+t)[t.length-1]&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}return e.generateRootId()},e.getRootId=function(e){var t=e.indexOf(".");t<0&&(t=e.length);var r="|"===e[0]?1:0;return e.substring(r,t)},e.generateRootId=function(){return"|"+n.w3cTraceId()+"."},e.appendSuffix=function(t,r,o){if(t.length+r.length<e.requestIdMaxLength)return t+r+o;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var a=t[i-1];if("."===a||"_"===a)break}if(i<=1)return e.generateRootId();for(r=n.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!1,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=n.randomu32(),e}();e.exports=i},function(e,t,r){const{MAX_SAFE_COMPONENT_LENGTH:n}=r(44),o=r(45),i=(t=e.exports={}).re=[],a=t.src=[],s=t.t={};let c=0;const l=(e,t,r)=>{const n=c++;o(n,t),s[e]=n,a[n]=t,i[n]=new RegExp(t,r?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${a[s.NUMERICIDENTIFIER]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${a[s.NUMERICIDENTIFIERLOOSE]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${a[s.PRERELEASEIDENTIFIER]}(?:\\.${a[s.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${a[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[s.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${a[s.BUILDIDENTIFIER]}(?:\\.${a[s.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${a[s.MAINVERSION]}${a[s.PRERELEASE]}?${a[s.BUILD]}?`),l("FULL",`^${a[s.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${a[s.MAINVERSIONLOOSE]}${a[s.PRERELEASELOOSE]}?${a[s.BUILD]}?`),l("LOOSE",`^${a[s.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",a[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",a[s.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:${a[s.PRERELEASE]})?${a[s.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:${a[s.PRERELEASELOOSE]})?${a[s.BUILD]}?)?)?`),l("XRANGE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),l("COERCERTL",a[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${a[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${a[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${a[s.LONECARET]}${a[s.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${a[s.LONECARET]}${a[s.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${a[s.GTLT]}\\s*(${a[s.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]}|${a[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${a[s.XRANGEPLAIN]})\\s+-\\s+(${a[s.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${a[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[s.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,r){const{MAX_LENGTH:n}=r(44),{re:o,t:i}=r(24),a=r(8),s=r(46);e.exports=(e,t)=>{if(t=s(t),e instanceof a)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?o[i.LOOSE]:o[i.FULL]).test(e))return null;try{return new a(e,t)}catch(e){return null}}},function(e,t){e.exports=require("assert")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryActions=t.TelemetryViews=t.TelemetryReporter=void 0;const n=r(209),o=r(3).getPackageInfo();t.TelemetryReporter=new n.default(o.name,o.version,o.aiKey),function(e){e.ProjectController="ProjectController",e.SqlProjectPublishDialog="SqlProjectPublishDialog",e.ProjectTree="ProjectTree",e.SqlBindingsQuickPick="SqlBindingsQuickPick"}(t.TelemetryViews||(t.TelemetryViews={})),function(e){e.createNewProject="createNewProject",e.addDatabaseReference="addDatabaseReference",e.runStreamingJobValidation="runStreamingJobValidation",e.generateScriptClicked="generateScriptClicked",e.deleteObjectFromProject="deleteObjectFromProject",e.editProjectFile="editProjectFile",e.addItemFromTree="addItemFromTree",e.excludeFromProject="excludeFromProject",e.projectSchemaCompareCommandInvoked="projectSchemaCompareCommandInvoked",e.publishProject="publishProject",e.build="build",e.updateProjectForRoundtrip="updateProjectForRoundtrip",e.changePlatformType="changePlatformType",e.updateSystemDatabaseReferencesInProjFile="updateSystemDatabaseReferencesInProjFile",e.startAddSqlBinding="startAddSqlBinding",e.finishAddSqlBinding="finishAddSqlBinding"}(t.TelemetryActions||(t.TelemetryActions={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(60),i=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return void 0===t?null:t},e.generateContextObject=function(e,t,r,n,o,i){return t=t||e,this.enabled?{operation:{name:r,id:e,parentId:t,traceparent:o,tracestate:i},customProperties:new a(n)}:null},e.runWithContext=function(t,r){return e.enabled?e.session.bind(r,((n={})[e.CONTEXT_NAME]=t,n))():r();var n},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t){return e.enabled?e.session.bind(t):t},e.enable=function(t){this.enabled||(this.isNodeVersionCompatible()?(e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,void 0===this.cls&&(!0===e.forceClsHooked||void 0===e.forceClsHooked&&e.shouldUseClsHooked()?this.cls=r(230):this.cls=r(242)),e.session=this.cls.createNamespace("AI-CLS-Session"),o.registerContextPreservation((function(t){return e.session.bind(t)}))),this.enabled=!0):this.enabled=!1)},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},e.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},e.canUseClsHooked=function(){var e=process.versions.node.split("."),t=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,r=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,n=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(t&&r)&&n},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();t.CorrelationContextManager=i;var a=function(){function e(e){this.props=[],this.addHeaderData(e)}return e.prototype.addHeaderData=function(e){var t=e?e.split(", "):[];this.props=t.map((function(e){var t=e.split("=");return{key:t[0],value:t[1]}})).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map((function(e){return e.key+"="+e.value})).join(", ")},e.prototype.getProperty=function(e){for(var t=0;t<this.props.length;++t){var r=this.props[t];if(r.key===e)return r.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r))n.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);else{for(var o=0;o<this.props.length;++o){var i=this.props[o];if(i.key===t)return void(i.value=r)}this.props.push({key:t,value:r})}},e.bannedCharacters=/[,=]/,e}()},function(e,t,r){"use strict";var n,o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",t.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",t.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com",function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"}(n=t.QuickPulseCounter||(t.QuickPulseCounter={})),function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"}(o=t.PerformanceCounter||(t.PerformanceCounter={})),t.PerformanceToQuickPulseCounter=((i={})[o.PROCESSOR_TIME]=n.PROCESSOR_TIME,i[o.REQUEST_RATE]=n.REQUEST_RATE,i[o.REQUEST_DURATION]=n.REQUEST_DURATION,i[n.COMMITTED_BYTES]=n.COMMITTED_BYTES,i[n.REQUEST_FAILURE_RATE]=n.REQUEST_FAILURE_RATE,i[n.DEPENDENCY_RATE]=n.DEPENDENCY_RATE,i[n.DEPENDENCY_FAILURE_RATE]=n.DEPENDENCY_FAILURE_RATE,i[n.DEPENDENCY_DURATION]=n.DEPENDENCY_DURATION,i[n.EXCEPTION_RATE]=n.EXCEPTION_RATE,i),t.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability"},t.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument"},t.TelemetryTypeStringToQuickPulseType={EventData:t.QuickPulseType.Event,ExceptionData:t.QuickPulseType.Exception,MessageData:t.QuickPulseType.Trace,MetricData:t.QuickPulseType.Metric,RequestData:t.QuickPulseType.Request,RemoteDependencyData:t.QuickPulseType.Dependency,AvailabilityData:t.QuickPulseType.Availability},t.TelemetryTypeStringToQuickPulseDocumentType={EventData:t.QuickPulseDocumentType.Event,ExceptionData:t.QuickPulseDocumentType.Exception,MessageData:t.QuickPulseDocumentType.Trace,MetricData:t.QuickPulseDocumentType.Metric,RequestData:t.QuickPulseDocumentType.Request,RemoteDependencyData:t.QuickPulseDocumentType.Dependency,AvailabilityData:t.QuickPulseDocumentType.Availability}},function(e,t){e.exports=require("url")},function(e,t,r){"use strict";e.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpacerTreeItem=t.MessageTreeItem=t.BaseProjectTreeItem=void 0;const n=r(2),o=r(0);class i{constructor(e,t){this.projectUri=e,this.parent=t}get friendlyName(){return o.parse(this.projectUri.path).base}get root(){let e=this;for(;void 0!==e.parent;)e=e.parent;return e}}t.BaseProjectTreeItem=i;class a extends i{constructor(e,t){var r;super(n.Uri.file(o.join(null!==(r=null==t?void 0:t.projectUri.path)&&void 0!==r?r:"Message",e)),t),this.message=e}get children(){return[]}get treeItem(){return new n.TreeItem(this.message,n.TreeItemCollapsibleState.None)}}t.MessageTreeItem=a,t.SpacerTreeItem=new a("")},function(e,t,r){"use strict";const n=r(0),o="win32"===process.platform,{REGEX_BACKSLASH:i,REGEX_REMOVE_BACKSLASH:a,REGEX_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_GLOBAL:c}=r(34);t.isObject=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),t.hasRegexChars=e=>s.test(e),t.isRegexChar=e=>1===e.length&&t.hasRegexChars(e),t.escapeRegex=e=>e.replace(c,"\\$1"),t.toPosixSlashes=e=>e.replace(i,"/"),t.removeBackslashes=e=>e.replace(a,e=>"\\"===e?"":e),t.supportsLookbehinds=()=>{const e=process.version.slice(1).split(".").map(Number);return 3===e.length&&e[0]>=9||8===e[0]&&e[1]>=10},t.isWindows=e=>e&&"boolean"==typeof e.windows?e.windows:!0===o||"\\"===n.sep,t.escapeLast=(e,r,n)=>{const o=e.lastIndexOf(r,n);return-1===o?e:"\\"===e[o-1]?t.escapeLast(e,r,o-1):`${e.slice(0,o)}\\${e.slice(o)}`},t.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r},t.wrapOutput=(e,t={},r={})=>{let n=`${r.contains?"":"^"}(?:${e})${r.contains?"":"$"}`;return!0===t.negated&&(n=`(?:^(?!${n}).*$)`),n}},function(e,t,r){"use strict";const n=r(0),o={DOT_LITERAL:"\\.",PLUS_LITERAL:"\\+",QMARK_LITERAL:"\\?",SLASH_LITERAL:"\\/",ONE_CHAR:"(?=.)",QMARK:"[^/]",END_ANCHOR:"(?:\\/|$)",DOTS_SLASH:"\\.{1,2}(?:\\/|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|\\/)\\.{1,2}(?:\\/|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:\\/|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:\\/|$))",QMARK_NO_DOT:"[^.\\/]",STAR:"[^/]*?",START_ANCHOR:"(?:^|\\/)"},i={...o,SLASH_LITERAL:"[\\\\/]",QMARK:"[^\\\\/]",STAR:"[^\\\\/]*?",DOTS_SLASH:"\\.{1,2}(?:[\\\\/]|$)",NO_DOT:"(?!\\.)",NO_DOTS:"(?!(?:^|[\\\\/])\\.{1,2}(?:[\\\\/]|$))",NO_DOT_SLASH:"(?!\\.{0,1}(?:[\\\\/]|$))",NO_DOTS_SLASH:"(?!\\.{1,2}(?:[\\\\/]|$))",QMARK_NO_DOT:"[^.\\\\/]",START_ANCHOR:"(?:^|[\\\\/])",END_ANCHOR:"(?:[\\\\/]|$)"};e.exports={MAX_LENGTH:65536,POSIX_REGEX_SOURCE:{alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"},REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:n.sep,extglobChars:e=>({"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}),globChars:e=>!0===e?i:o}},function(e,t,r){"use strict";const n=r(178),o={};n(o,r(84)),n(o,r(182)),n(o,r(89)),n(o,r(11)),n(o,r(36)),n(o,r(187)),n(o,r(191)),n(o,r(192)),n(o,r(193)),n(o,r(194)),n(o,r(200)),n(o,r(18)),e.exports=o},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(186);e.exports={remove:n(o),removeSync:o.sync}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reset=t.ProjectScriptType=t.macroExpansion=t.loadTemplates=t.projectScriptTypes=t.get=t.postDeployScript=t.preDeployScript=t.folder=t.externalStreamingJob=t.externalStream=t.fileFormat=t.dataSource=t.storedProcedure=t.view=t.table=t.script=t.newSqlProjectTemplate=void 0;const n=r(0),o=r(1),i=r(4);t.script="script",t.table="table",t.view="view",t.storedProcedure="storedProcedure",t.dataSource="dataSource",t.fileFormat="fileFormat",t.externalStream="externalStream",t.externalStreamingJob="externalStreamingJob",t.folder="folder",t.preDeployScript="preDeployScript",t.postDeployScript="postDeployScript";let a={};t.get=function(e){if(0===Object.keys(a).length)throw new Error("Templates must be loaded from file before attempting to use.");return a[e.toLocaleLowerCase()]};let s=[];async function c(e,t,r,n){const o=await l(r,n);return s.push(new u(e,t,o)),e}async function l(e,t){return(await i.promises.readFile(n.join(e,t))).toString()}t.projectScriptTypes=function(){if(0===s.length)throw new Error("Templates must be loaded from file before attempting to use.");return s},t.loadTemplates=async function(e){p(),await Promise.all([Promise.resolve(t.newSqlProjectTemplate=await l(e,"newSqlProjectTemplate.xml")),c(t.script,o.scriptFriendlyName,e,"newTsqlScriptTemplate.sql"),c(t.table,o.tableFriendlyName,e,"newTsqlTableTemplate.sql"),c(t.view,o.viewFriendlyName,e,"newTsqlViewTemplate.sql"),c(t.storedProcedure,o.storedProcedureFriendlyName,e,"newTsqlStoredProcedureTemplate.sql"),c(t.preDeployScript,o.preDeployScriptFriendlyName,e,"newTsqlPreDeployScriptTemplate.sql"),c(t.postDeployScript,o.postDeployScriptFriendlyName,e,"newTsqlPostDeployScriptTemplate.sql"),c(t.dataSource,o.dataSourceFriendlyName,e,"newTsqlDataSourceTemplate.sql"),c(t.fileFormat,o.fileFormatFriendlyName,e,"newTsqlFileFormatTemplate.sql"),c(t.externalStream,o.externalStreamFriendlyName,e,"newTsqlExternalStreamTemplate.sql"),c(t.externalStreamingJob,o.externalStreamingJobFriendlyName,e,"newTsqlExternalStreamingJobTemplate.sql")]);for(const e of s){if(Object.keys(a).find(t=>t===e.type.toLocaleLowerCase()||t===e.friendlyName.toLocaleLowerCase()))throw new Error(`Script type map already contains ${e.type} or its friendlyName.`);a[e.type.toLocaleLowerCase()]=e,a[e.friendlyName.toLocaleLowerCase()]=e}},t.macroExpansion=function(e,t){let r=e;for(const e in t){if(t[e].includes("@@"))throw new Error(`Macro value ${t[e]} is invalid because it contains @@`);r=r.replace(new RegExp("@@"+e+"@@","g"),t[e])}return r};class u{constructor(e,t,r){this.type=e,this.friendlyName=t,this.templateScript=r}}function p(){a={},s=[]}t.ProjectScriptType=u,t.reset=p},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("child_process")},function(e,t,r){"use strict";var n=r(38),o=r(41),i=r(7),a=r(16),s=r(31),c=r(272),l=r(28),u=r(23),p=r(106),d=r(60),h=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),d.IsInitialized&&(r(273).enable(e,this._client),r(274).enable(e,this._client),r(275).enable(e,this._client),r(276).enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;n.get;var r=n.request,i=o.request,a=function(r,n){var o=!n[e.disableCollectionRequestOption]&&!r[e.alreadyAutoCollectedFlag];r[e.alreadyAutoCollectedFlag]=!0,r&&n&&o&&(l.CorrelationContextManager.wrapEmitter(r),e.trackRequest(t._client,{options:n,request:r}))};n.request=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=r.call.apply(r,[n,e].concat(t));return a(i,e),i},o.request=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=i.call.apply(i,[o,e].concat(t));return a(n,e),n},n.get=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o,i=(o=n.request).call.apply(o,[n,e].concat(t));return i.end(),i},o.get=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,i=(n=o.request).call.apply(n,[o,e].concat(t));return i.end(),i}},e.trackRequest=function(t,r){if(r.options&&r.request&&t){var n,o,d=new c(r.options,r.request),h=l.CorrelationContextManager.getCurrentContext();if(h&&h.operation&&h.operation.traceparent&&p.isValidTraceId(h.operation.traceparent.traceId))h.operation.traceparent.updateSpanId(),n=h.operation.traceparent.getBackCompatRequestId();else if(u.w3cEnabled){o=(m=new p).toString(),n=m.getBackCompatRequestId()}else n=h&&h.operation&&h.operation.parentId+e.requestNumber+++".";if(a.canIncludeCorrelationHeader(t,d.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var f=r.request.getHeader(s.requestContextHeader);try{a.safeIncludeCorrelationHeader(t,r.request,f)}catch(e){i.warn("Request-Context header could not be set. Correlation of requests may be lost",e)}if(h&&h.operation)try{if(r.request.setHeader(s.requestIdHeader,n),r.request.setHeader(s.parentIdHeader,h.operation.id),r.request.setHeader(s.rootIdHeader,n),o||h.operation.traceparent)r.request.setHeader(s.traceparentHeader,o||h.operation.traceparent.toString());else if(u.w3cEnabled){var m=(new p).toString();r.request.setHeader(s.traceparentHeader,m)}if(h.operation.tracestate){var g=h.operation.tracestate.toString();g&&r.request.setHeader(s.traceStateHeader,g)}var y=h.customProperties.serializeToHeader();y&&r.request.setHeader(s.correlationContextHeader,y)}catch(e){i.warn("Correlation headers could not be set. Correlation of requests may be lost.",e)}}r.request.on&&(r.request.on("response",(function(e){d.onResponse(e);var o=d.getDependencyTelemetry(r,n);o.contextObjects=o.contextObjects||{},o.contextObjects["http.RequestOptions"]=r.options,o.contextObjects["http.ClientRequest"]=r.request,o.contextObjects["http.ClientResponse"]=e,t.trackDependency(o)})),r.request.on("error",(function(e){d.onError(e);var o=d.getDependencyTelemetry(r,n);o.contextObjects=o.contextObjects||{},o.contextObjects["http.RequestOptions"]=r.options,o.contextObjects["http.ClientRequest"]=r.request,o.contextObjects.Error=e,t.trackDependency(o)})))}else i.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();e.exports=h},function(e,t){e.exports=require("https")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemDatabase=t.DatabaseReferenceLocation=t.EntryType=t.SqlCmdVariableProjectEntry=t.SqlProjectReferenceProjectEntry=t.SystemDatabaseReferenceProjectEntry=t.DacpacReferenceProjectEntry=t.FileProjectEntry=t.ProjectEntry=void 0;const n=r(0),o=r(3);class i{constructor(e){this.type=e}}t.ProjectEntry=i;class a extends i{constructor(e,t,r,n){super(r),this.fsUri=e,this.relativePath=t,this.sqlObjectType=n}toString(){return this.fsUri.path}pathForSqlProj(){return o.convertSlashesForSqlProj(this.fsUri.fsPath)}}t.FileProjectEntry=a;t.DacpacReferenceProjectEntry=class extends a{constructor(e){super(e.dacpacFileLocation,"",s.DatabaseReference),this.databaseSqlCmdVariable=e.databaseVariable,this.databaseVariableLiteralValue=e.databaseName,this.serverName=e.serverName,this.serverSqlCmdVariable=e.serverVariable,this.suppressMissingDependenciesErrors=e.suppressMissingDependenciesErrors}get databaseName(){return n.parse(o.getPlatformSafeFileEntryPath(this.fsUri.fsPath)).name}pathForSqlProj(){return o.convertSlashesForSqlProj(this.fsUri.path.substring(1))}};t.SystemDatabaseReferenceProjectEntry=class extends a{constructor(e,t,r,n){super(e,"",s.DatabaseReference),this.ssdtUri=t,this.databaseVariableLiteralValue=r,this.suppressMissingDependenciesErrors=n}get databaseName(){return n.parse(o.getPlatformSafeFileEntryPath(this.fsUri.fsPath)).name}pathForSqlProj(){return o.convertSlashesForSqlProj(this.fsUri.path.substring(1))}ssdtPathForSqlProj(){return o.convertSlashesForSqlProj(this.ssdtUri.path.substring(1))}};t.SqlProjectReferenceProjectEntry=class extends a{constructor(e){super(e.projectRelativePath,"",s.DatabaseReference),this.projectName=e.projectName,this.projectGuid=e.projectGuid,this.databaseSqlCmdVariable=e.databaseVariable,this.databaseVariableLiteralValue=e.databaseName,this.serverName=e.serverName,this.serverSqlCmdVariable=e.serverVariable,this.suppressMissingDependenciesErrors=e.suppressMissingDependenciesErrors}get databaseName(){return this.projectName}pathForSqlProj(){return o.convertSlashesForSqlProj(this.fsUri.path.substring(1))}};var s;t.SqlCmdVariableProjectEntry=class extends i{constructor(e,t){super(s.SqlCmdVariable),this.variableName=e,this.defaultValue=t}},function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.DatabaseReference=2]="DatabaseReference",e[e.SqlCmdVariable=3]="SqlCmdVariable"}(s=t.EntryType||(t.EntryType={})),function(e){e[e.sameDatabase=0]="sameDatabase",e[e.differentDatabaseSameServer=1]="differentDatabaseSameServer",e[e.differentDatabaseDifferentServer=2]="differentDatabaseDifferentServer"}(t.DatabaseReferenceLocation||(t.DatabaseReferenceLocation={})),function(e){e[e.master=0]="master",e[e.msdb=1]="msdb"}(t.SystemDatabase||(t.SystemDatabase={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DotNetError=t.NetCoreTool=t.minSupportedNetCoreVersionForBuild=t.linuxPlatform=t.macPlatform=t.winPlatform=t.NetCoreNonWindowsDefaultPath=t.NetCoreDoNotAskAgainKey=t.DotnetInstallLocationKey=t.NetCoreInstallLocationKey=t.DBProjectConfigurationKey=void 0;const n=r(39),o=r(4),i=r(9),a=r(0),s=r(114),c=r(20),l=r(2),u=r(50),p=r(1),d=r(3),h=r(74),f=u.loadMessageBundle(r(0).join(__dirname,"tools/netcoreTool.ts"));t.DBProjectConfigurationKey="sqlDatabaseProjects",t.NetCoreInstallLocationKey="netCoreSDKLocation",t.DotnetInstallLocationKey="dotnetSDK Location",t.NetCoreDoNotAskAgainKey="netCoreDoNotAsk",t.NetCoreNonWindowsDefaultPath="/usr/local/share",t.winPlatform="win32",t.macPlatform="darwin",t.linuxPlatform="linux",t.minSupportedNetCoreVersionForBuild="3.1.0";const m="win32"===i.platform()?"dotnet.exe":"dotnet";class g extends h.ShellExecutionHelper{constructor(e){super(e),this.osPlatform=i.platform(),this.netCoreInstallState=2}async findOrInstallNetCore(e=!1){return this.isNetCoreInstallationPresent&&(!this.isNetCoreInstallationPresent||e)||this.isNetCoreInstallationPresent&&await this.isNetCoreVersionSupportedForBuild()?(this.netCoreInstallState=2,!0):(!0!==l.workspace.getConfiguration(t.DBProjectConfigurationKey)[t.NetCoreDoNotAskAgainKey]&&this.showInstallDialog(),!1)}async showInstallDialog(){let e;if(e=0===this.netCoreInstallState?await l.window.showErrorMessage(p.DotnetInstallationConfirmation,p.UpdateDotnetLocation,p.Install,p.DoNotAskAgain):await l.window.showErrorMessage(p.NetCoreSupportedVersionInstallationConfirmation(this.netCoreSdkInstalledVersion),p.UpdateDotnetLocation,p.Install,p.DoNotAskAgain),e===p.UpdateDotnetLocation)await l.commands.executeCommand("workbench.action.openGlobalSettings");else if(e===p.Install){const e="https://dotnet.microsoft.com/download/dotnet-core/3.1";await l.env.openExternal(l.Uri.parse(e))}else if(e===p.DoNotAskAgain){const e=l.workspace.getConfiguration(t.DBProjectConfigurationKey);await e.update(t.NetCoreDoNotAskAgainKey,!0,l.ConfigurationTarget.Global)}}get isNetCoreInstallationPresent(){const e=!c.isNullOrUndefined(this.netcoreInstallLocation)&&o.existsSync(this.netcoreInstallLocation);return e||(this.netCoreInstallState=0),e}get netcoreInstallLocation(){return l.workspace.getConfiguration(t.DBProjectConfigurationKey)[t.DotnetInstallLocationKey]||this.defaultLocalInstallLocationByDistribution}get defaultLocalInstallLocationByDistribution(){switch(this.osPlatform){case t.winPlatform:return this.defaultWindowsLocation;case t.macPlatform:case t.linuxPlatform:return this.defaultnonWindowsLocation;default:return}}get defaultnonWindowsLocation(){return this.getDotnetPathIfPresent(t.NetCoreNonWindowsDefaultPath)||this.getDotnetPathIfPresent(i.homedir())||void 0}get defaultWindowsLocation(){return this.getDotnetPathIfPresent(process.env.ProgramW6432)||this.getDotnetPathIfPresent(process.env["ProgramFiles(x86)"])||this.getDotnetPathIfPresent(process.env.ProgramFiles)}getDotnetPathIfPresent(e){if(!c.isNullOrUndefined(e)&&o.existsSync(a.join(e,"dotnet")))return a.join(e,"dotnet")}async isNetCoreVersionSupportedForBuild(){try{const e=n.spawn;let r,o=!1;const i=[];return r=e("dotnet --version",[],{shell:!0}),r.stdout.on("data",e=>i.push(e)),await new Promise((e,n)=>{r.on("exit",()=>{this.netCoreSdkInstalledVersion=Buffer.concat(i).toString("utf8").trim();try{o=!!s.gte(this.netCoreSdkInstalledVersion,t.minSupportedNetCoreVersionForBuild),e({stdout:this.netCoreSdkInstalledVersion})}catch(e){console.log(e),n(e)}}),r.on("error",e=>{console.log(e),this.netCoreInstallState=0,n(e)})}),this.netCoreInstallState=o?2:1,o}catch(e){return console.log(e),void(this.netCoreInstallState=0)}}async runDotnetCommand(e,t=!1){if(e&&void 0!==e.commandTitle&&null!==e.commandTitle&&this._outputChannel.appendLine(`\t[ ${e.commandTitle} ]`),!await this.findOrInstallNetCore(t))throw 0===this.netCoreInstallState?new y(p.DotnetInstallationConfirmation):new y(p.NetCoreSupportedVersionInstallationConfirmation(this.netCoreSdkInstalledVersion));const r=d.getQuotedPath(a.join(this.netcoreInstallLocation,m))+" "+e.argument;try{return await this.runStreamedCommand(r,e)}catch(e){throw this._outputChannel.append(f(0,null,r,d.getErrorMessage(e))),e}}}t.NetCoreTool=g;class y extends Error{}t.DotNetError=y},function(e,t){const r=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t){const r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=r},function(e,t){const r=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:r.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>n(e,t,r)>0},function(e,t,r){const n=Symbol("SemVer ANY");class o{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof o){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?a[s.COMPARATORLOOSE]:a[s.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof o))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new p(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new p(this.value,t).test(e.semver);const r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=c(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=c(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||i&&a||s||l}}e.exports=o;const i=r(46),{re:a,t:s}=r(24),c=r(116),l=r(45),u=r(8),p=r(14)},function(e,t,r){const n=r(14);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o,i,a,s,c,l=r(0),u=r(4),p=Object.prototype.toString;function d(e){return void 0!==e}function h(e){return"[object Number]"===p.call(e)}function f(e){return"[object String]"===p.call(e)}function m(e){return JSON.parse(u.readFileSync(e,"utf8"))}function g(e,t){return c&&(e=""+e.replace(/[aouei]/g,"$&$&")+""),0===t.length?e:e.replace(/\{(\d+)\}/g,(function(e,r){var n=r[0],o=t[n],i=e;return"string"==typeof o?i=o:"number"!=typeof o&&"boolean"!=typeof o&&null!=o||(i=String(o)),i}))}function y(e){return function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return h(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: "+new Error("").stack):g(e[t],n):f(r)?(console.warn("Message "+r+" didn't get externalized correctly."),g(r,n)):void console.error("Broken localize call found. Stacktrace is\n: "+new Error("").stack)}}function v(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return g(t,r)}function b(e,t){return a[e]=t,t}function w(e,t){var r,n,o,i=l.join(s.cacheRoot,e.id+"-"+e.hash+".json"),a=!1,c=!1;try{return r=JSON.parse(u.readFileSync(i,{encoding:"utf8",flag:"r"})),n=i,o=new Date,u.utimes(n,o,o,(function(){})),r}catch(e){if("ENOENT"===e.code)c=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: "+e.message+"."),u.unlink(i,(function(e){e&&console.error("Deleting corrupted bundle "+i+" failed.")})),a=!0}}if(!(r=function(e,t){var r=s.translationsConfig[e.id];if(r){var n=m(r).contents,o=m(l.join(t,"nls.metadata.json")),i=Object.create(null);for(var a in o){var c=o[a],u=n[e.outDir+"/"+a];if(u){for(var p=[],d=0;d<c.keys.length;d++){var h=c.keys[d],g=u[f(h)?h:h.key];void 0===g&&(g=c.messages[d]),p.push(g)}i[a]=p}else i[a]=c.messages}return i}}(e,t))||a)return r;if(c)try{u.writeFileSync(i,JSON.stringify(r),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return r;throw e}return r}function S(e){try{return function(e){var t=m(l.join(e,"nls.metadata.json")),r=Object.create(null);for(var n in t){var o=t[n];r[n]=o.messages}return r}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function E(e,t){var r;if(!0===s.languagePackSupport&&void 0!==s.cacheRoot&&void 0!==s.languagePackId&&void 0!==s.translationsConfigFile&&void 0!==s.translationsConfig)try{r=w(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!r){if(s.languagePackSupport)return S(t);var n=function(e){for(var t=s.language;t;){var r=l.join(e,"nls.bundle."+t+".json");if(u.existsSync(r))return r;var n=t.lastIndexOf("-");t=n>0?t.substring(0,n):void 0}if(void 0===t){r=l.join(e,"nls.bundle.json");if(u.existsSync(r))return r}}(t);if(n)try{return m(n)}catch(e){console.log("Loading in the box message bundle failed.",e)}r=S(t)}return r}function P(e){if(!e)return v;var t=l.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),s.messageFormat===n.both||s.messageFormat===n.bundle){var r=function(e){for(var t,r=l.dirname(e);t=l.join(r,"nls.metadata.header.json"),!u.existsSync(t);){var n=l.dirname(r);if(n===r){t=void 0;break}r=n}return t}(e);if(r){var o=l.dirname(r),i=a[o];if(void 0===i)try{var p=JSON.parse(u.readFileSync(r,"utf8"));try{var h=E(p,o);i=b(o,h?{header:p,nlsBundle:h}:null)}catch(e){console.error("Failed to load nls bundle",e),i=b(o,null)}}catch(e){console.error("Failed to read header file",e),i=b(o,null)}if(i){var f=e.substr(o.length+1).replace(/\\/g,"/"),g=i.nlsBundle[f];return void 0===g?(console.error("Messages for file "+e+" not found. See console for details."),function(){return"Messages not found."}):y(g)}}}if(s.messageFormat===n.both||s.messageFormat===n.file)try{var w=m(function(e){var t;if(s.cacheLanguageResolution&&t)t=t;else{if(c||!s.language)t=".nls.json";else for(var r=s.language;r;){var n=".nls."+r+".json";if(u.existsSync(e+n)){t=n;break}var o=r.lastIndexOf("-");o>0?r=r.substring(0,o):(t=".nls.json",r=null)}s.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(w)?y(w):d(w.messages)&&d(w.keys)?y(w.messages):(console.error("String bundle '"+e+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file "+e),function(){return"Failed to load message bundle. See console for details."}}!function(e){e.file="file",e.bundle="bundle",e.both="both"}(n=t.MessageFormat||(t.MessageFormat={})),function(e){e.standalone="standalone",e.languagePack="languagePack"}(o=t.BundleFormat||(t.BundleFormat={})),function(e){e.is=function(e){var t=e;return t&&d(t.key)&&d(t.comment)}}(i||(i={})),function(){if(s={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:n.bundle},f(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG),t=void 0;if(e.availableLanguages){var r=e.availableLanguages["*"];f(r)&&(t=r)}if(f(e.locale)&&(s.locale=e.locale.toLowerCase()),void 0===t?s.language=s.locale:"en"!==t&&(s.language=t),function(e){return!0===e||!1===e}(e._languagePackSupport)&&(s.languagePackSupport=e._languagePackSupport),f(e._cacheRoot)&&(s.cacheRoot=e._cacheRoot),f(e._languagePackId)&&(s.languagePackId=e._languagePackId),f(e._translationsConfigFile)){s.translationsConfigFile=e._translationsConfigFile;try{s.translationsConfig=m(s.translationsConfigFile)}catch(t){if(e._corruptedFile){var o=l.dirname(e._corruptedFile);u.exists(o,(function(t){t&&u.writeFile(e._corruptedFile,"corrupted","utf8",(function(e){console.error(e)}))}))}}}}catch(e){}c="pseudo"===s.locale,void 0,a=Object.create(null)}(),t.loadMessageBundle=P,t.config=function(e){return e&&(f(e.locale)&&(s.locale=e.locale.toLowerCase(),s.language=s.locale,void 0,a=Object.create(null)),void 0!==e.messageFormat&&(s.messageFormat=e.messageFormat),e.bundleFormat===o.standalone&&!0===s.languagePackSupport&&(s.languagePackSupport=!1)),c="pseudo"===s.locale,P}},function(e,t,r){"use strict";const n=r(52);e.exports=(e,t={})=>{let r=(e,o={})=>{let i=t.escapeInvalid&&n.isInvalidBrace(o),a=!0===e.invalid&&!0===t.escapeInvalid,s="";if(e.value)return(i||a)&&n.isOpenOrClose(e)?"\\"+e.value:e.value;if(e.value)return e.value;if(e.nodes)for(let t of e.nodes)s+=r(t);return s};return r(e)}},function(e,t,r){"use strict";t.isInteger=e=>"number"==typeof e?Number.isInteger(e):"string"==typeof e&&""!==e.trim()&&Number.isInteger(Number(e)),t.find=(e,t)=>e.nodes.find(e=>e.type===t),t.exceedsLimit=(e,r,n=1,o)=>!1!==o&&(!(!t.isInteger(e)||!t.isInteger(r))&&(Number(r)-Number(e))/Number(n)>=o),t.escapeNode=(e,t=0,r)=>{let n=e.nodes[t];n&&(r&&n.type===r||"open"===n.type||"close"===n.type)&&!0!==n.escaped&&(n.value="\\"+n.value,n.escaped=!0)},t.encloseBrace=e=>"brace"===e.type&&(e.commas>>0+e.ranges>>0==0&&(e.invalid=!0,!0)),t.isInvalidBrace=e=>"brace"===e.type&&(!(!0!==e.invalid&&!e.dollar)||(e.commas>>0+e.ranges>>0==0||!0!==e.open||!0!==e.close)&&(e.invalid=!0,!0)),t.isOpenOrClose=e=>"open"===e.type||"close"===e.type||(!0===e.open||!0===e.close),t.reduce=e=>e.reduce((e,t)=>("text"===t.type&&e.push(t.value),"range"===t.type&&(t.type="text"),e),[]),t.flatten=(...e)=>{const t=[],r=e=>{for(let n=0;n<e.length;n++){let o=e[n];Array.isArray(o)?r(o,t):void 0!==o&&t.push(o)}return t};return r(e),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(156),o=r(159),i=r(160);function a(e={}){return e instanceof i.default?e:new i.default(e)}t.Settings=i.default,t.scandir=function(e,t,r){if("function"==typeof t)return n.read(e,a(),t);n.read(e,a(t),r)},t.scandirSync=function(e,t){const r=a(t);return o.read(e,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFatalError=function(e,t){return null===e.errorFilter||!e.errorFilter(t)},t.isAppliedFilter=function(e,t){return null===e||e(t)},t.replacePathSegmentSeparator=function(e,t){return e.split(/[\\/]/).join(t)},t.joinPathSegments=function(e,t,r){return""===e?t:e+r+t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(168),i=r(171),a=r(172),s=r(173);t.default=class{constructor(e){this._settings=e,this.errorFilter=new a.default(this._settings),this.entryFilter=new i.default(this._settings,this._getMicromatchOptions()),this.deepFilter=new o.default(this._settings,this._getMicromatchOptions()),this.entryTransformer=new s.default(this._settings)}_getRootDirectory(e){return n.resolve(this._settings.cwd,e.base)}_getReaderOptions(e){const t="."===e.base?"":e.base;return{basePath:t,pathSegmentSeparator:"/",concurrency:this._settings.concurrency,deepFilter:this.deepFilter.getFilter(t,e.positive,e.negative),entryFilter:this.entryFilter.getFilter(e.positive,e.negative),errorFilter:this.errorFilter.getFilter(),followSymbolicLinks:this._settings.followSymbolicLinks,fs:this._settings.fs,stats:this._settings.stats,throwErrorOnBrokenSymbolicLink:this._settings.throwErrorOnBrokenSymbolicLink,transform:this.entryTransformer.getTransformer()}}_getMicromatchOptions(){return{dot:this._settings.dot,matchBase:this._settings.baseNameMatch,nobrace:!this._settings.braceExpansion,nocase:!this._settings.caseSensitiveMatch,noext:!this._settings.extglob,noglobstar:!this._settings.globstar,posix:!0,strictSlashes:!1}}}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(188);e.exports={readJson:n(o.readFile),readJsonSync:o.readFileSync,writeJson:n(o.writeFile),writeJsonSync:o.writeFileSync}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqlConnectionDataSource=void 0;const n=r(208),o=r(1);class i extends n.DataSource{constructor(e,t){super(e),this.connectionStringComponents={},this.connectionString=t;const r=this.connectionString.split(";").filter(e=>""!==e);for(const e of r){const t=e.split("=");if(2!==t.length)throw new Error(o.invalidSqlConnectionString);this.connectionStringComponents[t[0].toLocaleLowerCase()]=t[1]}}static get type(){return"sql_connection_string"}get type(){return i.type}get typeFriendlyName(){return o.sqlConnectionStringFriendly}get server(){return this.getSetting(o.dataSourceSetting)}get database(){return this.getSetting(o.initialCatalogSetting)}get integratedSecurity(){var e;return"true"===(null===(e=this.getSetting(o.integratedSecuritySetting))||void 0===e?void 0:e.toLowerCase())}get azureMFA(){var e;return null===(e=this.getSetting(o.authenticationSetting))||void 0===e?void 0:e.toLowerCase().includes(o.activeDirectoryInteractive)}get authType(){return this.azureMFA?o.azureMfaAuth:this.integratedSecurity?o.integratedAuth:o.sqlAuth}get username(){return this.getSetting(o.userIdSetting)}get password(){return this.getSetting(o.passwordSetting)}getSetting(e){return this.connectionStringComponents[e.toLocaleLowerCase()]}static fromJson(e){return new i(e.name,e.data.connectionString)}getConnectionProfile(){return{serverName:this.server,databaseName:this.database,connectionName:this.name,userName:this.username,password:this.password,authenticationType:this.authType,savePassword:!1,providerName:"MSSQL",saveProfile:!0,id:this.name+"-dataSource",options:[]}}}t.SqlConnectionDataSource=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cssStyles=void 0,function(e){let t;e.text={"user-select":"text",cursor:"text"},e.tableHeader={...e.text,"text-align":"left",border:"none","font-size":"12px","font-weight":"normal",color:"#666666"},e.tableRow={...e.text,"border-top":"solid 1px #ccc","border-bottom":"solid 1px #ccc","border-left":"none","border-right":"none","font-size":"12px"},e.fontWeightBold={"font-weight":"bold"},e.titleFontSize=13,e.publishDialogLabelWidth="205px",e.publishDialogTextboxWidth="190px",e.addDatabaseReferenceDialogLabelWidth="215px",e.addDatabaseReferenceInputboxWidth="220px",e.createProjectFromDatabaseLabelWidth="110px",e.createProjectFromDatabaseTextboxWidth="310px",function(e){e.normal="normal",e.italics="italic"}(t=e.fontStyle||(e.fontStyle={}))}(t.cssStyles||(t.cssStyles={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDockerBaseImages=t.getAgreementDisplayText=t.getConnectionName=void 0;const n=r(1);t.getConnectionName=function(e){let t;if(e.options.connectionName)t=e.options.connectionName;else{let r=e.options.user;r||(r=n.defaultUser),t=`${e.options.server} (${r})`}return t},t.getAgreementDisplayText=function(e){return n.eulaAgreementText(e.link.text)},t.getDockerBaseImages=function(){return[{name:`${n.sqlServerDockerRegistry}/${n.sqlServerDockerRepository}:2017-latest`,agreementInfo:{link:{text:n.eulaAgreementTitle,url:n.sqlServerEulaLink}}},{name:`${n.sqlServerDockerRegistry}/${n.sqlServerDockerRepository}:2019-latest`,agreementInfo:{link:{text:n.eulaAgreementTitle,url:n.sqlServerEulaLink}}},{name:`${n.sqlServerDockerRegistry}/${n.azureSqlEdgeDockerRepository}:latest`,agreementInfo:{link:{text:n.edgeEulaAgreementTitle,url:n.sqlServerEdgeEulaLink}}}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7);t.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var o="DiagnosticChannel";if(t.IsInitialized){var i=r(212),a=(process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"").split(","),s={bunyan:i.bunyan,console:i.console,mongodb:i.mongodb,mongodbCore:i.mongodbCore,mysql:i.mysql,redis:i.redis,pg:i.pg,pgPool:i.pgPool,winston:i.winston};for(var c in s)-1===a.indexOf(c)&&(s[c].enable(),n.info(o,"Subscribed to "+c+" events"));a.length>0&&n.info(o,"Some modules will not be patched",a)}else n.info(o,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");t.registerContextPreservation=function(e){t.IsInitialized&&r(5).channel.addContextPreservation(e)}},function(e,t,r){"use strict";var n=r(62),o=n.wrap,i=n.unwrap,a="wrap@before";function s(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function c(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r=r?[r]:[]),r}function l(e,t,r){var n=c(e,t).filter((function(e){return-1===r.indexOf(e)}));n.length>0&&function(e,t){for(var r=t.length,n=0;n<r;n++){var o=t[n],i=e[a];if("function"==typeof i)i(o);else if(Array.isArray(i))for(var s=i.length,c=0;c<s;c++)i[c](o)}}(e,n)}function u(e,t){if(e){var r=e;if("function"==typeof e)r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}e.exports=function(e,t,r){if(!(e&&e.on&&e.addListener&&e.removeListener&&e.emit))throw new Error("can only wrap real EEs");if(!t)throw new Error("must have function to run on listener addition");if(!r)throw new Error("must have function to wrap listeners when emitting");function n(e){return function(t,r){var i=c(this,t).slice();try{var a=e.call(this,t,r);return l(this,t,i),a}finally{this.on.__wrapped||o(this,"on",n),this.addListener.__wrapped||o(this,"addListener",n)}}}e[a]?"function"==typeof e[a]?s(e,a,[e[a],t]):Array.isArray(e[a])&&e[a].push(t):s(e,a,t),e.__wrapped||(o(e,"addListener",n),o(e,"on",n),o(e,"emit",(function(e){return function(t){if(!this._events||!this._events[t])return e.apply(this,arguments);var n=this._events[t];function a(e){return function(){this._events[t]=n;try{return e.apply(this,arguments)}finally{n=this._events[t],this._events[t]=u(n,r)}}}o(this,"removeListener",a);try{return this._events[t]=u(n,r),e.apply(this,arguments)}finally{i(this,"removeListener"),this._events[t]=n}}})),s(e,"__unwrap",(function(){i(e,"addListener"),i(e,"on"),i(e,"emit"),delete e[a],delete e.__wrapped})),s(e,"__wrapped",!0))}},function(e,t,r){"use strict";function n(e){return"function"==typeof e}var o=console.error.bind(console);function i(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function a(e){e&&e.logger&&(n(e.logger)?o=e.logger:o("new logger isn't a function, not replacing"))}function s(e,t,r){if(e&&e[t]){if(!r)return o("no wrapper function"),void o((new Error).stack);if(n(e[t])&&n(r)){var a=e[t],s=r(a,t);return i(s,"__original",a),i(s,"__unwrap",(function(){e[t]===s&&i(e,t,a)})),i(s,"__wrapped",!0),i(e,t,s),s}o("original object and wrapper must be functions")}else o("no original function "+t+" to wrap")}function c(e,t){return e&&e[t]?e[t].__unwrap?e[t].__unwrap():void o("no original to unwrap to -- has "+t+" already been unwrapped?"):(o("no function to unwrap."),void o((new Error).stack))}a.wrap=s,a.massWrap=function(e,t,r){if(!e)return o("must provide one or more modules to patch"),void o((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){s(e,t,r)}))})):o("must provide one or more functions to wrap on modules")},a.unwrap=c,a.massUnwrap=function(e,t){if(!e)return o("must provide one or more modules to patch"),void o((new Error).stack);Array.isArray(e)||(e=[e]),t&&Array.isArray(t)?e.forEach((function(e){t.forEach((function(t){c(e,t)}))})):o("must provide one or more functions to unwrap on modules")},e.exports=a},function(e,t,r){"use strict";var n=r(9),o=r(29),i=function(){function e(t,r,n){void 0===r&&(r=6e4),void 0===n&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var o=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=n.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},"function"==typeof process.cpuUsage&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval((function(){return o.trackPerformance()}),this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalRequestExecutionTime+=n,!1===r&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(e.isEnabled()){if("string"==typeof t)n=+new Date("1970-01-01T"+t+"Z");else{if("number"!=typeof t)return;n=t}e._intervalDependencyExecutionTime+=n,!1===r&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var e=n.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var t=0,r=0,i=0,a=0,s=0,c=0;e&&c<e.length;c++){var l=e[c],u=this._lastCpus[c],p=(l.model,l.speed,l.times),d=u.times;t+=p.user-d.user||0,r+=p.sys-d.sys||0,i+=p.nice-d.nice||0,a+=p.idle-d.idle||0,s+=p.irq-d.irq||0}var h=void 0;if("function"==typeof process.cpuUsage){var f=process.cpuUsage(),m=process.hrtime(),g=f.user-this._lastAppCpuUsage.user+(f.system-this._lastAppCpuUsage.system)||0;if(void 0!==this._lastHrtime&&2===this._lastHrtime.length)h=100*g/((1e6*(m[0]-this._lastHrtime[0])+(m[1]-this._lastHrtime[1])/1e3||0)*e.length);this._lastAppCpuUsage=f,this._lastHrtime=m}var y=t+r+i+a+s||1;this._client.trackMetric({name:o.PerformanceCounter.PROCESSOR_TIME,value:(y-a)/y*100}),this._client.trackMetric({name:o.PerformanceCounter.PROCESS_TIME,value:h||t/y*100})}this._lastCpus=e},e.prototype._trackMemory=function(){var e=n.freemem(),t=process.memoryUsage().rss,r=n.totalmem()-e;this._client.trackMetric({name:o.PerformanceCounter.PRIVATE_BYTES,value:t}),this._client.trackMetric({name:o.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:o.QuickPulseCounter.COMMITTED_BYTES,value:r})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,a=r.time-t.time,s=a/1e3,c=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,a>0){var l=n/s,u=i/s;this._client.trackMetric({name:o.PerformanceCounter.REQUEST_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:o.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:o.QuickPulseCounter.REQUEST_FAILURE_RATE,value:u})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,a=r.time-t.time,s=a/1e3,c=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,a>0){var l=n/s,u=i/s;this._client.trackMetric({name:o.QuickPulseCounter.DEPENDENCY_RATE,value:l}),this._client.trackMetric({name:o.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:o.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time;if(i>0){var a=n/(i/1e3);this._client.trackMetric({name:o.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._lastRequestExecutionTime=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._lastDependencyExecutionTime=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();e.exports=i},function(e,t,r){"use strict";var n=r(23),o=r(280),i=r(29),a=r(30),s=function(){function e(t){var r=this;this.endpointBase=i.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],s=o.parse(t),c=o.parse(n),l=!s.instrumentationkey&&Object.keys(s).length>0?null:t;this.instrumentationKey=s.instrumentationkey||l||c.instrumentationkey||e._getInstrumentationKey(),this.endpointUrl=(s.ingestionendpoint||c.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=3e4,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(e){return r.correlationId=e},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=s.ingestionendpoint||c.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=s.liveendpoint||c.liveendpoint||process.env[e.ENV_quickPulseHost]||i.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=a.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){n.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=e,this.correlationId=n.correlationIdPrefix,n.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(e){this._quickPulseHost=e},enumerable:!0,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||""==t)throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();e.exports=s},function(e,t,r){"use strict";var n=r(9),o=r(4),i=r(0),a=r(12),s=r(7),c=function(){function e(e){this.keys=new a.ContextTagKeys,this.tags={},this._loadApplicationContext(),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||i.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(o.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.appVersion[t]=r.version)}catch(e){s.info("unable to read app version: ",e)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=n&&n.hostname(),this.tags[this.keys.deviceOSVersion]=n&&n.type()+" "+n.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=n&&n.arch(),this.tags["ai.device.osPlatform"]=n&&n.platform()},e.prototype._loadInternalContext=function(){var t=i.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(o.readFileSync(t,"utf8"));r&&"string"==typeof r.version&&(e.sdkVersion=r.version)}catch(e){s.info("unable to read app version: ",e)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();e.exports=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;t.Deferred=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}then(e,t){return this.promise.then(e,t)}}},function(e,t){const r=/^[0-9]+$/,n=(e,t)=>{const n=r.test(e),o=r.test(t);return n&&o&&(e=+e,t=+t),e===t?0:n&&!o?-1:o&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>0===n(e,t,r)},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>{const o=new n(e,r),i=new n(t,r);return o.compare(i)||o.compareBuild(i)}},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>n(e,t,r)<0},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>n(e,t,r)>=0},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>n(e,t,r)<=0},function(e,t,r){const n=r(8),o=r(48),{ANY:i}=o,a=r(14),s=r(49),c=r(47),l=r(70),u=r(72),p=r(71);e.exports=(e,t,r,d)=>{let h,f,m,g,y;switch(e=new n(e,d),t=new a(t,d),r){case">":h=c,f=u,m=l,g=">",y=">=";break;case"<":h=l,f=p,m=c,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,d))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let a=null,s=null;if(n.forEach(e=>{e.semver===i&&(e=new o(">=0.0.0")),a=a||e,s=s||e,h(e.semver,a.semver,d)?a=e:m(e.semver,s.semver,d)&&(s=e)}),a.operator===g||a.operator===y)return!1;if((!s.operator||s.operator===g)&&f(e,s.semver))return!1;if(s.operator===y&&m(e,s.semver))return!1}return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShellExecutionHelper=void 0;const n=r(324),o=r(50).loadMessageBundle(r(0).join(__dirname,"tools/shellExecutionHelper.ts"));class i{constructor(e){this._outputChannel=e}async runStreamedCommand(e,t,r=[],a=3e5){const s=[];let c=e;r.forEach(e=>{c=c.replace(e,"***")}),this._outputChannel.appendLine("    > "+c);const l={cwd:t&&t.workingDirectory,env:Object.assign({},process.env,t&&t.additionalEnvironmentVariables),encoding:"utf8",maxBuffer:10485760,shell:!0,detached:!1,windowsHide:!0,timeout:a};try{const t=n.spawn(e,[],l);return this._outputChannel.show(),t.on("exit",(t,r)=>{null!==t?this._outputChannel.appendLine(o(0,null,e,t)):this._outputChannel.appendLine(o(1,null,e,r))}),t.stdout.on("data",e=>{s.push(e.toString()),i.outputDataChunk(this._outputChannel,e,o(2,null))}),t.stderr.on("data",e=>{i.outputDataChunk(this._outputChannel,e,o(3,null))}),await t,s.join("")}catch(e){throw r.forEach(t=>{var r,n;e.cmd=null===(r=e.cmd)||void 0===r?void 0:r.replace(t,"***"),e.message=null===(n=e.message)||void 0===n?void 0:n.replace(t,"***")}),e}}static outputDataChunk(e,t,r){t.toString().split(/\r?\n/).forEach(t=>{e&&e.appendLine(r+t)})}}t.ShellExecutionHelper=i},function(e,t,r){"use strict";
/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const n=r(20),o=r(138),i=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),a=e=>"number"==typeof e||"string"==typeof e&&""!==e,s=e=>Number.isInteger(+e),c=e=>{let t=""+e,r=-1;if("-"===t[0]&&(t=t.slice(1)),"0"===t)return!1;for(;"0"===t[++r];);return r>0},l=(e,t,r)=>{if(t>0){let r="-"===e[0]?"-":"";r&&(e=e.slice(1)),e=r+e.padStart(r?t-1:t,"0")}return!1===r?String(e):e},u=(e,t)=>{let r="-"===e[0]?"-":"";for(r&&(e=e.slice(1),t--);e.length<t;)e="0"+e;return r?"-"+e:e},p=(e,t,r,n)=>{if(r)return o(e,t,{wrap:!1,...n});let i=String.fromCharCode(e);return e===t?i:`[${i}-${String.fromCharCode(t)}]`},d=(e,t,r)=>{if(Array.isArray(e)){let t=!0===r.wrap,n=r.capture?"":"?:";return t?`(${n}${e.join("|")})`:e.join("|")}return o(e,t,r)},h=(...e)=>new RangeError("Invalid range arguments: "+n.inspect(...e)),f=(e,t,r)=>{if(!0===r.strictRanges)throw h([e,t]);return[]},m=(e,t,r=1,n={})=>{let o=Number(e),i=Number(t);if(!Number.isInteger(o)||!Number.isInteger(i)){if(!0===n.strictRanges)throw h([e,t]);return[]}0===o&&(o=0),0===i&&(i=0);let a=o>i,s=String(e),f=String(t),m=String(r);r=Math.max(Math.abs(r),1);let g=c(s)||c(f)||c(m),y=g?Math.max(s.length,f.length,m.length):0,v=!1===g&&!1===((e,t,r)=>"string"==typeof e||"string"==typeof t||!0===r.stringify)(e,t,n),b=n.transform||(e=>t=>!0===e?Number(t):String(t))(v);if(n.toRegex&&1===r)return p(u(e,y),u(t,y),!0,n);let w={negatives:[],positives:[]},S=[],E=0;for(;a?o>=i:o<=i;)!0===n.toRegex&&r>1?w[(P=o)<0?"negatives":"positives"].push(Math.abs(P)):S.push(l(b(o,E),y,v)),o=a?o-r:o+r,E++;var P;return!0===n.toRegex?r>1?((e,t)=>{e.negatives.sort((e,t)=>e<t?-1:e>t?1:0),e.positives.sort((e,t)=>e<t?-1:e>t?1:0);let r,n=t.capture?"":"?:",o="",i="";return e.positives.length&&(o=e.positives.join("|")),e.negatives.length&&(i=`-(${n}${e.negatives.join("|")})`),r=o&&i?`${o}|${i}`:o||i,t.wrap?`(${n}${r})`:r})(w,n):d(S,null,{wrap:!1,...n}):S},g=(e,t,r,n={})=>{if(null==t&&a(e))return[e];if(!a(e)||!a(t))return f(e,t,n);if("function"==typeof r)return g(e,t,1,{transform:r});if(i(r))return g(e,t,0,r);let o={...n};return!0===o.capture&&(o.wrap=!0),r=r||o.step||1,s(r)?s(e)&&s(t)?m(e,t,r,o):((e,t,r=1,n={})=>{if(!s(e)&&e.length>1||!s(t)&&t.length>1)return f(e,t,n);let o=n.transform||(e=>String.fromCharCode(e)),i=(""+e).charCodeAt(0),a=(""+t).charCodeAt(0),c=i>a,l=Math.min(i,a),u=Math.max(i,a);if(n.toRegex&&1===r)return p(l,u,!1,n);let h=[],m=0;for(;c?i>=a:i<=a;)h.push(o(i,m)),i=c?i-r:i+r,m++;return!0===n.toRegex?d(h,null,{wrap:!1,options:n}):h})(e,t,Math.max(Math.abs(r),1),o):null==r||i(r)?g(e,t,1,r):((e,t)=>{if(!0===t.strictRanges)throw new TypeError(`Expected step "${e}" to be a number`);return[]})(r,o)};e.exports=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(21),o=r(22),i=r(77),a=r(83);class s extends a.default{constructor(){super(...arguments),this._walkStream=i.walkStream,this._stat=o.stat}dynamic(e,t){return this._walkStream(e,t)}static(e,t){const r=e.map(this._getFullEntryPath,this),o=new n.PassThrough({objectMode:!0});o._write=(n,i,a)=>this._getEntry(r[n],e[n],t).then(e=>{null!==e&&t.entryFilter(e)&&o.push(e),n===r.length-1&&o.end(),a()}).catch(a);for(let e=0;e<r.length;e++)o.write(e);return o}_getEntry(e,t,r){return this._getStat(e).then(e=>this._makeEntry(e,t)).catch(e=>{if(r.errorFilter(e))return null;throw e})}_getStat(e){return new Promise((t,r)=>{this._stat(e,this._fsStatSettings,(e,n)=>null===e?t(n):r(e))})}}t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(155),o=r(164),i=r(165),a=r(167);function s(e={}){return e instanceof a.default?e:new a.default(e)}t.Settings=a.default,t.walk=function(e,t,r){if("function"==typeof t)return new n.default(e,s()).read(t);new n.default(e,s(t)).read(r)},t.walkSync=function(e,t){const r=s(t);return new i.default(e,r).read()},t.walkStream=function(e,t){const r=s(t);return new o.default(e,r).read()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(79),o=r(53),i=r(162),a=r(54),s=r(82);class c extends s.default{constructor(e,t){super(e,t),this._settings=t,this._scandir=o.scandir,this._emitter=new n.EventEmitter,this._queue=i(this._worker.bind(this),this._settings.concurrency),this._isFatalError=!1,this._isDestroyed=!1,this._queue.drain=()=>{this._isFatalError||this._emitter.emit("end")}}read(){return this._isFatalError=!1,this._isDestroyed=!1,setImmediate(()=>{this._pushToQueue(this._root,this._settings.basePath)}),this._emitter}destroy(){if(this._isDestroyed)throw new Error("The reader is already destroyed");this._isDestroyed=!0,this._queue.killAndDrain()}onEntry(e){this._emitter.on("entry",e)}onError(e){this._emitter.once("error",e)}onEnd(e){this._emitter.once("end",e)}_pushToQueue(e,t){const r={directory:e,base:t};this._queue.push(r,e=>{null!==e&&this._handleError(e)})}_worker(e,t){this._scandir(e.directory,this._settings.fsScandirSettings,(r,n)=>{if(null!==r)return t(r,void 0);for(const t of n)this._handleEntry(t,e.base);t(null,void 0)})}_handleError(e){a.isFatalError(this._settings,e)&&(this._isFatalError=!0,this._isDestroyed=!0,this._emitter.emit("error",e))}_handleEntry(e,t){if(this._isDestroyed||this._isFatalError)return;const r=e.path;void 0!==t&&(e.path=a.joinPathSegments(t,e.name,this._settings.pathSegmentSeparator)),a.isAppliedFilter(this._settings.entryFilter,e)&&this._emitEntry(e),e.dirent.isDirectory()&&a.isAppliedFilter(this._settings.deepFilter,e)&&this._pushToQueue(r,e.path)}_emitEntry(e){this._emitter.emit("entry",e)}}t.default=c},function(e,t){e.exports=require("events")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=process.versions.node.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10),a=o>10,s=10===o&&i>=10;t.IS_SUPPORT_READDIR_WITH_FILE_TYPES=a||s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(158);t.fs=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(54);t.default=class{constructor(e,t){this._root=e,this._settings=t,this._root=n.replacePathSegmentSeparator(e,t.pathSegmentSeparator)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(22),i=r(17);t.default=class{constructor(e){this._settings=e,this._fsStatSettings=new o.Settings({followSymbolicLink:this._settings.followSymbolicLinks,fs:this._settings.fs,throwErrorOnBrokenSymbolicLink:this._settings.followSymbolicLinks})}_getFullEntryPath(e){return n.resolve(this._settings.cwd,e)}_makeEntry(e,t){const r={name:t,path:t,dirent:i.fs.createDirentFromStats(t,e)};return this._settings.stats&&(r.stats=e),r}_isFatalError(e){return!i.errno.isEnoentCodeError(e)&&!this._settings.suppressErrors}}},function(e,t,r){const n=r(10).fromCallback,o=r(6),i=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","link","lstat","mkdir","mkdtemp","open","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(e=>"function"==typeof o[e]);Object.keys(o).forEach(e=>{t[e]=o[e]}),i.forEach(e=>{t[e]=n(o[e])}),t.exists=function(e,t){return"function"==typeof t?o.exists(e,t):new Promise(t=>o.exists(e,t))},t.read=function(e,t,r,n,i,a){return"function"==typeof a?o.read(e,t,r,n,i,a):new Promise((a,s)=>{o.read(e,t,r,n,i,(e,t,r)=>{if(e)return s(e);a({bytesRead:t,buffer:r})})})},t.write=function(e,t,r,n,i,a){return"function"==typeof arguments[arguments.length-1]?o.write(e,t,r,n,i,a):new Promise("string"==typeof t?(i,a)=>{o.write(e,t,r,n,(e,t,r)=>{if(e)return a(e);i({bytesWritten:t,buffer:r})})}:(a,s)=>{o.write(e,t,r,n,i,(e,t,r)=>{if(e)return s(e);a({bytesWritten:t,buffer:r})})})}},function(e,t){e.exports=require("constants")},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(11).mkdirs,a=r(18).pathExists,s=r(88).utimesMillis,c=Symbol("notExist"),l=Symbol("existsReg");function u(e,t,r,n){const s=o.dirname(t);a(s,(o,a)=>o?n(o):a?p(e,t,r,n):void i(s,o=>o?n(o):p(e,t,r,n)))}function p(e,t,r,n){return r.filter?d(h,e,t,r,n):h(e,t,r,n)}function d(e,t,r,n,o){Promise.resolve(n.filter(t,r)).then(i=>i?e(t,r,n,o):o(),e=>o(e))}function h(e,t,r,i){(r.dereference?n.stat:n.lstat)(e,(a,s)=>a?i(a):s.isDirectory()?function(e,t,r,o,i){v(r,(a,s)=>a?i(a):s===c?b(t,r)?i(new Error(`Cannot copy '${t}' to a subdirectory of itself, '${r}'.`)):function(e,t,r,o,i){n.mkdir(r,e.mode,a=>{if(a)return i(a);n.chmod(r,e.mode,e=>e?i(e):y(t,r,o,i))})}(e,t,r,o,i):s===l?b(t,r)?i(new Error(`Cannot copy '${t}' to a subdirectory of itself, '${r}'.`)):function(e,t,r,o){n.stat(t,(n,i)=>n?o(n):i.isDirectory()?y(e,t,r,o):o(new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`)))}(t,r,o,i):t===s?i():y(t,r,o,i))}(s,e,t,r,i):s.isFile()||s.isCharacterDevice()||s.isBlockDevice()?function(e,t,r,n,o){v(r,(i,a)=>i?o(i):a===c?m(e,t,r,n,o):a===l?f(e,t,r,n,o):t===a?o():f(e,t,r,n,o))}(s,e,t,r,i):s.isSymbolicLink()?function(e,t,r,i){n.readlink(e,(e,a)=>{if(e)return i(e);r.dereference&&(a=o.resolve(process.cwd(),a)),v(t,(e,s)=>e?i(e):s===c||s===l?n.symlink(a,t,i):(r.dereference&&(s=o.resolve(process.cwd(),s)),s===a?i():void n.stat(t,(e,r)=>e?i(e):r.isDirectory()&&b(s,a)?i(new Error(`Cannot overwrite '${s}' with '${a}'.`)):function(e,t,r){n.unlink(t,o=>o?r(o):n.symlink(e,t,r))}(a,t,i))))})}(e,t,r,i):void 0)}function f(e,t,r,o,i){if(!o.overwrite)return o.errorOnExist?i(new Error(`'${r}' already exists`)):i();n.unlink(r,n=>n?i(n):m(e,t,r,o,i))}function m(e,t,r,o,i){return"function"==typeof n.copyFile?n.copyFile(t,r,t=>t?i(t):g(e,r,o,i)):function(e,t,r,o,i){const a=n.createReadStream(t);a.on("error",e=>i(e)).once("open",()=>{const t=n.createWriteStream(r,{mode:e.mode});t.on("error",e=>i(e)).on("open",()=>a.pipe(t)).once("close",()=>g(e,r,o,i))})}(e,t,r,o,i)}function g(e,t,r,o){n.chmod(t,e.mode,n=>n?o(n):r.preserveTimestamps?s(t,e.atime,e.mtime,o):o())}function y(e,t,r,i){n.readdir(e,(n,a)=>n?i(n):function e(t,r,n,i,a){const s=t.pop();if(!s)return a();p(o.join(r,s),o.join(n,s),i,o=>o?a(o):e(t,r,n,i,a))}(a,e,t,r,i))}function v(e,t){n.readlink(e,(e,r)=>e?"ENOENT"===e.code?t(null,c):"EINVAL"===e.code||"UNKNOWN"===e.code?t(null,l):t(e):t(null,r))}function b(e,t){const r=t.split(o.dirname(e)+o.sep)[1];if(r){const n=r.split(o.sep)[0];return!!n&&(e!==t&&t.indexOf(e)>-1&&n===o.basename(e))}return!1}e.exports=function(e,t,r,n){return"function"!=typeof r||n?"function"==typeof r&&(r={filter:r}):(n=r,r={}),n=n||function(){},(r=r||{}).clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),(e=o.resolve(e))===(t=o.resolve(t))?n(new Error("Source and destination must not be the same.")):r.filter?d(u,e,t,r,n):u(e,t,r,n)}},function(e,t,r){"use strict";const n=r(0);function o(e){return(e=n.normalize(n.resolve(e)).split(n.sep)).length>0?e[0]:null}const i=/[<>:"|?*]/;e.exports={getRootPath:o,invalidWin32Path:function(e){const t=o(e);return e=e.replace(t,""),i.test(e)}}},function(e,t,r){"use strict";const n=r(6),o=r(9),i=r(0);e.exports={hasMillisRes:function(e){let t=i.join("millis-test"+Date.now().toString()+Math.random().toString().slice(2));t=i.join(o.tmpdir(),t);const r=new Date(1435410243862);n.writeFile(t,"https://github.com/jprichardson/node-fs-extra/pull/141",o=>{if(o)return e(o);n.open(t,"r+",(o,i)=>{if(o)return e(o);n.futimes(i,r,r,r=>{if(r)return e(r);n.close(i,r=>{if(r)return e(r);n.stat(t,(t,r)=>{if(t)return e(t);e(null,r.mtime>1435410243e3)})})})})})},hasMillisResSync:function(){let e=i.join("millis-test-sync"+Date.now().toString()+Math.random().toString().slice(2));e=i.join(o.tmpdir(),e);const t=new Date(1435410243862);n.writeFileSync(e,"https://github.com/jprichardson/node-fs-extra/pull/141");const r=n.openSync(e,"r+");return n.futimesSync(r,t,t),n.closeSync(r),n.statSync(e).mtime>1435410243e3},timeRemoveMillis:function(e){if("number"==typeof e)return 1e3*Math.floor(e/1e3);if(e instanceof Date)return new Date(1e3*Math.floor(e.getTime()/1e3));throw new Error("fs-extra: timeRemoveMillis() unknown parameter type")},utimesMillis:function(e,t,r,o){n.open(e,"r+",(e,i)=>{if(e)return o(e);n.futimes(i,t,r,e=>{n.close(i,t=>{o&&o(e||t)})})})},utimesMillisSync:function(e,t,r){const o=n.openSync(e,"r+");return n.futimesSync(o,t,r),n.closeSync(o)}}},function(e,t,r){e.exports={copySync:r(185)}},function(e,t){e.exports=function(e){if("function"==typeof Buffer.allocUnsafe)try{return Buffer.allocUnsafe(e)}catch(t){return new Buffer(e)}return new Buffer(e)}},function(e,t){e.exports=require("azdata")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class o extends n{constructor(){super([o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),"-",o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),"-","4",o._randomHex(),o._randomHex(),o._randomHex(),"-",o._oneOf(o._timeHighBits),o._randomHex(),o._randomHex(),o._randomHex(),"-",o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex(),o._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return o._oneOf(o._chars)}}function i(){return new o}o._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],o._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=i;const a=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return a.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return i().asHex()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promptForPublishProfile=t.PublishDatabaseDialog=void 0;const n=r(2),o=r(1),i=r(3),a=r(57),s=r(15),c=r(58),l=r(59),u=r(27),p=r(66);function d(e){return n.window.showOpenDialog({title:o.selectProfile,canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,defaultUri:n.Uri.file(e),filters:{[o.publishSettingsFiles]:["publish.xml"]}})}t.PublishDatabaseDialog=class{constructor(e){this.project=e,this.existingServerSelected=!0,this.profileUsed=!1,this.completionPromise=new p.Deferred,this.toDispose=[],this.dialog=i.getAzdataApi().window.createModelViewDialog(o.publishDialogName,"sqlProjectPublishDialog"),this.toDispose.push(this.dialog.onClosed(e=>this.completionPromise.resolve())),this.publishTab=i.getAzdataApi().window.createTab(o.publishDialogName)}openDialog(){this.initializeDialog(),this.dialog.okButton.label=o.publish,this.dialog.okButton.enabled=!1,this.toDispose.push(this.dialog.okButton.onClick(async()=>await this.publishClick())),this.dialog.cancelButton.label=o.cancelButtonText;let e=i.getAzdataApi().window.createButton(o.generateScriptButtonText);this.toDispose.push(e.onClick(async()=>await this.generateScriptClick())),e.enabled=!1,this.dialog.customButtons=[],this.dialog.customButtons.push(e),i.getAzdataApi().window.openDialog(this.dialog)}set publishToExistingServer(e){this.existingServerSelected=e}waitForClose(){return this.completionPromise.promise}dispose(){this.toDispose.forEach(e=>e.dispose())}initializeDialog(){this.initializePublishTab(),this.dialog.content=[this.publishTab]}initializePublishTab(){this.publishTab.registerContent(async e=>{const t=this.createPublishTypeRadioButtons(e);this.createRadioButtons(e),this.createLocalDbInfoRow(e),this.dataSourcesFormComponent=this.createDataSourcesFormComponent(e),this.sqlCmdVariablesTable=this.createSqlCmdTable(e),this.loadSqlCmdVarsButton=this.createLoadSqlCmdVarsButton(e),this.sqlCmdVariablesFormComponentGroup={components:[{title:"",component:this.loadSqlCmdVarsButton},{title:"",component:this.sqlCmdVariablesTable}],title:o.sqlCmdVariables};const r=this.createProfileRow(e);this.connectionRow=this.createConnectionRow(e),this.databaseRow=this.createDatabaseRow(e);const n=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).component();n.addItems([r,this.databaseRow]),this.formBuilder=e.modelBuilder.formContainer().withFormItems([{title:"",components:[{component:t,title:""},{component:this.connectionRow,title:""},{component:n,title:""}]}],{horizontal:!1,titleFontSize:c.cssStyles.titleFontSize}).withLayout({width:"100%"}),Object.keys(this.project.sqlCmdVariables).length>0&&this.formBuilder.addFormItem(this.sqlCmdVariablesFormComponentGroup);let i=this.formBuilder.component();await e.initializeModel(i),await this.loadProfileTextBox.focus()})}async getConnectionUri(){try{let e;if(this.connectionIsDataSource){const t=this.dataSourcesDropDown.value.dataSource,r=t.getConnectionProfile();e=t.integratedSecurity?(await i.getAzdataApi().connection.connect(r,!1,!1)).connectionId:(await i.getAzdataApi().connection.openConnectionDialog(void 0,r)).connectionId}else{if(!this.connectionId)throw new Error("Connection not defined.");e=this.connectionId}return await i.getAzdataApi().connection.getUriForConnection(e)}catch(e){throw new Error(o.unableToCreatePublishConnection+": "+i.getErrorMessage(e))}}async publishClick(){var e,t,r,n;if(this.existingServerSelected){const e={databaseName:this.targetDatabaseName,serverName:this.getServerName(),connectionUri:await this.getConnectionUri(),sqlCmdVariables:this.getSqlCmdVariablesForPublish(),deploymentOptions:await this.getDeploymentOptions(),profileUsed:this.profileUsed};i.getAzdataApi().window.closeDialog(this.dialog),await this.publish(this.project,e)}else{const a=this.getBaseDockerImageName(),s=l.getDockerBaseImages().find(e=>e.name===a),c={localDbSetting:{dbName:this.targetDatabaseName,dockerBaseImage:a,dockerBaseImageEula:(null===(t=null===(e=null==s?void 0:s.agreementInfo)||void 0===e?void 0:e.link)||void 0===t?void 0:t.url)||"",password:(null===(r=this.serverAdminPasswordTextBox)||void 0===r?void 0:r.value)||"",port:+((null===(n=this.serverPortTextBox)||void 0===n?void 0:n.value)||o.defaultPortNumber),serverName:o.defaultLocalServerName,userName:o.defaultLocalServerAdminName},deploySettings:{databaseName:this.targetDatabaseName,serverName:o.defaultLocalServerName,connectionUri:"",sqlCmdVariables:this.getSqlCmdVariablesForPublish(),deploymentOptions:await this.getDeploymentOptions(),profileUsed:this.profileUsed}};i.getAzdataApi().window.closeDialog(this.dialog),await this.publishToContainer(this.project,c)}this.dispose()}async generateScriptClick(){var e;u.TelemetryReporter.sendActionEvent(u.TelemetryViews.SqlProjectPublishDialog,u.TelemetryActions.generateScriptClicked);const t=this.getSqlCmdVariablesForPublish(),r={databaseName:this.targetDatabaseName,serverName:this.getServerName(),connectionUri:await this.getConnectionUri(),sqlCmdVariables:t,deploymentOptions:await this.getDeploymentOptions(),profileUsed:this.profileUsed};i.getAzdataApi().window.closeDialog(this.dialog),await(null===(e=this.generateScript)||void 0===e?void 0:e.call(this,this.project,r)),this.dispose()}async getDeploymentOptions(){return this.deploymentOptions||(this.deploymentOptions=await i.getDefaultPublishDeploymentOptions(this.project)),this.deploymentOptions}getSqlCmdVariablesForPublish(){return{...this.sqlCmdVars}}get targetDatabaseName(){var e,t,r;return this.existingServerSelected?null!==(t=null===(e=this.targetDatabaseDropDown)||void 0===e?void 0:e.value)&&void 0!==t?t:"":(null===(r=this.targetDatabaseTextBox)||void 0===r?void 0:r.value)||""}set targetDatabaseName(e){var t;this.targetDatabaseDropDown.values=[],null===(t=this.targetDatabaseDropDown.values)||void 0===t||t.push(e),this.targetDatabaseDropDown.value=e,this.targetDatabaseTextBox&&(this.targetDatabaseTextBox.value=e)}getBaseDockerImageName(){var e,t;return null!==(t=null===(e=this.baseDockerImageDropDown)||void 0===e?void 0:e.value)&&void 0!==t?t:""}getDefaultDatabaseName(){return this.project.projectFileName}getServerName(){return this.serverName}createRadioButtons(e){return this.connectionsRadioButton=e.modelBuilder.radioButton().withProps({name:"connection",label:o.connectionRadioButtonLabel}).component(),this.connectionsRadioButton.checked=!0,this.connectionsRadioButton.onDidClick(()=>{this.formBuilder.removeFormItem(this.dataSourcesFormComponent),this.connectionIsDataSource=!1,this.targetDatabaseDropDown.value=this.getDefaultDatabaseName()}),this.dataSourcesRadioButton=e.modelBuilder.radioButton().withProps({name:"connection",label:o.dataSourceRadioButtonLabel}).component(),this.dataSourcesRadioButton.onDidClick(()=>{this.formBuilder.insertFormItem(this.dataSourcesFormComponent,2),this.connectionIsDataSource=!0,this.setDatabaseToSelectedDataSourceDatabase()}),e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).withItems([this.connectionsRadioButton,this.dataSourcesRadioButton]).withProps({ariaRole:"radiogroup"}).component()}createPublishTypeRadioButtons(e){const t=e.modelBuilder.text().withProps({value:o.publishTo,width:c.cssStyles.publishDialogLabelWidth}).component();this.existingServerRadioButton=e.modelBuilder.radioButton().withProps({name:"publishType",label:o.publishToExistingServer}).component(),this.existingServerRadioButton.checked=!0,this.existingServerRadioButton.onDidChangeCheckedState(t=>{this.onPublishTypeChange(t,e)}),this.dockerServerRadioButton=e.modelBuilder.radioButton().withProps({name:"publishType",label:o.publishToDockerContainer}).component(),this.dockerServerRadioButton.onDidChangeCheckedState(t=>{this.onPublishTypeChange(!t,e)});const r=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).withItems([this.existingServerRadioButton,this.dockerServerRadioButton]).withProps({ariaRole:"radiogroup"}).component();return e.modelBuilder.flexContainer().withLayout({flexFlow:"row",alignItems:"baseline"}).withItems([t,r],{CSSStyles:{flex:"0 0 auto","margin-right":"10px"}}).component()}onPublishTypeChange(e,t){this.existingServerSelected=e,this.createDatabaseRow(t),this.tryEnableGenerateScriptAndOkButtons(),e?(this.connectionRow&&this.formBuilder.insertFormItem({title:"",component:this.connectionRow},2),this.localDbSection&&this.formBuilder.removeFormItem({title:"",component:this.localDbSection})):(this.connectionRow&&this.formBuilder.removeFormItem({title:"",component:this.connectionRow}),this.localDbSection&&this.formBuilder.insertFormItem({title:"",component:this.localDbSection},2))}createTargetConnectionComponent(e){return this.targetConnectionTextBox=e.modelBuilder.inputBox().withProps({value:"",ariaLabel:o.targetConnectionLabel,placeHolder:o.selectConnection,width:c.cssStyles.publishDialogTextboxWidth,enabled:!1}).component(),this.targetConnectionTextBox.onTextChanged(()=>{this.tryEnableGenerateScriptAndOkButtons()}),this.targetConnectionTextBox}createDataSourcesFormComponent(e){if(this.project.dataSources.length>0)return this.createDataSourcesDropdown(e);{const t=e.modelBuilder.text().withProps({value:o.noDataSourcesText}).component();return{title:o.dataSourceDropdownTitle,component:t}}}createDataSourcesDropdown(e){let t=[];return this.project.dataSources.filter(e=>e instanceof a.SqlConnectionDataSource).forEach(e=>{const r=e.database,n=""+e.name;t.push({displayName:n,name:e.name,dataSource:e,database:r})}),this.dataSourcesDropDown=e.modelBuilder.dropDown().withProps({values:t}).component(),this.dataSourcesDropDown.onValueChanged(()=>{this.setDatabaseToSelectedDataSourceDatabase(),this.tryEnableGenerateScriptAndOkButtons()}),{title:o.dataSourceDropdownTitle,component:this.dataSourcesDropDown}}setDatabaseToSelectedDataSourceDatabase(){var e;(null===(e=this.dataSourcesDropDown.value)||void 0===e?void 0:e.database)&&(this.targetDatabaseDropDown.value=this.dataSourcesDropDown.value.database)}createProfileRow(e){const t=this.createLoadProfileButton(e);this.loadProfileTextBox=e.modelBuilder.inputBox().withProps({placeHolder:o.loadProfilePlaceholderText,ariaLabel:o.profile,width:c.cssStyles.publishDialogTextboxWidth}).component();const r=e.modelBuilder.text().withProps({value:o.profile,width:c.cssStyles.publishDialogLabelWidth}).component(),n=e.modelBuilder.flexContainer().withItems([r,this.loadProfileTextBox],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component();return n.insertItem(t,2,{CSSStyles:{"margin-right":"0px"}}),n}createConnectionRow(e){this.targetConnectionTextBox=this.createTargetConnectionComponent(e);const t=this.createSelectConnectionButton(e),r=e.modelBuilder.text().withProps({value:o.server,requiredIndicator:!0,width:c.cssStyles.publishDialogLabelWidth}).component(),n=e.modelBuilder.flexContainer().withItems([r,this.targetConnectionTextBox],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component();return n.insertItem(t,2,{CSSStyles:{"margin-right":"0px"}}),n}createLocalDbInfoRow(e){this.serverPortTextBox=e.modelBuilder.inputBox().withProps({value:o.defaultPortNumber,ariaLabel:o.serverPortNumber,placeHolder:o.serverPortNumber,width:c.cssStyles.publishDialogTextboxWidth,enabled:!0,inputType:"number",validationErrorMessage:o.portMustBeNumber}).withValidation(e=>i.validateSqlServerPortNumber(e.value)).component(),this.serverPortTextBox.onTextChanged(()=>{this.tryEnableGenerateScriptAndOkButtons()});const t=this.createFormRow(e,o.serverPortNumber,this.serverPortTextBox);this.serverAdminPasswordTextBox=e.modelBuilder.inputBox().withProps({value:"",ariaLabel:o.serverPassword,placeHolder:o.serverPassword,width:c.cssStyles.publishDialogTextboxWidth,enabled:!0,inputType:"password",validationErrorMessage:o.invalidSQLPasswordMessage}).withValidation(e=>!i.isEmptyString(e.value)&&i.isValidSQLPassword(e.value||"")).component();const r=this.createFormRow(e,o.serverPassword,this.serverAdminPasswordTextBox);this.serverConfigAdminPasswordTextBox=e.modelBuilder.inputBox().withProps({value:"",ariaLabel:o.confirmServerPassword,placeHolder:o.confirmServerPassword,width:c.cssStyles.publishDialogTextboxWidth,enabled:!0,inputType:"password",validationErrorMessage:o.passwordNotMatch}).withValidation(e=>{var t;return e.value===(null===(t=this.serverAdminPasswordTextBox)||void 0===t?void 0:t.value)}).component(),this.serverAdminPasswordTextBox.onTextChanged(()=>{this.tryEnableGenerateScriptAndOkButtons(),this.serverConfigAdminPasswordTextBox&&(this.serverConfigAdminPasswordTextBox.value="")}),this.serverConfigAdminPasswordTextBox.onTextChanged(()=>{this.tryEnableGenerateScriptAndOkButtons()});const n=this.createFormRow(e,o.confirmServerPassword,this.serverConfigAdminPasswordTextBox),a=l.getDockerBaseImages();this.baseDockerImageDropDown=e.modelBuilder.dropDown().withProps({values:a.map(e=>e.name),ariaLabel:o.baseDockerImage,width:c.cssStyles.publishDialogTextboxWidth,enabled:!0}).component();const s=a[0].agreementInfo,u=this.createFormRow(e,o.baseDockerImage,this.baseDockerImageDropDown);this.eulaCheckBox=e.modelBuilder.checkBox().withProps({ariaLabel:l.getAgreementDisplayText(s),required:!0}).component(),this.eulaCheckBox.onChanged(()=>{this.tryEnableGenerateScriptAndOkButtons()});const p=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",alignItems:"center"}).component();return this.localDbSection=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).component(),this.localDbSection.addItems([t,r,n,u,p]),this.baseDockerImageDropDown.onValueChanged(()=>{this.eulaCheckBox&&(this.eulaCheckBox.checked=!1);const t=l.getDockerBaseImages().find(e=>{var t;return e.name===(null===(t=this.baseDockerImageDropDown)||void 0===t?void 0:t.value)});if(null==t?void 0:t.agreementInfo.link){const r=e.modelBuilder.text().withProps({value:o.eulaAgreementTemplate,links:[t.agreementInfo.link],requiredIndicator:!0}).component();p&&this.eulaCheckBox&&(null==p||p.clearItems(),null==p||p.addItems([this.eulaCheckBox,r],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}}))}}),this.localDbSection}createFormRow(e,t,r){const n=e.modelBuilder.text().withProps({value:t,requiredIndicator:!0,width:c.cssStyles.publishDialogLabelWidth}).component();return e.modelBuilder.flexContainer().withItems([n,r],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component()}createDatabaseRow(e){let t;this.existingServerSelected?(void 0===this.targetDatabaseDropDown&&(this.targetDatabaseDropDown=e.modelBuilder.dropDown().withProps({values:[this.getDefaultDatabaseName()],value:this.getDefaultDatabaseName(),ariaLabel:o.databaseNameLabel,required:!0,width:c.cssStyles.publishDialogTextboxWidth,editable:!0,fireOnTextChange:!0}).component(),this.targetDatabaseDropDown.onValueChanged(()=>{this.tryEnableGenerateScriptAndOkButtons()})),t=this.targetDatabaseDropDown):(void 0===this.targetDatabaseTextBox&&(this.targetDatabaseTextBox=e.modelBuilder.inputBox().withProps({ariaLabel:o.databaseNameLabel,required:!0,width:c.cssStyles.publishDialogTextboxWidth,value:this.getDefaultDatabaseName()}).component()),t=this.targetDatabaseTextBox);const r=e.modelBuilder.text().withProps({value:o.databaseNameLabel,requiredIndicator:!0,width:c.cssStyles.publishDialogLabelWidth}).component(),n={flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}};return void 0===this.databaseRow?this.databaseRow=e.modelBuilder.flexContainer().withItems([r,t],n).withLayout({flexFlow:"row",alignItems:"center"}).component():(this.databaseRow.clearItems(),this.databaseRow.addItems([r,t],n)),this.databaseRow}createSqlCmdTable(e){this.sqlCmdVars={...this.project.sqlCmdVariables};const t=e.modelBuilder.declarativeTable().withProps({ariaLabel:o.sqlCmdVariables,dataValues:this.convertSqlCmdVarsToTableFormat(this.sqlCmdVars),columns:[{displayName:o.sqlCmdVariableColumn,valueType:i.getAzdataApi().DeclarativeDataType.string,width:"50%",isReadOnly:!0,headerCssStyles:c.cssStyles.tableHeader,rowCssStyles:c.cssStyles.tableRow},{displayName:o.sqlCmdValueColumn,valueType:i.getAzdataApi().DeclarativeDataType.string,width:"50%",isReadOnly:!1,headerCssStyles:c.cssStyles.tableHeader,rowCssStyles:c.cssStyles.tableRow}],width:"420px"}).component();return t.onDataChanged(()=>{var e;this.sqlCmdVars={},null===(e=t.dataValues)||void 0===e||e.forEach(e=>{this.sqlCmdVars[e[0].value]=e[1].value}),this.tryEnableGenerateScriptAndOkButtons()}),t}createLoadSqlCmdVarsButton(e){let t=e.modelBuilder.button().withProps({label:o.loadSqlCmdVarsButtonTitle,title:o.loadSqlCmdVarsButtonTitle,ariaLabel:o.loadSqlCmdVarsButtonTitle,width:"210px",iconPath:s.IconPathHelper.refresh,height:"18px",CSSStyles:{"font-size":"13px"}}).component();return t.onDidClick(async()=>{this.sqlCmdVars={...this.project.sqlCmdVariables};const e=this.convertSqlCmdVarsToTableFormat(this.sqlCmdVars);await this.sqlCmdVariablesTable.updateProperties({dataValues:e}),this.tryEnableGenerateScriptAndOkButtons()}),t}createSelectConnectionButton(e){let t=e.modelBuilder.button().withProps({ariaLabel:o.selectConnection,iconPath:s.IconPathHelper.selectConnection,height:"16px",width:"16px"}).component();return t.onDidClick(async()=>{let e=await i.getAzdataApi().connection.openConnectionDialog();this.connectionId=e.connectionId,this.serverName=e.options.server;let r=l.getConnectionName(e);await this.updateConnectionComponents(r,this.connectionId),e.options.database&&e.options.database!==o.master&&(this.targetDatabaseDropDown.value=e.options.database),t.iconPath=s.IconPathHelper.connect}),t}async updateConnectionComponents(e,t){if(this.targetConnectionTextBox.value=e,await this.targetConnectionTextBox.updateProperty("title",e),t){const e=(await i.getAzdataApi().connection.listDatabases(t)).filter(e=>!o.systemDbs.includes(e));this.targetDatabaseDropDown.values=e}}createLoadProfileButton(e){let t=e.modelBuilder.button().withProps({ariaLabel:o.loadProfilePlaceholderText,iconPath:s.IconPathHelper.folder_blue,height:"18px",width:"18px"}).component();return t.onDidClick(async()=>{var e,t;const r=await d(this.project.projectFolderPath);if(r&&0!==r.length&&this.readPublishProfile){const n=await this.readPublishProfile(r[0]);this.targetDatabaseName="",this.connectionId=n.connectionId,this.serverName=n.serverName,await this.updateConnectionComponents(n.connection,this.connectionId),n.databaseName&&(this.targetDatabaseName=n.databaseName),Object.keys(n.sqlCmdVariables).length?0===Object.keys(this.project.sqlCmdVariables).length&&0===Object.keys(this.sqlCmdVars).length&&(null===(e=this.formBuilder)||void 0===e||e.addFormItem(this.sqlCmdVariablesFormComponentGroup)):0===Object.keys(this.project.sqlCmdVariables).length&&(null===(t=this.formBuilder)||void 0===t||t.removeFormItem(this.sqlCmdVariablesFormComponentGroup));for(let e in n.sqlCmdVariables)this.sqlCmdVars[e]=n.sqlCmdVariables[e];this.deploymentOptions=n.options;const o=this.convertSqlCmdVarsToTableFormat(this.getSqlCmdVariablesForPublish());await this.sqlCmdVariablesTable.updateProperties({dataValues:o}),this.loadProfileTextBox.value=r[0].fsPath,await this.loadProfileTextBox.updateProperty("title",r[0].fsPath)}}),t}convertSqlCmdVarsToTableFormat(e){let t=[];for(let r in e)t.push([{value:r},{value:e[r]}]);return t}tryEnableGenerateScriptAndOkButtons(){var e,t,r,n,a,s,c;let l=!1,u=!1;(null===(e=this.existingServerRadioButton)||void 0===e?void 0:e.checked)?(this.targetConnectionTextBox.value&&this.targetDatabaseDropDown.value||this.connectionIsDataSource&&this.targetDatabaseDropDown.value)&&this.allSqlCmdVariablesFilled()&&(l=!0,u=!0):i.validateSqlServerPortNumber(null===(t=this.serverPortTextBox)||void 0===t?void 0:t.value)&&!i.isEmptyString(null===(r=this.serverAdminPasswordTextBox)||void 0===r?void 0:r.value)&&i.isValidSQLPassword((null===(n=this.serverAdminPasswordTextBox)||void 0===n?void 0:n.value)||"",o.defaultLocalServerAdminName)&&(null===(a=this.serverAdminPasswordTextBox)||void 0===a?void 0:a.value)===(null===(s=this.serverConfigAdminPasswordTextBox)||void 0===s?void 0:s.value)&&(null===(c=this.eulaCheckBox)||void 0===c?void 0:c.checked)&&(l=!0),this.dialog.okButton.enabled=l,this.dialog.customButtons[0].enabled=u}allSqlCmdVariablesFilled(){for(let e in this.sqlCmdVars)if(""===this.sqlCmdVars[e]||void 0===this.sqlCmdVars[e])return!1;return!0}},t.promptForPublishProfile=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(214),i=r(95),a=Object.keys(process.binding("natives")),s=i.prototype.require;t.makePatchingRequire=function(e){var t={};return function(r){var c=s.apply(this,arguments);if(e[r]){var l=i._resolveFilename(r,this);if(t.hasOwnProperty(l))return t[l];var u=void 0;if(a.indexOf(r)<0)try{u=s.call(this,n.join(r,"package.json")).version}catch(e){return c}else u=process.version.substring(1);var p=u.indexOf("-");p>=0&&(u=u.substring(0,p));for(var d=c,h=0,f=e[r];h<f.length;h++){var m=f[h];o.satisfies(u,m.versionSpecifier)&&(d=m.patch(d,l))}return t[l]=d}return c}}},function(e,t){e.exports=require("module")},function(e,t){e.exports=require("timers")},function(e){e.exports=JSON.parse('{"name":"async-hook-jl","description":"Inspect the life of handle objects in node","version":"1.7.6","author":"Andreas Madsen <amwebdk@gmail.com>","main":"./index.js","scripts":{"test":"node ./test/runner.js && eslint ."},"repository":{"type":"git","url":"git://github.com/jeff-lewis/async-hook-jl.git"},"keywords":["async","async hooks","inspect","async wrap"],"license":"MIT","dependencies":{"stack-chain":"^1.3.7"},"devDependencies":{"async":"1.5.x","cli-color":"1.1.x","eslint":"^3.4.0","endpoint":"0.4.x"},"engines":{"node":"^4.7 || >=6.9 || >=7.3"}}')},function(e,t,r){if(global._stackChain){if(global._stackChain.version!==r(99).version)throw new Error("Conflicting version of stack-chain found");e.exports=global._stackChain}else e.exports=global._stackChain=r(240)},function(e){e.exports=JSON.parse('{"name":"stack-chain","description":"API for combining call site modifiers","version":"1.3.7","author":"Andreas Madsen <amwebdk@gmail.com>","scripts":{"test":"tap ./test/simple"},"repository":{"type":"git","url":"git://github.com/AndreasMadsen/stack-chain.git"},"keywords":["stack","chain","trace","call site","concat","format"],"devDependencies":{"tap":"2.x.x","uglify-js":"2.5.x"},"license":"MIT"}')},function(e,t){e.exports=require("zlib")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvailabilityData=r(253),t.Base=r(102),t.ContextTagKeys=r(254),t.Data=r(255),t.DataPoint=r(256),t.DataPointType=r(103),t.Domain=r(19),t.Envelope=r(257),t.EventData=r(104),t.ExceptionData=r(258),t.ExceptionDetails=r(259),t.MessageData=r(260),t.MetricData=r(261),t.PageViewData=r(262),t.RemoteDependencyData=r(263),t.RequestData=r(264),t.SeverityLevel=r(265),t.StackFrame=r(266)},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t,r){"use strict";var n;!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(e,t){var r=+new Date;this.duration=r-this.startTime,this.statusCode=e;var n=this.properties||{};if(t)if("string"==typeof t)n.error=t;else if(t instanceof Error)n.error=t.message;else if("object"==typeof t)for(var o in t)n[o]=t[o]&&t[o].toString&&t[o].toString();this.properties=n},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();e.exports=n},function(e,t,r){"use strict";var n=r(16),o=r(23),i=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&"string"==typeof t)if(t.split(",").length>1)this.traceId=n.w3cTraceId(),this.spanId=n.w3cTraceId().substr(0,16);else{var i=t.trim().split("-"),a=i.length;a>=4?(this.version=i[0],this.traceId=i[1],this.spanId=i[2],this.traceFlag=i[3]):(this.traceId=n.w3cTraceId(),this.spanId=n.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=n.w3cTraceId()),"00"===this.version&&4!==a&&(this.traceId=n.w3cTraceId(),this.spanId=n.w3cTraceId().substr(0,16)),"ff"===this.version&&(this.version=e.DEFAULT_VERSION,this.traceId=n.w3cTraceId(),this.spanId=n.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=n.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=n.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=n.w3cTraceId().substr(0,16),this.traceId=n.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=o.getRootId(r);e.isValidTraceId(s)||(this.legacyRootId=s,s=n.w3cTraceId()),-1!==r.indexOf("|")&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=n.w3cTraceId(),this.spanId=n.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=n.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();e.exports=i},function(e,t,r){"use strict";var n=r(38),o=r(41),i=r(7),a=r(16),s=r(31),c=r(277),l=r(28),u=r(63),p=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||u.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(e,t){e&&!this._isAutoCorrelating?l.CorrelationContextManager.enable(t):!e&&this._isAutoCorrelating&&l.CorrelationContextManager.disable(),this._isAutoCorrelating=e},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return l.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(r){if(r){if("function"!=typeof r)throw new Error("onRequest handler must be a function");return function(n,o){l.CorrelationContextManager.wrapEmitter(n),l.CorrelationContextManager.wrapEmitter(o);var i=n&&!n[e.alreadyAutoCollectedFlag];if(n&&i){var a=new c(n),s=t._generateCorrelationContext(a);l.CorrelationContextManager.runWithContext(s,(function(){t._isEnabled&&(n[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:n,response:o},a)),"function"==typeof r&&r(n,o)}))}else"function"==typeof r&&r(n,o)}}},i=function(e){var t=e.addListener.bind(e);e.addListener=function(e,n){switch(e){case"request":case"checkContinue":return t(e,r(n));default:return t(e,n)}},e.on=e.addListener},a=n.createServer;n.createServer=function(e){var t=a(r(e));return i(t),t};var s=o.createServer;o.createServer=function(e,t){var n=s(e,r(t));return i(n),n}},e.trackRequestSync=function(t,r){if(r.request&&r.response&&t){e.addResponseCorrelationIdHeader(t,r.response);var n=l.CorrelationContextManager.getCurrentContext(),o=new c(r.request,n&&n.operation.parentId);n&&(n.operation.id=o.getOperationId(t.context.tags)||n.operation.id,n.operation.name=o.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=o.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(o.getCorrelationContextHeader())),e.endRequest(t,o,r,r.duration,r.error)}else i.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t)},e.trackRequest=function(t,r,n){if(r.request&&r.response&&t){var o=l.CorrelationContextManager.getCurrentContext(),s=n||new c(r.request,o&&o.operation.parentId);a.canIncludeCorrelationHeader(t,s.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),o&&!n&&(o.operation.id=s.getOperationId(t.context.tags)||o.operation.id,o.operation.name=s.getOperationName(t.context.tags)||o.operation.name,o.operation.parentId=s.getOperationParentId(t.context.tags)||o.operation.parentId,o.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",(function(){e.endRequest(t,s,r,null,null)})),r.request.on&&r.request.on("error",(function(n){e.endRequest(t,s,r,null,n)}))}else i.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t)},e.addResponseCorrelationIdHeader=function(e,t){if(e.config&&e.config.correlationId&&t.getHeader&&t.setHeader&&!t.headersSent){var r=t.getHeader(s.requestContextHeader);a.safeIncludeCorrelationHeader(e,t,r)}},e.endRequest=function(e,t,r,n,o){o?t.onError(o,n):t.onResponse(r.response,n);var i=t.getRequestTelemetry(r);if(i.tagOverrides=t.getRequestTags(e.context.tags),r.tagOverrides)for(var a in r.tagOverrides)i.tagOverrides[a]=r.tagOverrides[a];var s=t.getLegacyRootId();s&&(i.properties.ai_legacyRootId=s),i.contextObjects=i.contextObjects||{},i.contextObjects["http.ServerRequest"]=r.request,i.contextObjects["http.ServerResponse"]=r.response,e.trackRequest(i)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,l.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();e.exports=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reservedProjectFolders=t.Project=void 0;const n=r(0),o=r(109),i=r(1),a=r(3),s=r(295),c=r(9),l=r(37),u=r(2),p=r(4),d=r(27),h=r(42);class f{constructor(e){this._files=[],this._dataSources=[],this._importedTargets=[],this._databaseReferences=[],this._sqlCmdVariables={},this._preDeployScripts=[],this._postDeployScripts=[],this._noneDeployScripts=[],this._isSdkStyleProject=!1,this.projFileXmlDoc=void 0,this._projectFilePath=e,this._projectFileName=n.basename(e,".sqlproj")}get dacpacOutputPath(){return n.join(this.projectFolderPath,"bin","Debug",this._projectFileName+".dacpac")}get projectFolderPath(){return u.Uri.file(n.dirname(this._projectFilePath)).fsPath}get projectFilePath(){return this._projectFilePath}get projectFileName(){return this._projectFileName}get projectGuid(){return this._projectGuid}get files(){return this._files}get dataSources(){return this._dataSources}get importedTargets(){return this._importedTargets}get databaseReferences(){return this._databaseReferences}get sqlCmdVariables(){return this._sqlCmdVariables}get preDeployScripts(){return this._preDeployScripts}get postDeployScripts(){return this._postDeployScripts}get noneDeployScripts(){return this._noneDeployScripts}get isSdkStyleProject(){return this._isSdkStyleProject}static async openProject(e){const t=new f(e);return await t.readProjFile(),await t.updateProjectForRoundTrip(),t}async readProjFile(){this.resetProject();const e=await p.promises.readFile(this._projectFilePath);this.projFileXmlDoc=(new o.DOMParser).parseFromString(e.toString()),this._isSdkStyleProject=this.CheckForSdkStyleProject(),this._files=await this.readFilesInProject(),this.files.push(...await this.readFolders()),this._preDeployScripts=this.readPreDeployScripts(),this._postDeployScripts=this.readPostDeployScripts(),this._noneDeployScripts=this.readNoneDeployScripts(),this._databaseReferences=this.readDatabaseReferences(),this._importedTargets=this.readImportedTargets();try{this._sqlCmdVariables=a.readSqlCmdVariables(this.projFileXmlDoc,!1)}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.sqlCmdVariables,this.projectFilePath)),console.error(a.getErrorMessage(e))}try{this._projectGuid=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ProjectGuid)[0].childNodes[0].nodeValue}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.ProjectGuid,this.projectFilePath)),console.error(a.getErrorMessage(e))}}async readFilesInProject(){const e=new Set,t=[];if(this._isSdkStyleProject)try{(await a.getSqlFilesInFolder(this.projectFolderPath,!0)).forEach(t=>{e.add(a.convertSlashesForSqlProj(a.trimUri(u.Uri.file(this.projectFilePath),u.Uri.file(t))))})}catch(e){console.error(a.getErrorMessage(e))}for(let r=0;r<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;r++){const o=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[r];try{const r=o.getElementsByTagName(i.Build);for(let o=0;o<r.length;o++){const s=r[o].getAttribute(i.Include);if(s){const c=n.join(a.getPlatformSafeFileEntryPath(this.projectFolderPath),a.getPlatformSafeFileEntryPath(s));if(this._isSdkStyleProject&&!await a.exists(c)){(await a.globWithPattern(c)).forEach(t=>{const r=a.convertSlashesForSqlProj(a.trimUri(u.Uri.file(this.projectFilePath),u.Uri.file(t)));e.add(r)})}else{e.add(s);const n=r[o].getAttribute(i.Type);n&&t.push({relativePath:s,typeAttribute:n})}}if(this._isSdkStyleProject){const t=r[o].getAttribute(i.Remove);if(t){const r=n.join(a.getPlatformSafeFileEntryPath(this.projectFolderPath),a.getPlatformSafeFileEntryPath(t));(await a.globWithPattern(r)).forEach(t=>{const r=a.convertSlashesForSqlProj(a.trimUri(u.Uri.file(this.projectFilePath),u.Uri.file(t)));e.delete(r)})}}}}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.BuildElements,this.projectFilePath)),console.error(a.getErrorMessage(e))}}const r=[];return e.forEach(e=>{const n=t.find(t=>t.relativePath===e);r.push(this.createFileProjectEntry(e,h.EntryType.File,n?n.typeAttribute:void 0))}),r}async readFolders(){const e=[];if(this._isSdkStyleProject){(await a.getFoldersInFolder(this.projectFolderPath,!0)).forEach(t=>{e.push(this.createFileProjectEntry(a.trimUri(u.Uri.file(this.projectFilePath),u.Uri.file(t)),h.EntryType.Folder))})}for(let t=0;t<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;t++){const r=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[t];try{const t=r.getElementsByTagName(i.Folder);for(let r=0;r<t.length;r++){const n=t[r].getAttribute(i.Include);n===i.Properties||e.find(e=>e.relativePath===a.trimChars(n,"\\"))||e.push(this.createFileProjectEntry(n,h.EntryType.Folder))}}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.Folder,this.projectFilePath)),console.error(a.getErrorMessage(e))}}return e}readPreDeployScripts(){const e=[];let t=0;for(let r=0;r<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;r++){const n=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[r];try{const r=n.getElementsByTagName(i.PreDeploy);for(let n=0;n<r.length;n++)e.push(this.createFileProjectEntry(r[n].getAttribute(i.Include),h.EntryType.File)),t++}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.PreDeployElements,this.projectFilePath)),console.error(a.getErrorMessage(e))}}return t>1&&u.window.showWarningMessage(i.prePostDeployCount,i.okString),e}readPostDeployScripts(){const e=[];let t=0;for(let r=0;r<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;r++){const n=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[r];try{const r=n.getElementsByTagName(i.PostDeploy);for(let n=0;n<r.length;n++)e.push(this.createFileProjectEntry(r[n].getAttribute(i.Include),h.EntryType.File)),t++}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.PostDeployElements,this.projectFilePath)),console.error(a.getErrorMessage(e))}}return t>1&&u.window.showWarningMessage(i.prePostDeployCount,i.okString),e}readNoneDeployScripts(){const e=[];for(let t=0;t<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;t++){const r=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[t];try{const t=r.getElementsByTagName(i.None);for(let r=0;r<t.length;r++)e.push(this.createFileProjectEntry(t[r].getAttribute(i.Include),h.EntryType.File))}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.NoneElements,this.projectFilePath)),console.error(a.getErrorMessage(e))}}return e}readDatabaseReferences(){const e=[],t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference);for(let r=0;r<t.length;r++)try{if(t[r].getAttribute(i.Condition)!==i.NotNetCoreCondition){const n=t[r].getAttribute(i.Include);if(!n)throw new Error(i.invalidDatabaseReference);const o=t[r].getElementsByTagName(i.DatabaseVariableLiteralValue),s=1===o.length?o[0].childNodes[0].nodeValue:void 0,c=t[r].getElementsByTagName(i.SuppressMissingDependenciesErrors),l=1===c.length&&c[0].childNodes[0].nodeValue===i.True;a.convertSlashesForSqlProj(this.getSystemDacpacUri(s+".dacpac").fsPath).includes(n)?e.push(new h.SystemDatabaseReferenceProjectEntry(u.Uri.file(n),this.getSystemDacpacSsdtUri(s+".dacpac"),s,l)):e.push(new h.DacpacReferenceProjectEntry({dacpacFileLocation:u.Uri.file(a.getPlatformSafeFileEntryPath(n)),databaseName:s,suppressMissingDependenciesErrors:l}))}}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.DacpacReferenceElement,this.projectFilePath)),console.error(a.getErrorMessage(e))}const r=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ProjectReference);for(let t=0;t<r.length;t++)try{const n=r[t].getAttribute(i.Include);if(!n)throw new Error(i.invalidDatabaseReference);const o=r[t].getElementsByTagName(i.Name);let s="";try{s=o[0].childNodes[0].nodeValue}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.ProjectReferenceNameElement,this.projectFilePath)),console.error(a.getErrorMessage(e))}const c=r[t].getElementsByTagName(i.SuppressMissingDependenciesErrors),l=1===c.length&&c[0].childNodes[0].nodeValue===i.True;e.push(new h.SqlProjectReferenceProjectEntry({projectRelativePath:u.Uri.file(a.getPlatformSafeFileEntryPath(n)),projectName:s,projectGuid:"",suppressMissingDependenciesErrors:l}))}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.ProjectReferenceElement,this.projectFilePath)),console.error(a.getErrorMessage(e))}return e}readImportedTargets(){const e=[];try{const t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Import);for(let r=0;r<t.length;r++){const n=t[r];e.push(n.getAttribute(i.Project))}}catch(e){u.window.showErrorMessage(i.errorReadingProject(i.ImportElements,this.projectFilePath)),console.error(a.getErrorMessage(e))}return e}resetProject(){this._files=[],this._importedTargets=[],this._databaseReferences=[],this._sqlCmdVariables={},this._preDeployScripts=[],this._postDeployScripts=[],this._noneDeployScripts=[],this.projFileXmlDoc=void 0}CheckForSdkStyleProject(){const e=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Sdk);if(e.length>0)return e[0].getAttribute(i.Name)===i.sqlProjectSdk;const t=this.projFileXmlDoc.documentElement.getAttribute(i.Sdk);if(t)return t.includes(i.sqlProjectSdk);const r=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Import);for(let e=0;e<r.length;e++)if(r[e].getAttribute(i.Sdk)===i.sqlProjectSdk)return!0;return!1}async updateProjectForRoundTrip(){if(!(this._importedTargets.includes(i.NetCoreTargets)&&!this.containsSSDTOnlySystemDatabaseReferences()||this.isSdkStyleProject))if(d.TelemetryReporter.sendActionEvent(d.TelemetryViews.ProjectController,d.TelemetryActions.updateProjectForRoundtrip),this._importedTargets.includes(i.NetCoreTargets)){if(this.containsSSDTOnlySystemDatabaseReferences()){await u.window.showWarningMessage(i.updateProjectDatabaseReferencesForRoundTrip(this.projectFileName),i.yesString,i.noString)===i.yesString&&(await p.promises.copyFile(this._projectFilePath,this._projectFilePath+"_backup"),await this.updateSystemDatabaseReferencesInProjFile())}}else{await u.window.showWarningMessage(i.updateProjectForRoundTrip(this.projectFileName),i.yesString,i.noString)===i.yesString&&(await p.promises.copyFile(this._projectFilePath,this._projectFilePath+"_backup"),await this.updateImportToSupportRoundTrip(),await this.updatePackageReferenceInProjFile(),await this.updateBeforeBuildTargetInProjFile(),await this.updateSystemDatabaseReferencesInProjFile())}}async updateImportToSupportRoundTrip(){for(let e=0;e<this.projFileXmlDoc.documentElement.getElementsByTagName(i.Import).length;e++){const t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Import)[e];let r=t.getAttribute(i.Condition),n=t.getAttribute(i.Project);r===i.SqlDbPresentCondition&&n===i.SqlDbTargets&&await this.updateImportedTargetsToProjFile(i.RoundTripSqlDbPresentCondition,n,t),r===i.SqlDbNotPresentCondition&&n===i.MsBuildtargets&&await this.updateImportedTargetsToProjFile(i.RoundTripSqlDbNotPresentCondition,n,t)}await this.updateImportedTargetsToProjFile(i.NetCoreCondition,i.NetCoreTargets,void 0)}async updateBeforeBuildTargetInProjFile(){for(let e=0;e<this.projFileXmlDoc.documentElement.getElementsByTagName(i.Target).length;e++){const t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Target)[e];if(t.getAttribute(i.Name)===i.BeforeBuildTarget)return await this.createCleanFileNode(t)}const e=this.projFileXmlDoc.createElement(i.Target);e.setAttribute(i.Name,i.BeforeBuildTarget),this.projFileXmlDoc.documentElement.appendChild(e),await this.createCleanFileNode(e)}async createCleanFileNode(e){const t=this.projFileXmlDoc.createElement(i.Delete);t.setAttribute(i.Files,i.ProjJsonToClean),e.appendChild(t),await this.serializeToProjFile(this.projFileXmlDoc)}async addFolderItem(e){const t=await this.ensureFolderItems(e);if(t)return t;throw new Error(i.outsideFolderPath)}async addScriptItem(e,t,r){const o=n.join(this.projectFolderPath,e);if(t){await p.promises.mkdir(n.dirname(o),{recursive:!0});try{await p.promises.writeFile(o,t,{flag:"wx"})}catch(e){if("EEXIST"===e.code)throw new Error(i.fileAlreadyExists(n.parse(o).name));throw e}}else{if(!await a.exists(o))throw new Error(i.noFileExist(o))}await this.ensureFolderItems(n.relative(this.projectFolderPath,n.dirname(o)));const s=a.convertSlashesForSqlProj(e),c=this.files.find(e=>e.relativePath.toUpperCase()===s.toUpperCase());if(c)return c;const u=this.createFileProjectEntry(s,h.EntryType.File);let d;switch(r){case l.preDeployScript:d=i.PreDeploy,0===this._preDeployScripts.length?this._preDeployScripts.push(u):this._noneDeployScripts.push(u);break;case l.postDeployScript:d=i.PostDeploy,0===this._postDeployScripts.length?this._postDeployScripts.push(u):this._noneDeployScripts.push(u);break;default:d=i.Build,this._files.push(u)}const f=new Map;return r===l.externalStreamingJob&&(u.sqlObjectType=i.ExternalStreamingJob,f.set(i.Type,i.ExternalStreamingJob)),await this.addToProjFile(u,d,f),u}async exclude(e){const t=this._files.concat(this._preDeployScripts).concat(this._postDeployScripts).concat(this._noneDeployScripts).filter(t=>t.fsUri.fsPath.startsWith(e.fsUri.fsPath));await this.removeFromProjFile(t),this._files=this._files.filter(t=>!t.fsUri.fsPath.startsWith(e.fsUri.fsPath)),this._preDeployScripts=this._preDeployScripts.filter(t=>!t.fsUri.fsPath.startsWith(e.fsUri.fsPath)),this._postDeployScripts=this._postDeployScripts.filter(t=>!t.fsUri.fsPath.startsWith(e.fsUri.fsPath)),this._noneDeployScripts=this._noneDeployScripts.filter(t=>!t.fsUri.fsPath.startsWith(e.fsUri.fsPath))}async deleteFileFolder(e){const t=this._files.concat(this._preDeployScripts).concat(this._postDeployScripts).concat(this._noneDeployScripts).filter(t=>t.fsUri.fsPath.startsWith(e.fsUri.fsPath)&&t.type===h.EntryType.File),r=this._files.filter(t=>t.fsUri.fsPath.startsWith(e.fsUri.fsPath)&&t.type===h.EntryType.Folder);await Promise.all(t.map(e=>p.promises.unlink(e.fsUri.fsPath))),await Promise.all(r.map(e=>p.promises.rmdir(e.fsUri.fsPath,{recursive:!0}))),await this.exclude(e)}async deleteDatabaseReference(e){await this.removeFromProjFile(e),this._databaseReferences=this._databaseReferences.filter(t=>t!==e)}async changeTargetPlatform(e){if(this.getProjectTargetVersion()!==e){d.TelemetryReporter.createActionEvent(d.TelemetryViews.ProjectTree,d.TelemetryActions.changePlatformType).withAdditionalProperties({from:this.getProjectTargetVersion(),to:e}).send();const t=`${i.MicrosoftDatatoolsSchemaSqlSql}${e}${i.databaseSchemaProvider}`;this.projFileXmlDoc.getElementsByTagName(i.DSP)[0].childNodes[0].data=t,this.projFileXmlDoc.getElementsByTagName(i.DSP)[0].childNodes[0].nodeValue=t;const r=this._databaseReferences.filter(e=>e instanceof h.SystemDatabaseReferenceProjectEntry);if(r.length>0)for(let e of r)this.removeDatabaseReferenceFromProjFile(e),e.fsUri=this.getSystemDacpacUri(e.databaseName+".dacpac"),e.ssdtUri=this.getSystemDacpacSsdtUri(e.databaseName+".dacpac"),await this.addDatabaseReferenceToProjFile(e);await this.serializeToProjFile(this.projFileXmlDoc)}}async addSystemDatabaseReference(e){let t,r;e.systemDb===h.SystemDatabase.master?(t=this.getSystemDacpacUri(i.masterDacpac),r=this.getSystemDacpacSsdtUri(i.masterDacpac)):(t=this.getSystemDacpacUri(i.msdbDacpac),r=this.getSystemDacpacSsdtUri(i.msdbDacpac));const n=new h.SystemDatabaseReferenceProjectEntry(t,r,e.databaseName,e.suppressMissingDependenciesErrors);if(this.databaseReferenceExists(n))throw new Error(i.databaseReferenceAlreadyExists);await this.addToProjFile(n)}getSystemDacpacUri(e){const t=this.getSystemDacpacFolderName();return u.Uri.parse(n.join("$(NETCoreTargetsPath)","SystemDacpacs",t,e))}getSystemDacpacSsdtUri(e){const t=this.getSystemDacpacFolderName();return u.Uri.parse(n.join("$(DacPacRootPath)","Extensions","Microsoft","SQLDB","Extensions","SqlServer",t,"SqlSchemas",e))}getSystemDacpacFolderName(){const e=this.getProjectTargetVersion();return e===i.targetPlatformToVersion.get("Microsoft Azure SQL Data Warehouse")?i.AzureDwFolder:e}getProjectTargetVersion(){let e;try{e=this.evaluateProjectPropertyValue(i.DSP)}catch{}if(!e)throw new Error(i.invalidDataSchemaProvider);const t=e.substring(i.MicrosoftDatatoolsSchemaSqlSql.length,e.length-i.databaseSchemaProvider.length);if(!Array.from(i.targetPlatformToVersion.values()).includes(t))throw new Error(i.invalidDataSchemaProvider);return t}getDatabaseDefaultCollation(){return this.evaluateProjectPropertyValue(i.DefaultCollationProperty,i.DefaultCollation)}async addDatabaseReference(e){const t=new h.DacpacReferenceProjectEntry(e);if(this.databaseReferenceExists(t))throw new Error(i.databaseReferenceAlreadyExists);await this.addToProjFile(t)}async addProjectReference(e){const t=new h.SqlProjectReferenceProjectEntry(e);if(this.databaseReferenceExists(t))throw new Error(i.databaseReferenceAlreadyExists);await this.addToProjFile(t)}async addSqlCmdVariable(e,t){const r=new h.SqlCmdVariableProjectEntry(e,t);await this.addToProjFile(r)}createFileProjectEntry(e,t,r){let o=a.getPlatformSafeFileEntryPath(e);return new h.FileProjectEntry(u.Uri.file(n.join(this.projectFolderPath,o)),a.convertSlashesForSqlProj(e),t,r)}findOrCreateItemGroup(e,t){let r=void 0;if(e)for(let t=0;t<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup).length;t++){const n=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ItemGroup)[t];if(n.getElementsByTagName(e).length>0){r=n;break}}return r||(r=this.projFileXmlDoc.createElement(i.ItemGroup),this.projFileXmlDoc.documentElement.appendChild(r),t&&(t.scriptExist=!1)),r}async addFileToProjFile(e,t,r){let n;if(t===i.PreDeploy||t===i.PostDeploy){let e={scriptExist:!0};n=this.findOrCreateItemGroup(t,e),!0===e.scriptExist&&(u.window.showInformationMessage(i.deployScriptExists(t)),t=i.None)}else{const o=await this.readFilesInProject();if(0===(null==r?void 0:r.size)&&o.find(t=>t.relativePath===a.convertSlashesForSqlProj(e)))return;n=this.findOrCreateItemGroup(t)}const o=this.projFileXmlDoc.createElement(t);if(o.setAttribute(i.Include,a.convertSlashesForSqlProj(e)),r)for(const e of r.keys())o.setAttribute(e,r.get(e));n.appendChild(o)}async removeFileFromProjFile(e){const t=[this.projFileXmlDoc.documentElement.getElementsByTagName(i.Build),this.projFileXmlDoc.documentElement.getElementsByTagName(i.PreDeploy),this.projFileXmlDoc.documentElement.getElementsByTagName(i.PostDeploy),this.projFileXmlDoc.documentElement.getElementsByTagName(i.None)];let r=!1;for(let n=0;n<t.length;n++)if(r=this.removeNode(e,t[n]),r){if(this.isSdkStyleProject)break;return}if(!this.isSdkStyleProject)throw new Error(i.unableToFindObject(e,i.fileObject));r&&await this.serializeToProjFile(this.projFileXmlDoc);if((await this.readFilesInProject()).find(t=>t.relativePath===a.convertSlashesForSqlProj(e))){const t=this.projFileXmlDoc.createElement(i.Build);t.setAttribute(i.Remove,a.convertSlashesForSqlProj(e)),this.findOrCreateItemGroup(i.Build).appendChild(t)}}removeNode(e,t){for(let r=0;r<t.length;r++){const n=t[r].parentNode;if(t[r].getAttribute(i.Include)===a.convertSlashesForSqlProj(e)){n.removeChild(t[r]);return 0===Array.from(n.childNodes).filter(e=>e.childNodes).length&&n.parentNode.removeChild(n),!0}}return!1}addFolderToProjFile(e){const t=this.projFileXmlDoc.createElement(i.Folder);t.setAttribute(i.Include,a.convertSlashesForSqlProj(e)),this.findOrCreateItemGroup(i.Folder).appendChild(t)}removeFolderFromProjFile(e){const t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.Folder);if(!this.removeNode(e,t))throw new Error(i.unableToFindObject(e,i.folderObject))}removeSqlCmdVariableFromProjFile(e){const t=this.projFileXmlDoc.documentElement.getElementsByTagName(i.SqlCmdVariable);if(!this.removeNode(e,t))throw new Error(i.unableToFindSqlCmdVariable(e))}removeDatabaseReferenceFromProjFile(e){const t=e instanceof h.SqlProjectReferenceProjectEntry?i.ProjectReference:i.ArtifactReference,r=this.projFileXmlDoc.documentElement.getElementsByTagName(t),n=this.removeNode(e.pathForSqlProj(),r);if(e instanceof h.SystemDatabaseReferenceProjectEntry){const t=e.ssdtPathForSqlProj();this.removeNode(t,r)}if(!n)throw new Error(i.unableToFindDatabaseReference(e.databaseName))}async addSystemDatabaseReferenceToProjFile(e){const t=this.projFileXmlDoc.createElement(i.ArtifactReference);t.setAttribute(i.Condition,i.NetCoreCondition),t.setAttribute(i.Include,e.pathForSqlProj()),await this.addDatabaseReferenceChildren(t,e),this.findOrCreateItemGroup(i.ArtifactReference).appendChild(t);const r=this.projFileXmlDoc.createElement(i.ArtifactReference);r.setAttribute(i.Condition,i.NotNetCoreCondition),r.setAttribute(i.Include,e.ssdtPathForSqlProj()),await this.addDatabaseReferenceChildren(r,e),this.findOrCreateItemGroup(i.ArtifactReference).appendChild(r)}async addDatabaseReferenceToProjFile(e){if(e instanceof h.SystemDatabaseReferenceProjectEntry)await this.addSystemDatabaseReferenceToProjFile(e);else if(e instanceof h.SqlProjectReferenceProjectEntry){const t=this.projFileXmlDoc.createElement(i.ProjectReference);t.setAttribute(i.Include,e.pathForSqlProj()),this.addProjectReferenceChildren(t,e),await this.addDatabaseReferenceChildren(t,e),this.findOrCreateItemGroup(i.ProjectReference).appendChild(t)}else{const t=this.projFileXmlDoc.createElement(i.ArtifactReference);t.setAttribute(i.Include,e.pathForSqlProj()),await this.addDatabaseReferenceChildren(t,e),this.findOrCreateItemGroup(i.ArtifactReference).appendChild(t)}this.databaseReferenceExists(e)||this._databaseReferences.push(e)}databaseReferenceExists(e){return void 0!==this._databaseReferences.find(t=>t.pathForSqlProj()===e.pathForSqlProj())}async addDatabaseReferenceChildren(e,t){const r=this.projFileXmlDoc.createElement(i.SuppressMissingDependenciesErrors),n=this.projFileXmlDoc.createTextNode(t.suppressMissingDependenciesErrors?i.True:i.False);if(r.appendChild(n),e.appendChild(r),t.databaseSqlCmdVariable){const r=this.projFileXmlDoc.createElement(i.DatabaseSqlCmdVariable),n=this.projFileXmlDoc.createTextNode(t.databaseSqlCmdVariable);r.appendChild(n),e.appendChild(r),await this.addSqlCmdVariable(t.databaseSqlCmdVariable,t.databaseVariableLiteralValue)}else if(t.databaseVariableLiteralValue){const r=this.projFileXmlDoc.createElement(i.DatabaseVariableLiteralValue),n=this.projFileXmlDoc.createTextNode(t.databaseVariableLiteralValue);r.appendChild(n),e.appendChild(r)}if(t.serverSqlCmdVariable){const r=this.projFileXmlDoc.createElement(i.ServerSqlCmdVariable),n=this.projFileXmlDoc.createTextNode(t.serverSqlCmdVariable);r.appendChild(n),e.appendChild(r),await this.addSqlCmdVariable(t.serverSqlCmdVariable,t.serverName)}}addProjectReferenceChildren(e,t){const r=this.projFileXmlDoc.createElement(i.Name),n=this.projFileXmlDoc.createTextNode(t.projectName);r.appendChild(n),e.appendChild(r);const o=this.projFileXmlDoc.createElement(i.Project),a=this.projFileXmlDoc.createTextNode(t.projectGuid);o.appendChild(a),e.appendChild(o);const s=this.projFileXmlDoc.createElement(i.Private),c=this.projFileXmlDoc.createTextNode(i.True);s.appendChild(c),e.appendChild(s)}async addSqlCmdVariableToProjFile(e){Object.keys(this._sqlCmdVariables).includes(e.variableName)&&await this.removeFromProjFile(e);const t=this.projFileXmlDoc.createElement(i.SqlCmdVariable);t.setAttribute(i.Include,e.variableName),this.addSqlCmdVariableChildren(t,e),this.findOrCreateItemGroup(i.SqlCmdVariable).appendChild(t),this._sqlCmdVariables[e.variableName]=e.defaultValue}addSqlCmdVariableChildren(e,t){const r=this.projFileXmlDoc.createElement(i.DefaultValue),n=this.projFileXmlDoc.createTextNode(t.defaultValue);r.appendChild(n),e.appendChild(r);const o=this.projFileXmlDoc.createElement(i.Value),a=this.projFileXmlDoc.createTextNode(`$(SqlCmdVar__${this.getNextSqlCmdVariableCounter()})`);o.appendChild(a),e.appendChild(o)}getNextSqlCmdVariableCounter(){const e=this.projFileXmlDoc.documentElement.getElementsByTagName(i.SqlCmdVariable);let t=0;for(let r=0;r<e.length;r++){const n=e[r].getElementsByTagName(i.Value)[0].childNodes[0].nodeValue,o=parseInt(n.substring(13).slice(0,-1));o>t&&(t=o)}return t+1}async updateImportedTargetsToProjFile(e,t,r){const n=this.projFileXmlDoc.createElement(i.Import);return n.setAttribute(i.Condition,e),n.setAttribute(i.Project,t),r?this.projFileXmlDoc.documentElement.replaceChild(n,r):(this.projFileXmlDoc.documentElement.appendChild(n),this._importedTargets.push(t)),await this.serializeToProjFile(this.projFileXmlDoc),n}async updatePackageReferenceInProjFile(){const e=this.projFileXmlDoc.createElement(i.PackageReference);e.setAttribute(i.Condition,i.NetCoreCondition),e.setAttribute(i.Include,i.NETFrameworkAssembly),e.setAttribute(i.Version,i.VersionNumber),e.setAttribute(i.PrivateAssets,i.All),this.findOrCreateItemGroup(i.PackageReference).appendChild(e),await this.serializeToProjFile(this.projFileXmlDoc)}containsSSDTOnlySystemDatabaseReferences(){var e;for(let t=0;t<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference).length;t++){const r=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference)[t];if(r.getAttribute(i.Condition)!==i.NetCoreCondition&&r.getAttribute(i.Condition)!==i.NotNetCoreCondition&&(null===(e=r.getAttribute(i.Include))||void 0===e?void 0:e.includes(i.DacpacRootPath)))return!0}return!1}async updateSystemDatabaseReferencesInProjFile(){var e,t,r;for(let n=0;n<this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference).length;n++){const o=this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference)[n];if(!o.getAttribute(i.Condition)&&(null===(e=o.getAttribute(i.Include))||void 0===e?void 0:e.includes(i.DacpacRootPath))){const e=(null===(t=o.getAttribute(i.Include))||void 0===t?void 0:t.includes(i.master))?h.SystemDatabase.master:h.SystemDatabase.msdb,n=null===(r=o.getElementsByTagName(i.DatabaseVariableLiteralValue)[0].childNodes[0])||void 0===r?void 0:r.nodeValue,a=o.getElementsByTagName(i.SuppressMissingDependenciesErrors)[0].childNodes[0].nodeValue===i.True;this.projFileXmlDoc.documentElement.removeChild(o),0===this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference).length&&this.projFileXmlDoc.documentElement.removeChild(o.parentNode),this._databaseReferences.splice(this._databaseReferences.findIndex(t=>t.databaseName===(e===h.SystemDatabase.master?i.master:i.msdb)),1),await this.addSystemDatabaseReference({databaseName:n,systemDb:e,suppressMissingDependenciesErrors:a})}}d.TelemetryReporter.createActionEvent(d.TelemetryViews.ProjectController,d.TelemetryActions.updateSystemDatabaseReferencesInProjFile).withAdditionalMeasurements({referencesCount:this.projFileXmlDoc.documentElement.getElementsByTagName(i.ArtifactReference).length}).send()}async addToProjFile(e,t,r){switch(e.type){case h.EntryType.File:await this.addFileToProjFile(e.relativePath,t||i.Build,r);break;case h.EntryType.Folder:this.addFolderToProjFile(e.relativePath);break;case h.EntryType.DatabaseReference:await this.addDatabaseReferenceToProjFile(e);break;case h.EntryType.SqlCmdVariable:await this.addSqlCmdVariableToProjFile(e)}await this.serializeToProjFile(this.projFileXmlDoc)}async removeFromProjFile(e){e instanceof h.ProjectEntry&&(e=[e]);for(const t of e)switch(t.type){case h.EntryType.File:await this.removeFileFromProjFile(t.relativePath);break;case h.EntryType.Folder:this.removeFolderFromProjFile(t.relativePath);break;case h.EntryType.DatabaseReference:this.removeDatabaseReferenceFromProjFile(t);break;case h.EntryType.SqlCmdVariable:this.removeSqlCmdVariableFromProjFile(t.variableName)}await this.serializeToProjFile(this.projFileXmlDoc)}async serializeToProjFile(e){let t=(new o.XMLSerializer).serializeToString(e);t=s(t,{collapseContent:!0,indentation:"  ",lineSeparator:c.EOL,whiteSpaceAtEndOfSelfclosingTag:!0}),await p.promises.writeFile(this._projectFilePath,t),this.projFileXmlDoc=(new o.DOMParser).parseFromString(t)}async addToProject(e){for(let t of e){if(!await a.exists(t.fsPath))throw new Error(i.fileOrFolderDoesNotExist(t.fsPath))}for(let t of e){const e=a.trimChars(a.trimUri(u.Uri.file(this._projectFilePath),t),"/");if(e.length>0){const r=await p.promises.stat(t.fsPath);r.isFile()&&t.fsPath.toLowerCase().endsWith(i.sqlFileExtension)?await this.addScriptItem(e):r.isDirectory()&&await this.addFolderItem(e)}}}evaluateProjectPropertyValue(e,t){const r=this.projFileXmlDoc.getElementsByTagName(e);if(0===r.length)return t;const n=r[0];if(1!==n.childNodes.length)throw new Error(i.invalidProjectPropertyValue(e));return n.childNodes[0].nodeValue}async ensureFolderItems(e){const t=n.join(this.projectFolderPath,e),r=n.normalize(this.projectFolderPath);if(!t.toUpperCase().startsWith(r.toUpperCase()))return;if(await p.promises.mkdir(t,{recursive:!0}),this.isSdkStyleProject)return this.createFileProjectEntry(e,h.EntryType.Folder);const o=a.convertSlashesForSqlProj(t.substring(r.length)),s=a.trimChars(o," \\").split(i.SqlProjPathSeparator);let c,l="";for(let e of s)e&&(l+=e+i.SqlProjPathSeparator,c=this.files.find(e=>a.ensureTrailingSlash(e.relativePath.toUpperCase())===l.toUpperCase()),c||(c=this.createFileProjectEntry(l,h.EntryType.Folder),this.files.push(c),await this.addToProjFile(c)));return c}}t.Project=f,t.reservedProjectFolders=["Properties","Data Sources","Database References"]},function(e,t,r){function n(e){this.options=e||{locator:{}}}function o(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function a(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function c(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var r=this.options,n=new u,i=r.domBuilder||new o,s=r.errorHandler,c=r.locator,p=r.xmlns||{},d=/\/x?html?$/.test(t),h=d?l.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return c&&i.setDocumentLocator(c),n.errorHandler=function(e,t,r){if(!e){if(t instanceof o)return t;e=t}var n={},i=e instanceof Function;function s(t){var o=e[t];!o&&i&&(o=2==e.length?function(r){e(t,r)}:e),n[t]=o&&function(e){o("[xmldom "+t+"]\t"+e+a(r))}||function(){}}return r=r||{},s("warning"),s("error"),s("fatalError"),n}(s,i,c),n.domBuilder=r.domBuilder||i,d&&(p[""]="http://www.w3.org/1999/xhtml"),p.xml=p.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,p,h):n.errorHandler.error("invalid doc source"),i.doc},o.prototype={startDocument:function(){this.doc=(new p).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var o=this.doc,a=o.createElementNS(e,r||t),s=n.length;c(this,a),this.currentElement=a,this.locator&&i(this.locator,a);for(var l=0;l<s;l++){e=n.getURI(l);var u=n.getValue(l),p=(r=n.getQName(l),o.createAttributeNS(e,r));this.locator&&i(n.getLocator(l),p),p.value=p.nodeValue=u,a.setAttributeNode(p)}},endElement:function(e,t,r){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,r),c(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=s.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&i(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=s.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&i(this.locator,n),c(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var o=n.createDocumentType(e,t,r);this.locator&&i(this.locator,o),c(this,o)}},warning:function(e){console.warn("[xmldom warning]\t"+e,a(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,a(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,a(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){o.prototype[e]=function(){return null}}));var l=r(293),u=r(294).XMLReader,p=t.DOMImplementation=r(110).DOMImplementation;t.XMLSerializer=r(110).XMLSerializer,t.DOMParser=n},function(e,t){function r(e,t){for(var r in e)t[r]=e[r]}function n(e,t){var n=e.prototype;if(!(n instanceof t)){function o(){}o.prototype=t.prototype,r(n,o=new o),e.prototype=n=o}n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}var o={},i=o.ELEMENT_NODE=1,a=o.ATTRIBUTE_NODE=2,s=o.TEXT_NODE=3,c=o.CDATA_SECTION_NODE=4,l=o.ENTITY_REFERENCE_NODE=5,u=o.ENTITY_NODE=6,p=o.PROCESSING_INSTRUCTION_NODE=7,d=o.COMMENT_NODE=8,h=o.DOCUMENT_NODE=9,f=o.DOCUMENT_TYPE_NODE=10,m=o.DOCUMENT_FRAGMENT_NODE=11,g=o.NOTATION_NODE=12,y={},v={},b=(y.INDEX_SIZE_ERR=(v[1]="Index size error",1),y.DOMSTRING_SIZE_ERR=(v[2]="DOMString size error",2),y.HIERARCHY_REQUEST_ERR=(v[3]="Hierarchy request error",3)),w=(y.WRONG_DOCUMENT_ERR=(v[4]="Wrong document",4),y.INVALID_CHARACTER_ERR=(v[5]="Invalid character",5),y.NO_DATA_ALLOWED_ERR=(v[6]="No data allowed",6),y.NO_MODIFICATION_ALLOWED_ERR=(v[7]="No modification allowed",7),y.NOT_FOUND_ERR=(v[8]="Not found",8)),S=(y.NOT_SUPPORTED_ERR=(v[9]="Not supported",9),y.INUSE_ATTRIBUTE_ERR=(v[10]="Attribute in use",10));y.INVALID_STATE_ERR=(v[11]="Invalid state",11),y.SYNTAX_ERR=(v[12]="Syntax error",12),y.INVALID_MODIFICATION_ERR=(v[13]="Invalid modification",13),y.NAMESPACE_ERR=(v[14]="Invalid namespace",14),y.INVALID_ACCESS_ERR=(v[15]="Invalid access",15);function E(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,v[e]),this.message=v[e],Error.captureStackTrace&&Error.captureStackTrace(this,E);return r.code=e,t&&(this.message=this.message+": "+t),r}function P(){}function T(e,t){this._node=e,this._refresh=t,_(this)}function _(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);te(e,"length",n.length),r(n,e),e._inc=t}}function D(){}function C(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function x(e,t,r,n){if(n?t[C(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var o=e.ownerDocument;o&&(n&&F(o,e,n),function(e,t,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&(t._nsMap[r.prefix?r.localName:""]=r.value)}(o,e,r))}}function I(e,t,r){var n=C(t,r);if(!(n>=0))throw E(w,new Error(e.tagName+"@"+r));for(var o=t.length-1;n<o;)t[n]=t[++n];if(t.length=o,e){var i=e.ownerDocument;i&&(F(i,e,r),r.ownerElement=null)}}function j(e){if(this._features={},e)for(var t in e)this._features=e[t]}function N(){}function A(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function k(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(k(e,t))return!0}while(e=e.nextSibling)}function R(){}function F(e,t,r,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&delete t._nsMap[r.prefix?r.localName:""]}function O(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var o=t.firstChild,i=0;o;)n[i++]=o,o=o.nextSibling;n.length=i}}}function L(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,O(e.ownerDocument,e),t}function q(e,t,r){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===m){var o=t.firstChild;if(null==o)return t;var i=t.lastChild}else o=i=t;var a=r?r.previousSibling:e.lastChild;o.previousSibling=a,i.nextSibling=r,a?a.nextSibling=o:e.firstChild=o,null==r?e.lastChild=i:r.previousSibling=i;do{o.parentNode=e}while(o!==i&&(o=o.nextSibling));return O(e.ownerDocument||e,e),t.nodeType==m&&(t.firstChild=t.lastChild=null),t}function M(){this._nsMap={}}function B(){}function V(){}function $(){}function H(){}function U(){}function G(){}function z(){}function W(){}function X(){}function Q(){}function K(){}function J(){}function Y(e,t){var r=[],n=9==this.nodeType&&this.documentElement||this,o=n.prefix,i=n.namespaceURI;if(i&&null==o&&null==(o=n.lookupPrefix(i)))var a=[{namespace:i,prefix:null}];return ee(this,r,e,t,a),r.join("")}function Z(e,t,r){var n=e.prefix||"",o=e.namespaceURI;if(!n&&!o)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===o||"http://www.w3.org/2000/xmlns/"==o)return!1;for(var i=r.length;i--;){var a=r[i];if(a.prefix==n)return a.namespace!=o}return!0}function ee(e,t,r,n,o){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case i:o||(o=[]);o.length;var u=e.attributes,g=u.length,y=e.firstChild,v=e.tagName;r="http://www.w3.org/1999/xhtml"===e.namespaceURI||r,t.push("<",v);for(var b=0;b<g;b++){"xmlns"==(w=u.item(b)).prefix?o.push({prefix:w.localName,namespace:w.value}):"xmlns"==w.nodeName&&o.push({prefix:"",namespace:w.value})}for(b=0;b<g;b++){var w;if(Z(w=u.item(b),0,o)){var S=w.prefix||"",E=w.namespaceURI,P=S?" xmlns:"+S:" xmlns";t.push(P,'="',E,'"'),o.push({prefix:S,namespace:E})}ee(w,t,r,n,o)}if(Z(e,0,o)){S=e.prefix||"",E=e.namespaceURI,P=S?" xmlns:"+S:" xmlns";t.push(P,'="',E,'"'),o.push({prefix:S,namespace:E})}if(y||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(v)){if(t.push(">"),r&&/^script$/i.test(v))for(;y;)y.data?t.push(y.data):ee(y,t,r,n,o),y=y.nextSibling;else for(;y;)ee(y,t,r,n,o),y=y.nextSibling;t.push("</",v,">")}else t.push("/>");return;case h:case m:for(y=e.firstChild;y;)ee(y,t,r,n,o),y=y.nextSibling;return;case a:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,A),'"');case s:return t.push(e.data.replace(/[<&]/g,A));case c:return t.push("<![CDATA[",e.data,"]]>");case d:return t.push("\x3c!--",e.data,"--\x3e");case f:var T=e.publicId,_=e.systemId;if(t.push("<!DOCTYPE ",e.name),T)t.push(' PUBLIC "',T),_&&"."!=_&&t.push('" "',_),t.push('">');else if(_&&"."!=_)t.push(' SYSTEM "',_,'">');else{var D=e.internalSubset;D&&t.push(" [",D,"]"),t.push(">")}return;case p:return t.push("<?",e.target," ",e.data,"?>");case l:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,r){e[t]=r}E.prototype=Error.prototype,r(y,E),P.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)ee(this[n],r,e,t);return r.join("")}},T.prototype.item=function(e){return _(this),this[e]},n(T,P),D.prototype={length:0,item:P.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new E(S);var r=this.getNamedItem(e.nodeName);return x(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t,r=e.ownerElement;if(r&&r!=this._ownerElement)throw new E(S);return t=this.getNamedItemNS(e.namespaceURI,e.localName),x(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return I(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return I(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},j.prototype={hasFeature:function(e,t){var r=this._features[e.toLowerCase()];return!(!r||t&&!(t in r))},createDocument:function(e,t,r){var n=new R;if(n.implementation=this,n.childNodes=new P,n.doctype=r,r&&n.appendChild(r),t){var o=n.createElementNS(e,t);n.appendChild(o)}return n},createDocumentType:function(e,t,r){var n=new G;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=r,n}},N.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return q(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return L(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,r,n){var o=new r.constructor;for(var s in r){var c=r[s];"object"!=typeof c&&c!=o[s]&&(o[s]=c)}r.childNodes&&(o.childNodes=new P);switch(o.ownerDocument=t,o.nodeType){case i:var l=r.attributes,u=o.attributes=new D,p=l.length;u._ownerElement=o;for(var d=0;d<p;d++)o.setAttributeNode(e(t,l.item(d),!0));break;case a:n=!0}if(n)for(var h=r.firstChild;h;)o.appendChild(e(t,h,n)),h=h.nextSibling;return o}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==s&&e.nodeType==s?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(r[n]==e)return n;t=t.nodeType==a?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&e in r)return r[e];t=t.nodeType==a?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},r(o,N),r(o,N.prototype),R.prototype={nodeName:"#document",nodeType:h,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==m){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return null==this.documentElement&&e.nodeType==i&&(this.documentElement=e),q(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),L(this,e)},importNode:function(e,t){return function e(t,r,n){var o;switch(r.nodeType){case i:(o=r.cloneNode(!1)).ownerDocument=t;case m:break;case a:n=!0}o||(o=r.cloneNode(!1));if(o.ownerDocument=t,o.parentNode=null,n)for(var s=r.firstChild;s;)o.appendChild(e(t,s,n)),s=s.nextSibling;return o}(this,e,t)},getElementById:function(e){var t=null;return k(this.documentElement,(function(r){if(r.nodeType==i&&r.getAttribute("id")==e)return t=r,!0})),t},getElementsByClassName:function(e){const t=new RegExp(`(^|\\s)${e}(\\s|$)`);return new T(this,e=>{var r=[];return k(e.documentElement,n=>{n!==e&&n.nodeType==i&&t.test(n.getAttribute("class"))&&r.push(n)}),r})},createElement:function(e){var t=new M;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new P,(t.attributes=new D)._ownerElement=t,t},createDocumentFragment:function(){var e=new Q;return e.ownerDocument=this,e.childNodes=new P,e},createTextNode:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new U;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new K;return r.ownerDocument=this,r.tagName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new B;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new X;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new M,n=t.split(":"),o=r.attributes=new D;return r.childNodes=new P,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,o._ownerElement=r,r},createAttributeNS:function(e,t){var r=new B,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},n(R,N),M.prototype={nodeType:i,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===m?this.insertBefore(e,null):function(e,t){var r=t.parentNode;if(r){var n=e.lastChild;r.removeChild(t);n=e.lastChild}return n=e.lastChild,t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,O(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new T(this,(function(t){var r=[];return k(t,(function(n){n===t||n.nodeType!=i||"*"!==e&&n.tagName!=e||r.push(n)})),r}))},getElementsByTagNameNS:function(e,t){return new T(this,(function(r){var n=[];return k(r,(function(o){o===r||o.nodeType!==i||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||n.push(o)})),n}))}},R.prototype.getElementsByTagName=M.prototype.getElementsByTagName,R.prototype.getElementsByTagNameNS=M.prototype.getElementsByTagNameNS,n(M,N),B.prototype.nodeType=a,n(B,N),V.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(v[b])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},n(V,N),$.prototype={nodeName:"#text",nodeType:s,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},n($,V),H.prototype={nodeName:"#comment",nodeType:d},n(H,V),U.prototype={nodeName:"#cdata-section",nodeType:c},n(U,V),G.prototype.nodeType=f,n(G,N),z.prototype.nodeType=g,n(z,N),W.prototype.nodeType=u,n(W,N),X.prototype.nodeType=l,n(X,N),Q.prototype.nodeName="#document-fragment",Q.prototype.nodeType=m,n(Q,N),K.prototype.nodeType=p,n(K,N),J.prototype.serializeToString=function(e,t,r){return Y.call(e,t,r)},N.prototype.toString=Y;try{if(Object.defineProperty){Object.defineProperty(T.prototype,"length",{get:function(){return _(this),this.$$length}}),Object.defineProperty(N.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case i:case m:var r=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case i:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,r){e["$$"+t]=r}}}catch(e){}t.Node=N,t.DOMImplementation=j,t.XMLSerializer=J},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortFileFolderNodes=t.ExternalStreamingJobFileNode=t.FileNode=t.FolderNode=void 0;const n=r(2),o=r(0),i=r(3),a=r(32),s=r(1),c=r(15);class l extends a.BaseProjectTreeItem{constructor(e,t){super(d(e,t.root),t),this.fileChildren={},this.fileSystemUri=e}get children(){return Object.values(this.fileChildren).sort(p)}get treeItem(){const e=new n.TreeItem(this.fileSystemUri,n.TreeItemCollapsibleState.Collapsed);return e.contextValue=s.DatabaseProjectItemType.folder,e.iconPath=c.IconPathHelper.folder,e}get project(){return this.parent.project}}t.FolderNode=l;class u extends a.BaseProjectTreeItem{constructor(e,t){super(d(e,t.root,!0),t),this.fileSystemUri=e}get children(){return[]}get treeItem(){const e=new n.TreeItem(this.fileSystemUri,n.TreeItemCollapsibleState.None);return e.command={title:"Open file",command:"vscode.open",arguments:[this.fileSystemUri]},e.contextValue=s.DatabaseProjectItemType.file,e}}t.FileNode=u;function p(e,t){return e instanceof l&&!(t instanceof l)?-1:!(e instanceof l)&&t instanceof l?1:e.projectUri.fsPath.localeCompare(t.projectUri.fsPath)}function d(e,t,r){const a=t.project.projectFolderPath;let s="";if(e.fsPath.startsWith(a))s=e.fsPath.substring(a.length);else if(r){const t=i.getPlatformSafeFileEntryPath(e.fsPath).split("/");s=t[t.length-1]}return n.Uri.file(o.join(t.projectUri.fsPath,s))}t.ExternalStreamingJobFileNode=class extends u{get treeItem(){const e=super.treeItem;return e.contextValue=s.DatabaseProjectItemType.externalStreamingJob,e}},t.sortFileFolderNodes=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectRootTreeItem=void 0;const n=r(2),o=r(0),i=r(297),a=r(32),s=r(111),c=r(3),l=r(113),u=r(1),p=r(15),d=r(42);class h extends a.BaseProjectTreeItem{constructor(e){super(n.Uri.parse(o.basename(e.projectFilePath,u.sqlprojExtension)),void 0),this.fileChildren={},this.project=e,this.fileSystemUri=n.Uri.file(e.projectFilePath),this.dataSourceNode=new i.DataSourcesTreeItem(this),this.databaseReferencesNode=new l.DatabaseReferencesTreeItem(this),this.construct()}get children(){const e=[];return e.push(this.databaseReferencesNode),e.concat(Object.values(this.fileChildren).sort(s.sortFileFolderNodes))}get treeItem(){const e=new n.TreeItem(this.fileSystemUri,n.TreeItemCollapsibleState.Expanded);return e.contextValue=u.DatabaseProjectItemType.project,e.iconPath=p.IconPathHelper.databaseProject,e.label=o.basename(this.projectUri.fsPath,u.sqlprojExtension),e}construct(){let e=this.project.files.concat(this.project.preDeployScripts).concat(this.project.postDeployScripts).concat(this.project.noneDeployScripts);for(const t of e){if(t.type!==d.EntryType.File&&t.relativePath.startsWith(u.RelativeOuterPath))continue;const e=this.getEntryParentNode(t);if(Object.keys(e.fileChildren).includes(o.basename(t.fsUri.path)))continue;let r;switch(t.type){case d.EntryType.File:r=t.sqlObjectType===u.ExternalStreamingJob?new s.ExternalStreamingJobFileNode(t.fsUri,e):new s.FileNode(t.fsUri,e);break;case d.EntryType.Folder:r=new s.FolderNode(t.fsUri,e);break;default:throw new Error(`Unknown EntryType: '${t.type}'`)}e.fileChildren[o.basename(t.fsUri.path)]=r}}getEntryParentNode(e){const t=c.trimChars(c.trimUri(n.Uri.file(this.project.projectFilePath),e.fsUri),"/").split("/").slice(0,-1);if(0===t.length)return this;if(t[0]===u.RelativeOuterPath)return this;let r=this;for(const e of t){if(void 0===r.fileChildren[e]){const t=r instanceof h?o.dirname(r.fileSystemUri.fsPath):r.fileSystemUri.fsPath;r.fileChildren[e]=new s.FolderNode(n.Uri.file(o.join(t,e)),r)}if(r.fileChildren[e]instanceof s.FileNode)return r;r=r.fileChildren[e]}return r}}t.ProjectRootTreeItem=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatabaseReferenceTreeItem=t.DatabaseReferencesTreeItem=void 0;const n=r(2),o=r(0),i=r(1),a=r(32),s=r(15);class c extends a.BaseProjectTreeItem{constructor(e){super(n.Uri.file(o.join(e.projectUri.fsPath,i.databaseReferencesNodeName)),e),this.references=[],this.construct()}construct(){for(const e of this.parent.project.databaseReferences)this.references.push(new l(e,this))}get children(){return this.references}get treeItem(){const e=new n.TreeItem(this.projectUri,n.TreeItemCollapsibleState.Collapsed);return e.contextValue=i.DatabaseProjectItemType.referencesRoot,e.iconPath=s.IconPathHelper.referenceGroup,e}}t.DatabaseReferencesTreeItem=c;class l extends a.BaseProjectTreeItem{constructor(e,t){super(n.Uri.file(o.join(t.projectUri.fsPath,e.databaseName)),t),this.reference=e}get children(){return[]}get treeItem(){const e=new n.TreeItem(this.projectUri,n.TreeItemCollapsibleState.None);return e.label=this.reference.databaseName,e.contextValue=i.DatabaseProjectItemType.reference,e.iconPath=s.IconPathHelper.referenceDatabase,e}}t.DatabaseReferenceTreeItem=l},function(e,t,r){const n=r(24);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:r(44).SEMVER_SPEC_VERSION,SemVer:r(8),compareIdentifiers:r(67).compareIdentifiers,rcompareIdentifiers:r(67).rcompareIdentifiers,parse:r(25),valid:r(298),clean:r(299),inc:r(300),diff:r(301),major:r(302),minor:r(303),patch:r(304),prerelease:r(305),compare:r(13),rcompare:r(306),compareLoose:r(307),compareBuild:r(69),sort:r(308),rsort:r(309),gt:r(47),lt:r(70),eq:r(68),neq:r(115),gte:r(71),lte:r(72),cmp:r(116),coerce:r(310),Comparator:r(48),Range:r(14),satisfies:r(49),toComparators:r(314),maxSatisfying:r(315),minSatisfying:r(316),minVersion:r(317),validRange:r(318),outside:r(73),gtr:r(319),ltr:r(320),intersects:r(321),simplifyRange:r(322),subset:r(323)}},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>0!==n(e,t,r)},function(e,t,r){const n=r(68),o=r(115),i=r(47),a=r(71),s=r(70),c=r(72);e.exports=(e,t,r,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,l);case"!=":return o(e,r,l);case">":return i(e,r,l);case">=":return a(e,r,l);case"<":return s(e,r,l);case"<=":return c(e,r,l);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.load=t.readPublishProfile=void 0;const n=r(109),o=r(1),i=r(3),a=r(2),s=r(4),c=r(57);async function l(e,t){const r=await s.promises.readFile(e.fsPath),a=(new n.DOMParser).parseFromString(r.toString());let l="",u=a.documentElement.getElementsByTagName(o.targetDatabaseName).length;u>0&&(l=a.documentElement.getElementsByTagName(o.targetDatabaseName)[u-1].textContent);const p=await async function(e){let t="",r="",n="";if(e.documentElement.getElementsByTagName(o.targetConnectionString).length>0){const a=e.documentElement.getElementsByTagName(o.TargetConnectionString)[0].textContent,s=new c.SqlConnectionDataSource("",a);let l="";const u=s.getConnectionProfile();try{const e=i.getAzdataApi();if(s.integratedSecurity){if(e){const e=await i.getAzdataApi().connection.connect(u,!1,!1);r=e.connectionId}n=s.server,l=o.defaultUser}else if(e){const e=await i.getAzdataApi().connection.openConnectionDialog(void 0,u);r=e.connectionId,n=e.options.server,l=e.options.user}t=`${n} (${l})`}catch(e){throw new Error(o.unableToCreatePublishConnection(i.getErrorMessage(e)))}}return{connectionId:r,connection:t,server:n}}(a),d=await t.getOptionsFromProfile(e.fsPath),h=i.readSqlCmdVariables(a,!0);return{databaseName:l,serverName:p.server,connectionId:p.connectionId,connection:p.connection,sqlCmdVariables:h,options:d.deploymentOptions}}t.readPublishProfile=async function(e){try{const t=await i.getDacFxService();return await l(e,t)}catch(e){throw a.window.showErrorMessage(o.profileReadError(e)),e}},t.load=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promptDacpacLocation=t.getSystemDatabase=t.getSystemDbOptions=t.AddDatabaseReferenceDialog=t.ReferenceType=void 0;const n=r(2),o=r(0),i=r(1),a=r(3),s=r(58),c=r(15),l=r(66),u=r(27),p=r(42);var d;!function(e){e[e.project=0]="project",e[e.systemDb=1]="systemDb",e[e.dacpac=2]="dacpac"}(d=t.ReferenceType||(t.ReferenceType={}));function h(e){const t=e.getProjectTargetVersion().toLowerCase();return t.includes("azure")||t.includes("dw")?[i.master]:[i.master,i.msdb]}function f(e){return e===i.master?p.SystemDatabase.master:p.SystemDatabase.msdb}async function m(){return await n.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,defaultUri:n.workspace.workspaceFolders?n.workspace.workspaceFolders[0].uri:void 0,openLabel:i.selectString,title:i.selectDacpac,filters:{[i.dacpacFiles]:["dacpac"]}})}t.AddDatabaseReferenceDialog=class{constructor(e){this.project=e,this.toDispose=[],this.initDialogComplete=new l.Deferred,this.dialog=a.getAzdataApi().window.createModelViewDialog(i.addDatabaseReferenceDialogName,"addDatabaseReferencesDialog"),this.addDatabaseReferenceTab=a.getAzdataApi().window.createTab(i.addDatabaseReferenceDialogName),this.dialog.registerCloseValidator(async()=>this.validate())}validate(){if(this.currentReferenceType===d.dacpac){if(o.parse(this.project.projectFilePath).root!==o.parse(this.dacpacTextbox.value).root)return this.dialog.message={text:i.dacpacNotOnSameDrive(this.project.projectFilePath),level:a.getAzdataApi().window.MessageLevel.Error},!1}return!0}async openDialog(){this.initializeDialog(),this.dialog.okButton.label=i.addDatabaseReferenceOkButtonText,this.dialog.okButton.enabled=!1,this.toDispose.push(this.dialog.okButton.onClick(async()=>await this.addReferenceClick())),this.dialog.cancelButton.label=i.cancelButtonText,a.getAzdataApi().window.openDialog(this.dialog),await this.initDialogComplete.promise}dispose(){this.toDispose.forEach(e=>e.dispose())}initializeDialog(){this.initializeTab(),this.dialog.content=[this.addDatabaseReferenceTab]}initializeTab(){this.addDatabaseReferenceTab.registerContent(async e=>{var t,r;this.view=e,this.projectFormComponent=await this.createProjectDropdown();const n=this.createRadioButtons();this.systemDatabaseFormComponent=this.createSystemDatabaseDropdown(),this.dacpacFormComponent=this.createDacpacTextbox();const o=this.createLocationDropdown(),a=this.createVariableSection();this.suppressMissingDependenciesErrorsCheckbox=e.modelBuilder.checkBox().withProps({label:i.suppressMissingDependenciesErrors}).component();const s=this.createExampleUsage();this.formBuilder=e.modelBuilder.formContainer().withFormItems([{title:"",components:[n,this.currentReferenceType===d.project?this.projectFormComponent:this.systemDatabaseFormComponent,o,a,s,{component:this.suppressMissingDependenciesErrorsCheckbox}]}],{horizontal:!1}).withLayout({width:"100%"});let c=this.formBuilder.component();await e.initializeModel(c),this.updateEnabledInputBoxes(),this.currentReferenceType===d.project?await(null===(t=this.projectRadioButton)||void 0===t?void 0:t.focus()):await(null===(r=this.systemDatabaseRadioButton)||void 0===r?void 0:r.focus()),this.initDialogComplete.resolve()})}async addReferenceClick(){var e,t,r,o,i,s,c,l,p,h,m,g,y,v,b;let w;w=this.currentReferenceType===d.project?{projectName:null===(e=this.projectDropdown)||void 0===e?void 0:e.value,projectGuid:"",projectRelativePath:void 0,databaseName:null===(t=this.databaseNameTextbox)||void 0===t?void 0:t.value,databaseVariable:null===(r=this.databaseVariableTextbox)||void 0===r?void 0:r.value,serverName:null===(o=this.serverNameTextbox)||void 0===o?void 0:o.value,serverVariable:null===(i=this.serverVariableTextbox)||void 0===i?void 0:i.value,suppressMissingDependenciesErrors:null===(s=this.suppressMissingDependenciesErrorsCheckbox)||void 0===s?void 0:s.checked}:this.currentReferenceType===d.systemDb?{databaseName:null===(c=this.databaseNameTextbox)||void 0===c?void 0:c.value,systemDb:f(null===(l=this.systemDatabaseDropdown)||void 0===l?void 0:l.value),suppressMissingDependenciesErrors:null===(p=this.suppressMissingDependenciesErrorsCheckbox)||void 0===p?void 0:p.checked}:{databaseName:null===(h=this.databaseNameTextbox)||void 0===h?void 0:h.value,dacpacFileLocation:n.Uri.file(null===(m=this.dacpacTextbox)||void 0===m?void 0:m.value),databaseVariable:a.removeSqlCmdVariableFormatting(null===(g=this.databaseVariableTextbox)||void 0===g?void 0:g.value),serverName:null===(y=this.serverNameTextbox)||void 0===y?void 0:y.value,serverVariable:a.removeSqlCmdVariableFormatting(null===(v=this.serverVariableTextbox)||void 0===v?void 0:v.value),suppressMissingDependenciesErrors:null===(b=this.suppressMissingDependenciesErrorsCheckbox)||void 0===b?void 0:b.checked},u.TelemetryReporter.createActionEvent(u.TelemetryViews.ProjectTree,u.TelemetryActions.addDatabaseReference).withAdditionalProperties({referenceType:this.currentReferenceType.toString()}).send(),await this.addReference(this.project,w),this.dispose()}createRadioButtons(){var e,t;this.projectRadioButton=this.view.modelBuilder.radioButton().withProps({name:"referenceType",label:i.projectLabel}).component(),this.projectRadioButton.onDidClick(()=>{this.projectRadioButtonClick()}),this.systemDatabaseRadioButton=this.view.modelBuilder.radioButton().withProps({name:"referenceType",label:i.systemDatabase}).component(),this.systemDatabaseRadioButton.onDidClick(()=>{this.systemDbRadioButtonClick()});const r=this.view.modelBuilder.radioButton().withProps({name:"referenceType",label:i.dacpacText}).component();return r.onDidClick(()=>{this.dacpacRadioButtonClick()}),(null===(t=null===(e=this.projectDropdown)||void 0===e?void 0:e.values)||void 0===t?void 0:t.length)?(this.projectRadioButton.checked=!0,this.currentReferenceType=d.project):(this.systemDatabaseRadioButton.checked=!0,this.currentReferenceType=d.systemDb,this.projectRadioButton.enabled=!1),{component:this.view.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).withItems([this.projectRadioButton,this.systemDatabaseRadioButton,r]).withProps({ariaRole:"radiogroup"}).component(),title:i.referenceRadioButtonsGroupTitle}}projectRadioButtonClick(){this.formBuilder.removeFormItem(this.dacpacFormComponent),this.formBuilder.removeFormItem(this.systemDatabaseFormComponent),this.formBuilder.insertFormItem(this.projectFormComponent,2),this.locationDropdown.values=i.locationDropdownValues,this.currentReferenceType=d.project,this.updateEnabledInputBoxes(),this.tryEnableAddReferenceButton(),this.updateExampleUsage()}systemDbRadioButtonClick(){this.formBuilder.removeFormItem(this.dacpacFormComponent),this.formBuilder.removeFormItem(this.projectFormComponent),this.formBuilder.insertFormItem(this.systemDatabaseFormComponent,2),this.locationDropdown.values=i.systemDbLocationDropdownValues,this.locationDropdown.value=i.differentDbSameServer,this.currentReferenceType=d.systemDb,this.updateEnabledInputBoxes(),this.tryEnableAddReferenceButton(),this.updateExampleUsage()}dacpacRadioButtonClick(){this.formBuilder.removeFormItem(this.systemDatabaseFormComponent),this.formBuilder.removeFormItem(this.projectFormComponent),this.formBuilder.insertFormItem(this.dacpacFormComponent,2),this.locationDropdown.values=i.locationDropdownValues,this.currentReferenceType=d.dacpac,this.updateEnabledInputBoxes(),this.tryEnableAddReferenceButton(),this.updateExampleUsage()}async createProjectDropdown(){this.projectDropdown=this.view.modelBuilder.dropDown().withProps({ariaLabel:i.databaseProject}).component(),this.projectDropdown.onValueChanged(()=>{this.setDefaultDatabaseValues()});let e=await a.getSqlProjectsInWorkspace();return e=e.filter(e=>e.fsPath!==this.project.projectFilePath),this.projectDropdown.values=e.map(e=>o.parse(e.fsPath).name),{component:this.projectDropdown,title:i.databaseProject}}createSystemDatabaseDropdown(){return this.systemDatabaseDropdown=this.view.modelBuilder.dropDown().withProps({values:h(this.project),ariaLabel:i.databaseNameLabel}).component(),this.systemDatabaseDropdown.onValueChanged(()=>{this.setDefaultDatabaseValues()}),{component:this.systemDatabaseDropdown,title:i.databaseNameLabel}}createDacpacTextbox(){this.dacpacTextbox=this.view.modelBuilder.inputBox().withProps({ariaLabel:i.dacpacText,placeHolder:i.selectDacpac,width:"400px"}).component(),this.dacpacTextbox.onTextChanged(()=>{this.setDefaultDatabaseValues(),this.tryEnableAddReferenceButton(),this.updateExampleUsage()});const e=this.createLoadDacpacButton(),t=this.view.modelBuilder.flexContainer().withItems([this.dacpacTextbox],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component();return t.insertItem(e,1),{component:t,title:i.dacpacText}}createLoadDacpacButton(){const e=this.view.modelBuilder.button().withProps({ariaLabel:i.selectDacpac,iconPath:c.IconPathHelper.folder_blue,height:"18px",width:"18px"}).component();return e.onDidClick(async()=>{let e=await m();e&&0!==e.length&&(this.dacpacTextbox.value=e[0].fsPath)}),e}createLocationDropdown(){return this.locationDropdown=this.view.modelBuilder.dropDown().withProps({ariaLabel:i.location,values:this.currentReferenceType===d.systemDb?i.systemDbLocationDropdownValues:i.locationDropdownValues}).component(),this.locationDropdown.value=i.differentDbSameServer,this.locationDropdown.onValueChanged(()=>{this.updateEnabledInputBoxes(),this.tryEnableAddReferenceButton(),this.updateExampleUsage()}),{component:this.locationDropdown,title:i.location}}updateEnabledInputBoxes(){var e,t,r;const n=this.currentReferenceType===d.systemDb;(null===(e=this.locationDropdown)||void 0===e?void 0:e.value)===i.sameDatabase?(this.databaseNameTextbox.enabled=!1,this.databaseVariableTextbox.enabled=!1,this.serverNameTextbox.enabled=!1,this.serverVariableTextbox.enabled=!1,this.databaseNameTextbox.value="",this.databaseVariableTextbox.value="",this.serverNameTextbox.value="",this.serverVariableTextbox.value=""):(null===(t=this.locationDropdown)||void 0===t?void 0:t.value)===i.differentDbSameServer?(this.databaseNameTextbox.enabled=!0,this.databaseVariableTextbox.enabled=!n,this.serverNameTextbox.enabled=!1,this.serverVariableTextbox.enabled=!1,this.databaseVariableTextbox.value=n?"":this.databaseVariableTextbox.value,this.serverNameTextbox.value="",this.serverVariableTextbox.value="",this.setDefaultDatabaseValues()):(null===(r=this.locationDropdown)||void 0===r?void 0:r.value)===i.differentDbDifferentServer&&(this.databaseNameTextbox.enabled=!0,this.databaseVariableTextbox.enabled=!0,this.serverNameTextbox.enabled=!0,this.serverVariableTextbox.enabled=!0,this.setDefaultDatabaseValues(),this.serverNameTextbox.value=i.otherServer,this.serverVariableTextbox.value=i.otherSeverVariable)}setDefaultDatabaseValues(){var e,t,r;if(this.databaseNameTextbox.enabled)switch(this.currentReferenceType){case d.project:this.databaseNameTextbox.value=null===(e=this.projectDropdown)||void 0===e?void 0:e.value,this.databaseVariableTextbox.value=""+(null===(t=this.projectDropdown)||void 0===t?void 0:t.value);break;case d.systemDb:this.databaseNameTextbox.value=null===(r=this.systemDatabaseDropdown)||void 0===r?void 0:r.value;break;case d.dacpac:{const e=this.dacpacTextbox.value?o.parse(this.dacpacTextbox.value).name:"";this.databaseNameTextbox.value=e,this.databaseVariableTextbox.value=e?""+e:"";break}}}createVariableSection(){this.databaseNameTextbox=this.createInputBox(i.databaseName,!0,!0);const e=this.view.modelBuilder.flexContainer().withItems([this.createLabel(i.databaseName,!0),this.databaseNameTextbox],{flex:"0 0 auto"}).withLayout({flexFlow:"row",alignItems:"center"}).component();this.databaseVariableTextbox=this.createInputBox(i.databaseVariable,!1,!1);const t=this.view.modelBuilder.flexContainer().withItems([this.createLabel(i.databaseVariable),this.databaseVariableTextbox],{flex:"0 0 auto"}).withLayout({flexFlow:"row",alignItems:"center"}).component();this.serverNameTextbox=this.createInputBox(i.serverName,!1,!0);const r=this.view.modelBuilder.flexContainer().withItems([this.createLabel(i.serverName,!0),this.serverNameTextbox],{flex:"0 0 auto"}).withLayout({flexFlow:"row",alignItems:"center"}).component();this.serverVariableTextbox=this.createInputBox(i.serverVariable,!1,!0);const n=this.view.modelBuilder.flexContainer().withItems([this.createLabel(i.serverVariable,!0),this.serverVariableTextbox],{flex:"0 0 auto"}).withLayout({flexFlow:"row",alignItems:"center"}).component(),o=this.view.modelBuilder.flexContainer().withItems([e,t,r,n]).withLayout({flexFlow:"column"}).withProps({CSSStyles:{"margin-bottom":"25px"}}).component();return this.setDefaultDatabaseValues(),{component:o,title:""}}createLabel(e,t=!1){return this.view.modelBuilder.text().withProps({value:e,width:s.cssStyles.addDatabaseReferenceDialogLabelWidth,requiredIndicator:t}).component()}createInputBox(e,t,r){const n=this.view.modelBuilder.inputBox().withProps({ariaLabel:e,enabled:t,width:s.cssStyles.addDatabaseReferenceInputboxWidth,required:r}).component();return n.onTextChanged(()=>{this.tryEnableAddReferenceButton(),this.updateExampleUsage()}),n}createExampleUsage(){this.exampleUsage=this.view.modelBuilder.text().withProps({value:this.currentReferenceType===d.project?i.databaseNameRequiredVariableOptional:i.systemDatabaseReferenceRequired,CSSStyles:{"user-select":"text"}}).component();return{component:this.view.modelBuilder.flexContainer().withItems([this.exampleUsage],{CSSStyles:{width:"415px",height:"80px",padding:"0 10px",border:"1px solid #8a8886","font-style":"italic"}}).component(),title:i.exampleUsage}}updateExampleUsage(){var e,t,r,n,o,c,l,u,p,h;let f="",m=s.cssStyles.fontStyle.normal;switch(this.locationDropdown.value){case i.sameDatabase:f=i.sameDatabaseExampleUsage;break;case i.differentDbSameServer:if(null===(e=this.databaseNameTextbox)||void 0===e?void 0:e.value){const e=(null===(t=this.databaseVariableTextbox)||void 0===t?void 0:t.value)?a.formatSqlCmdVariable(null===(r=this.databaseVariableTextbox)||void 0===r?void 0:r.value):this.databaseNameTextbox.value;f=i.differentDbSameServerExampleUsage(e)}else f=this.currentReferenceType===d.systemDb?i.enterSystemDbName:i.databaseNameRequiredVariableOptional,m=s.cssStyles.fontStyle.italics;break;case i.differentDbDifferentServer:if((null===(n=this.databaseNameTextbox)||void 0===n?void 0:n.value)&&(null===(o=this.serverNameTextbox)||void 0===o?void 0:o.value)&&(null===(c=this.serverVariableTextbox)||void 0===c?void 0:c.value)){const e=a.formatSqlCmdVariable(this.serverVariableTextbox.value),t=(null===(l=this.databaseVariableTextbox)||void 0===l?void 0:l.value)?a.formatSqlCmdVariable(null===(u=this.databaseVariableTextbox)||void 0===u?void 0:u.value):this.databaseNameTextbox.value;f=i.differentDbDifferentServerExampleUsage(e,t)}else f=i.databaseNameServerNameVariableRequired,m=s.cssStyles.fontStyle.italics}if(!this.validSqlCmdVariables()){let e=a.isValidSqlCmdVariableName(null===(p=this.databaseVariableTextbox)||void 0===p?void 0:p.value)?this.serverVariableTextbox.value:this.databaseVariableTextbox.value;e=a.removeSqlCmdVariableFormatting(e),f=i.notValidVariableName(e)}this.exampleUsage.value=f,null===(h=this.exampleUsage)||void 0===h||h.updateCssStyles({"font-style":m})}validSqlCmdVariables(){var e,t,r,n,o,i;return!((null===(e=this.databaseVariableTextbox)||void 0===e?void 0:e.enabled)&&(null===(t=this.databaseVariableTextbox)||void 0===t?void 0:t.value)&&!a.isValidSqlCmdVariableName(null===(r=this.databaseVariableTextbox)||void 0===r?void 0:r.value)||(null===(n=this.serverVariableTextbox)||void 0===n?void 0:n.enabled)&&(null===(o=this.serverVariableTextbox)||void 0===o?void 0:o.value)&&!a.isValidSqlCmdVariableName(null===(i=this.serverVariableTextbox)||void 0===i?void 0:i.value))}tryEnableAddReferenceButton(){var e;switch(this.currentReferenceType){case d.project:this.dialog.okButton.enabled=this.projectRequiredFieldsFilled();break;case d.systemDb:this.dialog.okButton.enabled=!!(null===(e=this.databaseNameTextbox)||void 0===e?void 0:e.value);break;case d.dacpac:this.dialog.okButton.enabled=this.dacpacRequiredFieldsFilled()}}dacpacRequiredFieldsFilled(){var e,t,r,n;return!!(null===(e=this.dacpacTextbox)||void 0===e?void 0:e.value)&&this.validSqlCmdVariables()&&((null===(t=this.locationDropdown)||void 0===t?void 0:t.value)===i.sameDatabase||(null===(r=this.locationDropdown)||void 0===r?void 0:r.value)===i.differentDbSameServer&&this.differentDatabaseSameServerRequiredFieldsFilled()||(null===(n=this.locationDropdown)||void 0===n?void 0:n.value)===i.differentDbDifferentServer&&this.differentDatabaseDifferentServerRequiredFieldsFilled())}projectRequiredFieldsFilled(){var e,t,r,n;return!!(null===(e=this.projectDropdown)||void 0===e?void 0:e.value)&&((null===(t=this.locationDropdown)||void 0===t?void 0:t.value)===i.sameDatabase||(null===(r=this.locationDropdown)||void 0===r?void 0:r.value)===i.differentDbSameServer&&this.differentDatabaseSameServerRequiredFieldsFilled()||(null===(n=this.locationDropdown)||void 0===n?void 0:n.value)===i.differentDbDifferentServer&&this.differentDatabaseDifferentServerRequiredFieldsFilled())}differentDatabaseSameServerRequiredFieldsFilled(){var e;return!!(null===(e=this.databaseNameTextbox)||void 0===e?void 0:e.value)}differentDatabaseDifferentServerRequiredFieldsFilled(){var e,t,r;return!!(null===(e=this.databaseNameTextbox)||void 0===e?void 0:e.value)&&!!(null===(t=this.serverNameTextbox)||void 0===t?void 0:t.value)&&!!(null===(r=this.serverVariableTextbox)||void 0===r?void 0:r.value)}},t.getSystemDbOptions=h,t.getSystemDatabase=f,t.promptDacpacLocation=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapExtractTargetEnum=t.CreateProjectFromDatabaseDialog=void 0;const n=r(2),o=r(1),i=r(120),a=r(0),s=r(15),c=r(58),l=r(66),u=r(59),p=r(3);function d(e){if(!e)throw new Error(o.extractTargetRequired);switch(e){case o.file:return 1;case o.flat:return 2;case o.objectType:return 3;case o.schema:return 4;case o.schemaObjectType:return 5;default:throw new Error(o.invalidInput(e))}}t.CreateProjectFromDatabaseDialog=class{constructor(e){this.profile=e,this.toDispose=[],this.initDialogComplete=new l.Deferred,this.dialog=p.getAzdataApi().window.createModelViewDialog(o.createProjectFromDatabaseDialogName,"createProjectFromDatabaseDialog"),this.createProjectFromDatabaseTab=p.getAzdataApi().window.createTab(o.createProjectFromDatabaseDialogName),this.dialog.registerCloseValidator(async()=>this.validate())}async openDialog(){this.initializeDialog(),this.dialog.okButton.label=o.createProjectDialogOkButtonText,this.dialog.okButton.enabled=!1,this.toDispose.push(this.dialog.okButton.onClick(async()=>await this.handleCreateButtonClick())),this.dialog.cancelButton.label=o.cancelButtonText,p.getAzdataApi().window.openDialog(this.dialog),await this.initDialogComplete.promise,this.profile&&await this.updateConnectionComponents(u.getConnectionName(this.profile),this.profile.id,this.profile.databaseName),this.tryEnableCreateButton()}dispose(){this.toDispose.forEach(e=>e.dispose())}initializeDialog(){this.initializeCreateProjectFromDatabaseTab(),this.dialog.content=[this.createProjectFromDatabaseTab]}initializeCreateProjectFromDatabaseTab(){this.createProjectFromDatabaseTab.registerContent(async e=>{var t,r;const n=this.createConnectionRow(e),i=this.createDatabaseRow(e),a=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).component();a.addItems([n,i]);const s=this.createProjectNameRow(e),l=this.createProjectLocationRow(e),u=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).component();u.addItems([s,l]);const p=this.createFolderStructureRow(e),d=e.modelBuilder.flexContainer().withLayout({flexFlow:"column"}).component();d.addItems([p]),this.formBuilder=e.modelBuilder.formContainer().withFormItems([{title:o.sourceDatabase,components:[{component:a}]},{title:o.targetProject,components:[{component:u}]},{title:o.createProjectSettings,components:[{component:d}]}],{horizontal:!1,titleFontSize:c.cssStyles.titleFontSize}).withLayout({width:"100%",padding:"10px 10px 0 20px"});let h=this.formBuilder.component();await e.initializeModel(h),await(null===(t=this.selectConnectionButton)||void 0===t?void 0:t.focus()),null===(r=this.initDialogComplete)||void 0===r||r.resolve()})}createConnectionRow(e){const t=this.createSourceConnectionComponent(e),r=this.createSelectConnectionButton(e),n=e.modelBuilder.text().withProps({value:o.server,requiredIndicator:!0,width:c.cssStyles.createProjectFromDatabaseLabelWidth}).component(),i=e.modelBuilder.flexContainer().withItems([n,t],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px","margin-bottom":"-5px","margin-top":"-10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component();return i.addItem(r,{CSSStyles:{"margin-right":"0px","margin-bottom":"-5px","margin-top":"-10px"}}),i}createDatabaseRow(e){this.sourceDatabaseDropDown=e.modelBuilder.dropDown().withProps({ariaLabel:o.databaseNameLabel,required:!0,width:c.cssStyles.createProjectFromDatabaseTextboxWidth}).component(),this.sourceDatabaseDropDown.onValueChanged(()=>{this.setProjectName(),this.tryEnableCreateButton()});const t=e.modelBuilder.text().withProps({value:o.databaseNameLabel,requiredIndicator:!0,width:c.cssStyles.createProjectFromDatabaseLabelWidth}).component();return e.modelBuilder.flexContainer().withItems([t,this.sourceDatabaseDropDown],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px","margin-bottom":"-10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component()}setProjectName(){this.projectNameTextBox.value=i.defaultProjectNameFromDb(this.sourceDatabaseDropDown.value)}createSourceConnectionComponent(e){return this.sourceConnectionTextBox=e.modelBuilder.inputBox().withProps({value:"",placeHolder:o.selectConnection,width:c.cssStyles.createProjectFromDatabaseTextboxWidth,enabled:!1}).component(),this.sourceConnectionTextBox.onTextChanged(()=>{this.tryEnableCreateButton()}),this.sourceConnectionTextBox}createSelectConnectionButton(e){return this.selectConnectionButton=e.modelBuilder.button().withProps({ariaLabel:o.selectConnection,iconPath:s.IconPathHelper.selectConnection,height:"16px",width:"16px"}).component(),this.selectConnectionButton.onDidClick(async()=>{let e,t=await p.getAzdataApi().connection.openConnectionDialog();this.connectionId=t.connectionId,e=u.getConnectionName(t),await this.updateConnectionComponents(e,this.connectionId,t.options.database)}),this.selectConnectionButton}async updateConnectionComponents(e,t,r){if(this.sourceConnectionTextBox.value=e,this.sourceConnectionTextBox.updateProperty("title",e),t){let e;this.sourceDatabaseDropDown.loading=!0;try{e=(await p.getAzdataApi().connection.listDatabases(t)).filter(e=>!o.systemDbs.includes(e))}catch(t){e=[r],console.warn(t)}this.sourceDatabaseDropDown.values=e,this.sourceDatabaseDropDown.loading=!1,this.connectionId=t}r&&r!==o.master&&(this.sourceDatabaseDropDown.value=r),this.selectConnectionButton.iconPath=s.IconPathHelper.connect}createProjectNameRow(e){this.projectNameTextBox=e.modelBuilder.inputBox().withProps({ariaLabel:o.projectNamePlaceholderText,placeHolder:o.projectNamePlaceholderText,required:!0,width:c.cssStyles.createProjectFromDatabaseTextboxWidth}).component(),this.projectNameTextBox.onTextChanged(()=>{var e;this.projectNameTextBox.value=null===(e=this.projectNameTextBox.value)||void 0===e?void 0:e.trim(),this.projectNameTextBox.updateProperty("title",this.projectNameTextBox.value),this.tryEnableCreateButton()});const t=e.modelBuilder.text().withProps({value:o.projectNameLabel,requiredIndicator:!0,width:c.cssStyles.createProjectFromDatabaseLabelWidth}).component();return e.modelBuilder.flexContainer().withItems([t,this.projectNameTextBox],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px","margin-bottom":"-5px","margin-top":"-10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component()}createProjectLocationRow(e){const t=this.createBrowseFolderButton(e);this.projectLocationTextBox=e.modelBuilder.inputBox().withProps({value:"",ariaLabel:o.location,placeHolder:o.projectLocationPlaceholderText,width:c.cssStyles.createProjectFromDatabaseTextboxWidth}).component(),this.projectLocationTextBox.onTextChanged(()=>{this.projectLocationTextBox.updateProperty("title",this.projectLocationTextBox.value),this.tryEnableCreateButton()});const r=e.modelBuilder.text().withProps({value:o.location,requiredIndicator:!0,width:c.cssStyles.createProjectFromDatabaseLabelWidth}).component(),n=e.modelBuilder.flexContainer().withItems([r,this.projectLocationTextBox],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px","margin-bottom":"-10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component();return n.addItem(t,{CSSStyles:{"margin-right":"0px","margin-bottom":"-10px"}}),n}createBrowseFolderButton(e){const t=e.modelBuilder.button().withProps({ariaLabel:o.browseButtonText,iconPath:s.IconPathHelper.folder_blue,height:"18px",width:"18px"}).component();return t.onDidClick(async()=>{let e=await n.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,openLabel:o.selectString,defaultUri:i.defaultProjectSaveLocation()});e&&0!==e.length&&(this.projectLocationTextBox.value=e[0].fsPath,this.projectLocationTextBox.updateProperty("title",e[0].fsPath))}),t}createFolderStructureRow(e){this.folderStructureDropDown=e.modelBuilder.dropDown().withProps({values:[o.file,o.flat,o.objectType,o.schema,o.schemaObjectType],value:o.schemaObjectType,ariaLabel:o.folderStructureLabel,required:!0,width:c.cssStyles.createProjectFromDatabaseTextboxWidth}).component(),this.folderStructureDropDown.onValueChanged(()=>{this.tryEnableCreateButton()});const t=e.modelBuilder.text().withProps({value:o.folderStructureLabel,requiredIndicator:!0,width:c.cssStyles.createProjectFromDatabaseLabelWidth}).component();return e.modelBuilder.flexContainer().withItems([t,this.folderStructureDropDown],{flex:"0 0 auto",CSSStyles:{"margin-right":"10px","margin-top":"-10px"}}).withLayout({flexFlow:"row",alignItems:"center"}).component()}tryEnableCreateButton(){this.sourceConnectionTextBox.value&&this.sourceDatabaseDropDown.value&&this.projectNameTextBox.value&&this.projectLocationTextBox.value?this.dialog.okButton.enabled=!0:this.dialog.okButton.enabled=!1}async handleCreateButtonClick(){const e=p.getAzdataApi(),t={connectionUri:await e.connection.getUriForConnection(this.connectionId),database:this.sourceDatabaseDropDown.value,projName:this.projectNameTextBox.value,filePath:this.projectLocationTextBox.value,version:"1.0.0.0",extractTarget:d(this.folderStructureDropDown.value)};e.window.closeDialog(this.dialog),await this.createProjectFromDatabaseCallback(t),this.dispose()}async validate(){try{if(!await p.exists(this.projectLocationTextBox.value))return this.showErrorMessage(o.ProjectParentDirectoryNotExistError(this.projectLocationTextBox.value)),!1;return await p.exists(a.join(this.projectLocationTextBox.value,this.projectNameTextBox.value))?(this.showErrorMessage(o.ProjectDirectoryAlreadyExistError(this.projectNameTextBox.value,this.projectLocationTextBox.value)),!1):!1!==await p.getDataWorkspaceExtensionApi().validateWorkspace()}catch(e){return this.showErrorMessage((null==e?void 0:e.message)?e.message:e),!1}}showErrorMessage(e){this.dialog.message={text:e,level:p.getAzdataApi().window.MessageLevel.Error}}},t.mapExtractTargetEnum=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProjectNameFromDb=t.defaultProjectNameNewProj=t.defaultProjectSaveLocation=void 0;const n=r(2),o=r(4),i=r(0),a=r(9),s=r(1),c=r(3);function l(){return c.getDataWorkspaceExtensionApi().defaultProjectSaveLocation}function u(e,t){for(var r;t<Number.MAX_SAFE_INTEGER;){const s=e+t,c=null!==(r=l())&&void 0!==r?r:n.Uri.file(a.homedir()),u=i.join(c.fsPath,s);if(!o.existsSync(u))return s;t++}return s.defaultProjectNameStarter+t}t.defaultProjectSaveLocation=l,t.defaultProjectNameNewProj=function(){return u(s.defaultProjectNameStarter,1)},t.defaultProjectNameFromDb=function(e){var t;if(!e)return"";const r=s.defaultProjectNameStarter+e,c=null!==(t=l())&&void 0!==t?t:n.Uri.file(a.homedir()),p=i.join(c.fsPath,r);return o.existsSync(p)?u(r,2):r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchPublishTargetOption=t.getPublishDatabaseSettings=void 0;const n=r(2),o=r(1),i=r(117),a=r(93),s=r(3);t.getPublishDatabaseSettings=async function(e,t=!0){var r;const c=n.window.createQuickPick();c.items=[{label:o.dontUseProfile},{label:o.browseForProfileWithIcon}],c.ignoreFocusOut=!0,c.title=o.selectProfileToUse;const l=new Promise((t,r)=>{c.onDidHide(()=>{r()}),c.onDidChangeSelection(async r=>{if(r[0].label===o.browseForProfileWithIcon){const r=await a.promptForPublishProfile(e.projectFolderPath);if(!r)return c.selectedItems=[],void(c.activeItems=[]);let n=r[0];try{c.busy=!0,c.enabled=!1;const e=await i.readPublishProfile(n);t(e)}catch(e){c.selectedItems=[],c.activeItems=[],c.busy=!1,c.enabled=!0}}else t(void 0)})});c.show();let u=void 0;try{u=await l}catch(e){return}c.hide();let p,d=void 0,h=void 0;if(t){const e=await s.getVscodeMssqlApi();for(;!h;){if(d=await e.promptForConnection(!0),!d)return;try{p=await e.connect(d),h=await e.listDatabases(p)}catch(e){}}}else h=[];const f=h.filter(e=>!o.systemDbs.includes(e)).map(e=>({label:e}));f.unshift({label:"$(add) "+o.createNew,isCreateNew:!0});const m=h.findIndex(t=>t===e.projectFileName);-1===m?f.unshift({label:e.projectFileName,description:o.newText}):(f.splice(m,1),f.unshift({label:e.projectFileName}));let g=void 0;for(;!g;){const e=await n.window.showQuickPick(f,{title:o.selectDatabase,ignoreFocusOut:!0});if(!e)return;g=e.label,e.isCreateNew&&(g=null!==(r=await n.window.showInputBox({title:o.enterNewDatabaseName,ignoreFocusOut:!0,validateInput:e=>e?void 0:o.nameMustNotBeEmpty}))&&void 0!==r?r:"")}let y=Object.assign({},e.sqlCmdVariables,null==u?void 0:u.sqlCmdVariables);if(Object.keys(y).length>0)for(;;){const t=Object.keys(y).map(e=>({label:e,description:y[e],key:e}));t.push({label:"$(refresh) "+o.resetAllVars,isResetAllVars:!0}),t.unshift({label:"$(check) "+o.done,isDone:!0});const r=await n.window.showQuickPick(t,{title:o.chooseSqlcmdVarsToModify,ignoreFocusOut:!0});if(!r)break;if(r.key){const e=await n.window.showInputBox({title:o.enterNewValueForVar(r.key),value:y[r.key],ignoreFocusOut:!0});e&&(y[r.key]=e)}else if(r.isResetAllVars)y=Object.assign({},e.sqlCmdVariables,null==u?void 0:u.sqlCmdVariables);else if(r.isDone)break}return{databaseName:g,serverName:(null==d?void 0:d.server)||"",connectionUri:p||"",sqlCmdVariables:y,deploymentOptions:await s.getDefaultPublishDeploymentOptions(e),profileUsed:!!u}},t.launchPublishTargetOption=async function(){const e=await n.window.showQuickPick([o.publishToExistingServer,o.publishToDockerContainer],{title:o.selectPublishOption,ignoreFocusOut:!0});if(e)return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppSettingType=void 0,function(e){e[e.None=0]="None",e[e.AzureFunction=1]="AzureFunction"}(t.AppSettingType||(t.AppSettingType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunctionProject=t.getAFProjectContainingFile=t.setLocalAppSetting=t.getLocalSettingsJson=void 0;const n=r(35),o=r(0),i=r(2),a=r(3),s=r(1),c=r(336);async function l(e){if(await n.pathExists(e)){const t=(await n.readFile(e)).toString();if(/[^\s]/.test(t))try{return c.parseJson(t)}catch(e){throw new Error(s.failedToParse(e.message))}}return{IsEncrypted:!1}}async function u(e){return n.pathExists(o.join(e,s.hostFileName))}t.getLocalSettingsJson=l,t.setLocalAppSetting=async function(e,t,r){const a=o.join(e,s.azureFunctionLocalSettingsFileName),c=await l(a);if(c.Values=c.Values||{},c.Values[t]===r)return!0;if(c.Values[t]){if(await i.window.showWarningMessage(s.settingAlreadyExists(t),{modal:!0},s.yesString)!==s.yesString)return!1}return c.Values[t]=r,await n.writeJson(a,c,{spaces:2}),!0},t.getAFProjectContainingFile=async function(e){var t,r;const n=null!==(r=null===(t=i.workspace.workspaceFolders)||void 0===t?void 0:t.map(e=>a.getAllProjectsInFolder(e.uri,".csproj")))&&void 0!==r?r:[],c=(await Promise.all(n)).reduce((e,t)=>e.concat(t),[]).filter(e=>u(o.dirname(e.fsPath)));if(!(c.length>1)){if(0===c.length)throw new Error(s.noAzureFunctionsProjectsInWorkspace);return c[0]}console.error("need to find which project contains the file "+e.fsPath)},t.isFunctionProject=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;const n=r(2),o=r(3),i=r(206);let a=[];t.activate=function(e){n.commands.executeCommand("setContext","azdataAvailable",!!o.getAzdataApi());const t=new i.default(e);return a.push(t),e.subscriptions.push(t),t.activate()},t.deactivate=function(){for(let e of a)e.deactivate()}},function(e,t,r){"use strict";const n=r(126),o=r(150),i=r(174),a=r(175),s=r(177),c=r(17);async function l(e,t){p(e);const r=u(e,o.default,t),n=await Promise.all(r);return c.array.flatten(n)}function u(e,t,r){const o=[].concat(e),i=new s.default(r),a=n.generate(o,i),c=new t(i);return a.map(c.read,c)}function p(e){if(![].concat(e).every(e=>c.string.isString(e)&&!c.string.isEmpty(e)))throw new TypeError("Patterns must be a string (non empty) or an array of strings")}!function(e){e.sync=function(e,t){p(e);const r=u(e,a.default,t);return c.array.flatten(r)},e.stream=function(e,t){p(e);const r=u(e,i.default,t);return c.stream.merge(r)},e.generateTasks=function(e,t){p(e);const r=[].concat(e),o=new s.default(t);return n.generate(r,o)},e.isDynamicPattern=function(e,t){p(e);const r=new s.default(t);return c.pattern.isDynamicPattern(e,r)},e.escapePath=function(e){return p(e),c.path.escape(e)}}(l||(l={})),e.exports=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertPatternGroupToTask=t.convertPatternGroupsToTasks=t.groupPatternsByBaseDirectory=t.getNegativePatternsAsPositive=t.getPositivePatterns=t.convertPatternsToTasks=t.generate=void 0;const n=r(17);function o(e,t,r){const o=[],i=n.pattern.getPatternsOutsideCurrentDirectory(e),a=n.pattern.getPatternsInsideCurrentDirectory(e),u=s(i),p=s(a);return o.push(...c(u,t,r)),"."in p?o.push(l(".",a,t,r)):o.push(...c(p,t,r)),o}function i(e){return n.pattern.getPositivePatterns(e)}function a(e,t){return n.pattern.getNegativePatterns(e).concat(t).map(n.pattern.convertToPositivePattern)}function s(e){return e.reduce((e,t)=>{const r=n.pattern.getBaseDirectory(t);return r in e?e[r].push(t):e[r]=[t],e},{})}function c(e,t,r){return Object.keys(e).map(n=>l(n,e[n],t,r))}function l(e,t,r,o){return{dynamic:o,positive:t,negative:r,base:e,patterns:[].concat(t,r.map(n.pattern.convertToNegativePattern))}}t.generate=function(e,t){const r=i(e),s=a(e,t.ignore),c=r.filter(e=>n.pattern.isStaticPattern(e,t)),l=r.filter(e=>n.pattern.isDynamicPattern(e,t)),u=o(c,s,!1),p=o(l,s,!0);return u.concat(p)},t.convertPatternsToTasks=o,t.getPositivePatterns=i,t.getNegativePatternsAsPositive=a,t.groupPatternsByBaseDirectory=s,t.convertPatternGroupsToTasks=c,t.convertPatternGroupToTask=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitWhen=t.flatten=void 0,t.flatten=function(e){return e.reduce((e,t)=>[].concat(e,t),[])},t.splitWhen=function(e,t){const r=[[]];let n=0;for(const o of e)t(o)?(n++,r[n]=[]):r[n].push(o);return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEnoentCodeError=void 0,t.isEnoentCodeError=function(e){return"ENOENT"===e.code}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDirentFromStats=void 0;class n{constructor(e,t){this.name=e,this.isBlockDevice=t.isBlockDevice.bind(t),this.isCharacterDevice=t.isCharacterDevice.bind(t),this.isDirectory=t.isDirectory.bind(t),this.isFIFO=t.isFIFO.bind(t),this.isFile=t.isFile.bind(t),this.isSocket=t.isSocket.bind(t),this.isSymbolicLink=t.isSymbolicLink.bind(t)}}t.createDirentFromStats=function(e,t){return new n(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeLeadingDotSegment=t.escape=t.makeAbsolute=t.unixify=void 0;const n=r(0),o=/(\\?)([()*?[\]{|}]|^!|[!+@](?=\())/g;t.unixify=function(e){return e.replace(/\\/g,"/")},t.makeAbsolute=function(e,t){return n.resolve(e,t)},t.escape=function(e){return e.replace(o,"\\$2")},t.removeLeadingDotSegment=function(e){if("."===e.charAt(0)){const t=e.charAt(1);if("/"===t||"\\"===t)return e.slice(2)}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchAny=t.convertPatternsToRe=t.makeRe=t.getPatternParts=t.expandBraceExpansion=t.expandPatternsWithBraceExpansion=t.isAffectDepthOfReadingPattern=t.endsWithSlashGlobStar=t.hasGlobStar=t.getBaseDirectory=t.isPatternRelatedToParentDirectory=t.getPatternsOutsideCurrentDirectory=t.getPatternsInsideCurrentDirectory=t.getPositivePatterns=t.getNegativePatterns=t.isPositivePattern=t.isNegativePattern=t.convertToNegativePattern=t.convertToPositivePattern=t.isDynamicPattern=t.isStaticPattern=void 0;const n=r(0),o=r(132),i=r(135),a=/[*?]|^!/,s=/\[.*]/,c=/(?:^|[^!*+?@])\(.*\|.*\)/,l=/[!*+?@]\(.*\)/,u=/{.*(?:,|\.\.).*}/;function p(e,t={}){return!d(e,t)}function d(e,t={}){return""!==e&&(!(!1!==t.caseSensitiveMatch&&!e.includes("\\"))||(!!(a.test(e)||s.test(e)||c.test(e))||(!(!1===t.extglob||!l.test(e))||!(!1===t.braceExpansion||!u.test(e)))))}function h(e){return e.startsWith("!")&&"("!==e[1]}function f(e){return!h(e)}function m(e){return e.startsWith("..")||e.startsWith("./..")}function g(e){return e.endsWith("/**")}function y(e){return i.braces(e,{expand:!0,nodupes:!0})}function v(e,t){return i.makeRe(e,t)}t.isStaticPattern=p,t.isDynamicPattern=d,t.convertToPositivePattern=function(e){return h(e)?e.slice(1):e},t.convertToNegativePattern=function(e){return"!"+e},t.isNegativePattern=h,t.isPositivePattern=f,t.getNegativePatterns=function(e){return e.filter(h)},t.getPositivePatterns=function(e){return e.filter(f)},t.getPatternsInsideCurrentDirectory=function(e){return e.filter(e=>!m(e))},t.getPatternsOutsideCurrentDirectory=function(e){return e.filter(m)},t.isPatternRelatedToParentDirectory=m,t.getBaseDirectory=function(e){return o(e,{flipBackslashes:!1})},t.hasGlobStar=function(e){return e.includes("**")},t.endsWithSlashGlobStar=g,t.isAffectDepthOfReadingPattern=function(e){const t=n.basename(e);return g(e)||p(t)},t.expandPatternsWithBraceExpansion=function(e){return e.reduce((e,t)=>e.concat(y(t)),[])},t.expandBraceExpansion=y,t.getPatternParts=function(e,t){let{parts:r}=i.scan(e,Object.assign(Object.assign({},t),{parts:!0}));return 0===r.length&&(r=[e]),r[0].startsWith("/")&&(r[0]=r[0].slice(1),r.unshift("")),r},t.makeRe=v,t.convertPatternsToRe=function(e,t){return e.map(e=>v(e,t))},t.matchAny=function(e,t){return t.some(t=>t.test(e))}},function(e,t,r){"use strict";var n=r(133),o=r(0).posix.dirname,i="win32"===r(9).platform(),a=/\\/g,s=/[\{\[].*[\}\]]$/,c=/(^|[^\\])([\{\[]|\([^\)]+$)/,l=/\\([\!\*\?\|\[\]\(\)\{\}])/g;e.exports=function(e,t){Object.assign({flipBackslashes:!0},t).flipBackslashes&&i&&e.indexOf("/")<0&&(e=e.replace(a,"/")),s.test(e)&&(e+="/"),e+="a";do{e=o(e)}while(n(e)||c.test(e));return e.replace(l,"$1")}},function(e,t,r){
/*!
 * is-glob <https://github.com/jonschlinkert/is-glob>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
var n=r(134),o={"{":"}","(":")","[":"]"},i=/\\(.)|(^!|\*|[\].+)]\?|\[[^\\\]]+\]|\{[^\\}]+\}|\(\?[:!=][^\\)]+\)|\([^|]+\|[^\\)]+\))/,a=/\\(.)|(^!|[*?{}()[\]]|\(\?)/;e.exports=function(e,t){if("string"!=typeof e||""===e)return!1;if(n(e))return!0;var r,s=i;for(t&&!1===t.strict&&(s=a);r=s.exec(e);){if(r[2])return!0;var c=r.index+r[0].length,l=r[1],u=l?o[l]:null;if(l&&u){var p=e.indexOf(u,c);-1!==p&&(c=p+1)}e=e.slice(c)}return!1}},function(e,t){
/*!
 * is-extglob <https://github.com/jonschlinkert/is-extglob>
 *
 * Copyright (c) 2014-2016, Jon Schlinkert.
 * Licensed under the MIT License.
 */
e.exports=function(e){if("string"!=typeof e||""===e)return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1}},function(e,t,r){"use strict";const n=r(20),o=r(136),i=r(143),a=r(33),s=e=>""===e||"./"===e,c=(e,t,r)=>{t=[].concat(t),e=[].concat(e);let n=new Set,o=new Set,a=new Set,s=0,c=e=>{a.add(e.output),r&&r.onResult&&r.onResult(e)};for(let a=0;a<t.length;a++){let l=i(String(t[a]),{...r,onResult:c},!0),u=l.state.negated||l.state.negatedExtglob;u&&s++;for(let t of e){let e=l(t,!0);(u?!e.isMatch:e.isMatch)&&(u?n.add(e.output):(n.delete(e.output),o.add(e.output)))}}let l=(s===t.length?[...a]:[...o]).filter(e=>!n.has(e));if(r&&0===l.length){if(!0===r.failglob)throw new Error(`No matches found for "${t.join(", ")}"`);if(!0===r.nonull||!0===r.nullglob)return r.unescape?t.map(e=>e.replace(/\\/g,"")):t}return l};c.match=c,c.matcher=(e,t)=>i(e,t),c.any=c.isMatch=(e,t,r)=>i(t,r)(e),c.not=(e,t,r={})=>{t=[].concat(t).map(String);let n=new Set,o=[],i=c(e,t,{...r,onResult:e=>{r.onResult&&r.onResult(e),o.push(e.output)}});for(let e of o)i.includes(e)||n.add(e);return[...n]},c.contains=(e,t,r)=>{if("string"!=typeof e)throw new TypeError(`Expected a string: "${n.inspect(e)}"`);if(Array.isArray(t))return t.some(t=>c.contains(e,t,r));if("string"==typeof t){if(s(e)||s(t))return!1;if(e.includes(t)||e.startsWith("./")&&e.slice(2).includes(t))return!0}return c.isMatch(e,t,{...r,contains:!0})},c.matchKeys=(e,t,r)=>{if(!a.isObject(e))throw new TypeError("Expected the first argument to be an object");let n=c(Object.keys(e),t,r),o={};for(let t of n)o[t]=e[t];return o},c.some=(e,t,r)=>{let n=[].concat(e);for(let e of[].concat(t)){let t=i(String(e),r);if(n.some(e=>t(e)))return!0}return!1},c.every=(e,t,r)=>{let n=[].concat(e);for(let e of[].concat(t)){let t=i(String(e),r);if(!n.every(e=>t(e)))return!1}return!0},c.all=(e,t,r)=>{if("string"!=typeof e)throw new TypeError(`Expected a string: "${n.inspect(e)}"`);return[].concat(t).every(t=>i(t,r)(e))},c.capture=(e,t,r)=>{let n=a.isWindows(r),o=i.makeRe(String(e),{...r,capture:!0}).exec(n?a.toPosixSlashes(t):t);if(o)return o.slice(1).map(e=>void 0===e?"":e)},c.makeRe=(...e)=>i.makeRe(...e),c.scan=(...e)=>i.scan(...e),c.parse=(e,t)=>{let r=[];for(let n of[].concat(e||[]))for(let e of o(String(n),t))r.push(i.parse(e,t));return r},c.braces=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");return t&&!0===t.nobrace||!/\{.*\}/.test(e)?[e]:o(e,t)},c.braceExpand=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");return c.braces(e,{...t,expand:!0})},e.exports=c},function(e,t,r){"use strict";const n=r(51),o=r(137),i=r(140),a=r(141),s=(e,t={})=>{let r=[];if(Array.isArray(e))for(let n of e){let e=s.create(n,t);Array.isArray(e)?r.push(...e):r.push(e)}else r=[].concat(s.create(e,t));return t&&!0===t.expand&&!0===t.nodupes&&(r=[...new Set(r)]),r};s.parse=(e,t={})=>a(e,t),s.stringify=(e,t={})=>n("string"==typeof e?s.parse(e,t):e,t),s.compile=(e,t={})=>("string"==typeof e&&(e=s.parse(e,t)),o(e,t)),s.expand=(e,t={})=>{"string"==typeof e&&(e=s.parse(e,t));let r=i(e,t);return!0===t.noempty&&(r=r.filter(Boolean)),!0===t.nodupes&&(r=[...new Set(r)]),r},s.create=(e,t={})=>""===e||e.length<3?[e]:!0!==t.expand?s.compile(e,t):s.expand(e,t),e.exports=s},function(e,t,r){"use strict";const n=r(75),o=r(52);e.exports=(e,t={})=>{let r=(e,i={})=>{let a=o.isInvalidBrace(i),s=!0===e.invalid&&!0===t.escapeInvalid,c=!0===a||!0===s,l=!0===t.escapeInvalid?"\\":"",u="";if(!0===e.isOpen)return l+e.value;if(!0===e.isClose)return l+e.value;if("open"===e.type)return c?l+e.value:"(";if("close"===e.type)return c?l+e.value:")";if("comma"===e.type)return"comma"===e.prev.type?"":c?e.value:"|";if(e.value)return e.value;if(e.nodes&&e.ranges>0){let r=o.reduce(e.nodes),i=n(...r,{...t,wrap:!1,toRegex:!0});if(0!==i.length)return r.length>1&&i.length>1?`(${i})`:i}if(e.nodes)for(let t of e.nodes)u+=r(t,e);return u};return r(e)}},function(e,t,r){"use strict";
/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const n=r(139),o=(e,t,r)=>{if(!1===n(e))throw new TypeError("toRegexRange: expected the first argument to be a number");if(void 0===t||e===t)return String(e);if(!1===n(t))throw new TypeError("toRegexRange: expected the second argument to be a number.");let i={relaxZeros:!0,...r};"boolean"==typeof i.strictZeros&&(i.relaxZeros=!1===i.strictZeros);let c=e+":"+t+"="+String(i.relaxZeros)+String(i.shorthand)+String(i.capture)+String(i.wrap);if(o.cache.hasOwnProperty(c))return o.cache[c].result;let l=Math.min(e,t),u=Math.max(e,t);if(1===Math.abs(l-u)){let r=e+"|"+t;return i.capture?`(${r})`:!1===i.wrap?r:`(?:${r})`}let p=f(e)||f(t),d={min:e,max:t,a:l,b:u},h=[],m=[];if(p&&(d.isPadded=p,d.maxLen=String(d.max).length),l<0){m=a(u<0?Math.abs(u):1,Math.abs(l),d,i),l=d.a=0}return u>=0&&(h=a(l,u,d,i)),d.negatives=m,d.positives=h,d.result=function(e,t,r){let n=s(e,t,"-",!1,r)||[],o=s(t,e,"",!1,r)||[],i=s(e,t,"-?",!0,r)||[];return n.concat(i).concat(o).join("|")}(m,h,i),!0===i.capture?d.result=`(${d.result})`:!1!==i.wrap&&h.length+m.length>1&&(d.result=`(?:${d.result})`),o.cache[c]=d,d.result};function i(e,t,r){if(e===t)return{pattern:e,count:[],digits:0};let n=function(e,t){let r=[];for(let n=0;n<e.length;n++)r.push([e[n],t[n]]);return r}(e,t),o=n.length,i="",a=0;for(let e=0;e<o;e++){let[t,o]=n[e];t===o?i+=t:"0"!==t||"9"!==o?i+=h(t,o,r):a++}return a&&(i+=!0===r.shorthand?"\\d":"[0-9]"),{pattern:i,count:[a],digits:o}}function a(e,t,r,n){let o,a=function(e,t){let r=1,n=1,o=u(e,r),i=new Set([t]);for(;e<=o&&o<=t;)i.add(o),r+=1,o=u(e,r);for(o=p(t+1,n)-1;e<o&&o<=t;)i.add(o),n+=1,o=p(t+1,n)-1;return i=[...i],i.sort(c),i}(e,t),s=[],l=e;for(let e=0;e<a.length;e++){let t=a[e],c=i(String(l),String(t),n),u="";r.isPadded||!o||o.pattern!==c.pattern?(r.isPadded&&(u=m(t,r,n)),c.string=u+c.pattern+d(c.count),s.push(c),l=t+1,o=c):(o.count.length>1&&o.count.pop(),o.count.push(c.count[0]),o.string=o.pattern+d(o.count),l=t+1)}return s}function s(e,t,r,n,o){let i=[];for(let o of e){let{string:e}=o;n||l(t,"string",e)||i.push(r+e),n&&l(t,"string",e)&&i.push(r+e)}return i}function c(e,t){return e>t?1:t>e?-1:0}function l(e,t,r){return e.some(e=>e[t]===r)}function u(e,t){return Number(String(e).slice(0,-t)+"9".repeat(t))}function p(e,t){return e-e%Math.pow(10,t)}function d(e){let[t=0,r=""]=e;return r||t>1?`{${t+(r?","+r:"")}}`:""}function h(e,t,r){return`[${e}${t-e==1?"":"-"}${t}]`}function f(e){return/^-?(0+)\d/.test(e)}function m(e,t,r){if(!t.isPadded)return e;let n=Math.abs(t.maxLen-String(e).length),o=!1!==r.relaxZeros;switch(n){case 0:return"";case 1:return o?"0?":"0";case 2:return o?"0{0,2}":"00";default:return o?`0{0,${n}}`:`0{${n}}`}}o.cache={},o.clearCache=()=>o.cache={},e.exports=o},function(e,t,r){"use strict";
/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return"number"==typeof e?e-e==0:"string"==typeof e&&""!==e.trim()&&(Number.isFinite?Number.isFinite(+e):isFinite(+e))}},function(e,t,r){"use strict";const n=r(75),o=r(51),i=r(52),a=(e="",t="",r=!1)=>{let n=[];if(e=[].concat(e),!(t=[].concat(t)).length)return e;if(!e.length)return r?i.flatten(t).map(e=>`{${e}}`):t;for(let o of e)if(Array.isArray(o))for(let e of o)n.push(a(e,t,r));else for(let e of t)!0===r&&"string"==typeof e&&(e=`{${e}}`),n.push(Array.isArray(e)?a(o,e,r):o+e);return i.flatten(n)};e.exports=(e,t={})=>{let r=void 0===t.rangeLimit?1e3:t.rangeLimit,s=(e,c={})=>{e.queue=[];let l=c,u=c.queue;for(;"brace"!==l.type&&"root"!==l.type&&l.parent;)l=l.parent,u=l.queue;if(e.invalid||e.dollar)return void u.push(a(u.pop(),o(e,t)));if("brace"===e.type&&!0!==e.invalid&&2===e.nodes.length)return void u.push(a(u.pop(),["{}"]));if(e.nodes&&e.ranges>0){let s=i.reduce(e.nodes);if(i.exceedsLimit(...s,t.step,r))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let c=n(...s,t);return 0===c.length&&(c=o(e,t)),u.push(a(u.pop(),c)),void(e.nodes=[])}let p=i.encloseBrace(e),d=e.queue,h=e;for(;"brace"!==h.type&&"root"!==h.type&&h.parent;)h=h.parent,d=h.queue;for(let t=0;t<e.nodes.length;t++){let r=e.nodes[t];"comma"!==r.type||"brace"!==e.type?"close"!==r.type?r.value&&"open"!==r.type?d.push(a(d.pop(),r.value)):r.nodes&&s(r,e):u.push(a(u.pop(),d,p)):(1===t&&d.push(""),d.push(""))}return d};return i.flatten(s(e))}},function(e,t,r){"use strict";const n=r(51),{MAX_LENGTH:o,CHAR_BACKSLASH:i,CHAR_BACKTICK:a,CHAR_COMMA:s,CHAR_DOT:c,CHAR_LEFT_PARENTHESES:l,CHAR_RIGHT_PARENTHESES:u,CHAR_LEFT_CURLY_BRACE:p,CHAR_RIGHT_CURLY_BRACE:d,CHAR_LEFT_SQUARE_BRACKET:h,CHAR_RIGHT_SQUARE_BRACKET:f,CHAR_DOUBLE_QUOTE:m,CHAR_SINGLE_QUOTE:g,CHAR_NO_BREAK_SPACE:y,CHAR_ZERO_WIDTH_NOBREAK_SPACE:v}=r(142);e.exports=(e,t={})=>{if("string"!=typeof e)throw new TypeError("Expected a string");let r=t||{},b="number"==typeof r.maxLength?Math.min(o,r.maxLength):o;if(e.length>b)throw new SyntaxError(`Input length (${e.length}), exceeds max characters (${b})`);let w,S={type:"root",input:e,nodes:[]},E=[S],P=S,T=S,_=0,D=e.length,C=0,x=0;const I=()=>e[C++],j=e=>{if("text"===e.type&&"dot"===T.type&&(T.type="text"),!T||"text"!==T.type||"text"!==e.type)return P.nodes.push(e),e.parent=P,e.prev=T,T=e,e;T.value+=e.value};for(j({type:"bos"});C<D;)if(P=E[E.length-1],w=I(),w!==v&&w!==y)if(w!==i)if(w!==f)if(w!==h)if(w!==l)if(w!==u)if(w!==m&&w!==g&&w!==a)if(w!==p)if(w!==d)if(w===s&&x>0){if(P.ranges>0){P.ranges=0;let e=P.nodes.shift();P.nodes=[e,{type:"text",value:n(P)}]}j({type:"comma",value:w}),P.commas++}else if(w===c&&x>0&&0===P.commas){let e=P.nodes;if(0===x||0===e.length){j({type:"text",value:w});continue}if("dot"===T.type){if(P.range=[],T.value+=w,T.type="range",3!==P.nodes.length&&5!==P.nodes.length){P.invalid=!0,P.ranges=0,T.type="text";continue}P.ranges++,P.args=[];continue}if("range"===T.type){e.pop();let t=e[e.length-1];t.value+=T.value+w,T=t,P.ranges--;continue}j({type:"dot",value:w})}else j({type:"text",value:w});else{if("brace"!==P.type){j({type:"text",value:w});continue}let e="close";P=E.pop(),P.close=!0,j({type:e,value:w}),x--,P=E[E.length-1]}else{x++;let e=T.value&&"$"===T.value.slice(-1)||!0===P.dollar;P=j({type:"brace",open:!0,close:!1,dollar:e,depth:x,commas:0,ranges:0,nodes:[]}),E.push(P),j({type:"open",value:w})}else{let e,r=w;for(!0!==t.keepQuotes&&(w="");C<D&&(e=I());)if(e!==i){if(e===r){!0===t.keepQuotes&&(w+=e);break}w+=e}else w+=e+I();j({type:"text",value:w})}else{if("paren"!==P.type){j({type:"text",value:w});continue}P=E.pop(),j({type:"text",value:w}),P=E[E.length-1]}else P=j({type:"paren",nodes:[]}),E.push(P),j({type:"text",value:w});else{_++;let e;for(;C<D&&(e=I());)if(w+=e,e!==h)if(e!==i){if(e===f&&(_--,0===_))break}else w+=I();else _++;j({type:"text",value:w})}else j({type:"text",value:"\\"+w});else j({type:"text",value:(t.keepEscaping?w:"")+I()});do{if(P=E.pop(),"root"!==P.type){P.nodes.forEach(e=>{e.nodes||("open"===e.type&&(e.isOpen=!0),"close"===e.type&&(e.isClose=!0),e.nodes||(e.type="text"),e.invalid=!0)});let e=E[E.length-1],t=e.nodes.indexOf(P);e.nodes.splice(t,1,...P.nodes)}}while(E.length>0);return j({type:"eos"}),S}},function(e,t,r){"use strict";e.exports={MAX_LENGTH:65536,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:"\n",CHAR_NO_BREAK_SPACE:"",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"\t",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\ufeff"}},function(e,t,r){"use strict";e.exports=r(144)},function(e,t,r){"use strict";const n=r(0),o=r(145),i=r(146),a=r(33),s=r(34),c=(e,t,r=!1)=>{if(Array.isArray(e)){const n=e.map(e=>c(e,t,r));return e=>{for(const t of n){const r=t(e);if(r)return r}return!1}}const n=(o=e)&&"object"==typeof o&&!Array.isArray(o)&&e.tokens&&e.input;var o;if(""===e||"string"!=typeof e&&!n)throw new TypeError("Expected pattern to be a non-empty string");const i=t||{},s=a.isWindows(t),l=n?c.compileRe(e,t):c.makeRe(e,t,!1,!0),u=l.state;delete l.state;let p=()=>!1;if(i.ignore){const e={...t,ignore:null,onMatch:null,onResult:null};p=c(i.ignore,e,r)}const d=(r,n=!1)=>{const{isMatch:o,match:a,output:d}=c.test(r,l,t,{glob:e,posix:s}),h={glob:e,state:u,regex:l,posix:s,input:r,output:d,match:a,isMatch:o};return"function"==typeof i.onResult&&i.onResult(h),!1===o?(h.isMatch=!1,!!n&&h):p(r)?("function"==typeof i.onIgnore&&i.onIgnore(h),h.isMatch=!1,!!n&&h):("function"==typeof i.onMatch&&i.onMatch(h),!n||h)};return r&&(d.state=u),d};c.test=(e,t,r,{glob:n,posix:o}={})=>{if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(""===e)return{isMatch:!1,output:""};const i=r||{},s=i.format||(o?a.toPosixSlashes:null);let l=e===n,u=l&&s?s(e):e;return!1===l&&(u=s?s(e):e,l=u===n),!1!==l&&!0!==i.capture||(l=!0===i.matchBase||!0===i.basename?c.matchBase(e,t,r,o):t.exec(u)),{isMatch:Boolean(l),match:l,output:u}},c.matchBase=(e,t,r,o=a.isWindows(r))=>(t instanceof RegExp?t:c.makeRe(t,r)).test(n.basename(e)),c.isMatch=(e,t,r)=>c(t,r)(e),c.parse=(e,t)=>Array.isArray(e)?e.map(e=>c.parse(e,t)):i(e,{...t,fastpaths:!1}),c.scan=(e,t)=>o(e,t),c.compileRe=(e,t,r=!1,n=!1)=>{if(!0===r)return e.output;const o=t||{},i=o.contains?"":"^",a=o.contains?"":"$";let s=`${i}(?:${e.output})${a}`;e&&!0===e.negated&&(s=`^(?!${s}).*$`);const l=c.toRegex(s,t);return!0===n&&(l.state=e),l},c.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||"string"!=typeof e)throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return!1===t.fastpaths||"."!==e[0]&&"*"!==e[0]||(o.output=i.fastpaths(e,t)),o.output||(o=i(e,t)),c.compileRe(o,t,r,n)},c.toRegex=(e,t)=>{try{const r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(e){if(t&&!0===t.debug)throw e;return/$^/}},c.constants=s,e.exports=c},function(e,t,r){"use strict";const n=r(33),{CHAR_ASTERISK:o,CHAR_AT:i,CHAR_BACKWARD_SLASH:a,CHAR_COMMA:s,CHAR_DOT:c,CHAR_EXCLAMATION_MARK:l,CHAR_FORWARD_SLASH:u,CHAR_LEFT_CURLY_BRACE:p,CHAR_LEFT_PARENTHESES:d,CHAR_LEFT_SQUARE_BRACKET:h,CHAR_PLUS:f,CHAR_QUESTION_MARK:m,CHAR_RIGHT_CURLY_BRACE:g,CHAR_RIGHT_PARENTHESES:y,CHAR_RIGHT_SQUARE_BRACKET:v}=r(34),b=e=>e===u||e===a,w=e=>{!0!==e.isPrefix&&(e.depth=e.isGlobstar?1/0:1)};e.exports=(e,t)=>{const r=t||{},S=e.length-1,E=!0===r.parts||!0===r.scanToEnd,P=[],T=[],_=[];let D,C,x=e,I=-1,j=0,N=0,A=!1,k=!1,R=!1,F=!1,O=!1,L=!1,q=!1,M=!1,B=!1,V=!1,$=0,H={value:"",depth:0,isGlob:!1};const U=()=>I>=S,G=()=>(D=C,x.charCodeAt(++I));for(;I<S;){let e;if(C=G(),C!==a){if(!0===L||C===p){for($++;!0!==U()&&(C=G());)if(C!==a)if(C!==p){if(!0!==L&&C===c&&(C=G())===c){if(A=H.isBrace=!0,R=H.isGlob=!0,V=!0,!0===E)continue;break}if(!0!==L&&C===s){if(A=H.isBrace=!0,R=H.isGlob=!0,V=!0,!0===E)continue;break}if(C===g&&($--,0===$)){L=!1,A=H.isBrace=!0,V=!0;break}}else $++;else q=H.backslashes=!0,G();if(!0===E)continue;break}if(C!==u){if(!0!==r.noext){if(!0===(C===f||C===i||C===o||C===m||C===l)&&x.charCodeAt(I+1)===d){if(R=H.isGlob=!0,F=H.isExtglob=!0,V=!0,C===l&&I===j&&(B=!0),!0===E){for(;!0!==U()&&(C=G());)if(C!==a){if(C===y){R=H.isGlob=!0,V=!0;break}}else q=H.backslashes=!0,C=G();continue}break}}if(C===o){if(D===o&&(O=H.isGlobstar=!0),R=H.isGlob=!0,V=!0,!0===E)continue;break}if(C===m){if(R=H.isGlob=!0,V=!0,!0===E)continue;break}if(C===h){for(;!0!==U()&&(e=G());)if(e!==a){if(e===v){k=H.isBracket=!0,R=H.isGlob=!0,V=!0;break}}else q=H.backslashes=!0,G();if(!0===E)continue;break}if(!0===r.nonegate||C!==l||I!==j){if(!0!==r.noparen&&C===d){if(R=H.isGlob=!0,!0===E){for(;!0!==U()&&(C=G());)if(C!==d){if(C===y){V=!0;break}}else q=H.backslashes=!0,C=G();continue}break}if(!0===R){if(V=!0,!0===E)continue;break}}else M=H.negated=!0,j++}else{if(P.push(I),T.push(H),H={value:"",depth:0,isGlob:!1},!0===V)continue;if(D===c&&I===j+1){j+=2;continue}N=I+1}}else q=H.backslashes=!0,C=G(),C===p&&(L=!0)}!0===r.noext&&(F=!1,R=!1);let z=x,W="",X="";j>0&&(W=x.slice(0,j),x=x.slice(j),N-=j),z&&!0===R&&N>0?(z=x.slice(0,N),X=x.slice(N)):!0===R?(z="",X=x):z=x,z&&""!==z&&"/"!==z&&z!==x&&b(z.charCodeAt(z.length-1))&&(z=z.slice(0,-1)),!0===r.unescape&&(X&&(X=n.removeBackslashes(X)),z&&!0===q&&(z=n.removeBackslashes(z)));const Q={prefix:W,input:e,start:j,base:z,glob:X,isBrace:A,isBracket:k,isGlob:R,isExtglob:F,isGlobstar:O,negated:M,negatedExtglob:B};if(!0===r.tokens&&(Q.maxDepth=0,b(C)||T.push(H),Q.tokens=T),!0===r.parts||!0===r.tokens){let t;for(let n=0;n<P.length;n++){const o=t?t+1:j,i=P[n],a=e.slice(o,i);r.tokens&&(0===n&&0!==j?(T[n].isPrefix=!0,T[n].value=W):T[n].value=a,w(T[n]),Q.maxDepth+=T[n].depth),0===n&&""===a||_.push(a),t=i}if(t&&t+1<e.length){const n=e.slice(t+1);_.push(n),r.tokens&&(T[T.length-1].value=n,w(T[T.length-1]),Q.maxDepth+=T[T.length-1].depth)}Q.slashes=P,Q.parts=_}return Q}},function(e,t,r){"use strict";const n=r(34),o=r(33),{MAX_LENGTH:i,POSIX_REGEX_SOURCE:a,REGEX_NON_SPECIAL_CHARS:s,REGEX_SPECIAL_CHARS_BACKREF:c,REPLACEMENTS:l}=n,u=(e,t)=>{if("function"==typeof t.expandRange)return t.expandRange(...e,t);e.sort();const r=`[${e.join("-")}]`;try{new RegExp(r)}catch(t){return e.map(e=>o.escapeRegex(e)).join("..")}return r},p=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,d=(e,t)=>{if("string"!=typeof e)throw new TypeError("Expected a string");e=l[e]||e;const r={...t},d="number"==typeof r.maxLength?Math.min(i,r.maxLength):i;let h=e.length;if(h>d)throw new SyntaxError(`Input length: ${h}, exceeds maximum allowed length: ${d}`);const f={type:"bos",value:"",output:r.prepend||""},m=[f],g=r.capture?"":"?:",y=o.isWindows(t),v=n.globChars(y),b=n.extglobChars(v),{DOT_LITERAL:w,PLUS_LITERAL:S,SLASH_LITERAL:E,ONE_CHAR:P,DOTS_SLASH:T,NO_DOT:_,NO_DOT_SLASH:D,NO_DOTS_SLASH:C,QMARK:x,QMARK_NO_DOT:I,STAR:j,START_ANCHOR:N}=v,A=e=>`(${g}(?:(?!${N}${e.dot?T:w}).)*?)`,k=r.dot?"":_,R=r.dot?x:I;let F=!0===r.bash?A(r):j;r.capture&&(F=`(${F})`),"boolean"==typeof r.noext&&(r.noextglob=r.noext);const O={input:e,index:-1,start:0,dot:!0===r.dot,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:m};e=o.removePrefix(e,O),h=e.length;const L=[],q=[],M=[];let B,V=f;const $=()=>O.index===h-1,H=O.peek=(t=1)=>e[O.index+t],U=O.advance=()=>e[++O.index]||"",G=()=>e.slice(O.index+1),z=(e="",t=0)=>{O.consumed+=e,O.index+=t},W=e=>{O.output+=null!=e.output?e.output:e.value,z(e.value)},X=()=>{let e=1;for(;"!"===H()&&("("!==H(2)||"?"===H(3));)U(),O.start++,e++;return e%2!=0&&(O.negated=!0,O.start++,!0)},Q=e=>{O[e]++,M.push(e)},K=e=>{O[e]--,M.pop()},J=e=>{if("globstar"===V.type){const t=O.braces>0&&("comma"===e.type||"brace"===e.type),r=!0===e.extglob||L.length&&("pipe"===e.type||"paren"===e.type);"slash"===e.type||"paren"===e.type||t||r||(O.output=O.output.slice(0,-V.output.length),V.type="star",V.value="*",V.output=F,O.output+=V.output)}if(L.length&&"paren"!==e.type&&(L[L.length-1].inner+=e.value),(e.value||e.output)&&W(e),V&&"text"===V.type&&"text"===e.type)return V.value+=e.value,void(V.output=(V.output||"")+e.value);e.prev=V,m.push(e),V=e},Y=(e,t)=>{const n={...b[t],conditions:1,inner:""};n.prev=V,n.parens=O.parens,n.output=O.output;const o=(r.capture?"(":"")+n.open;Q("parens"),J({type:e,value:t,output:O.output?"":P}),J({type:"paren",extglob:!0,value:U(),output:o}),L.push(n)},Z=e=>{let t,n=e.close+(r.capture?")":"");if("negate"===e.type){let o=F;e.inner&&e.inner.length>1&&e.inner.includes("/")&&(o=A(r)),(o!==F||$()||/^\)+$/.test(G()))&&(n=e.close=")$))"+o),e.inner.includes("*")&&(t=G())&&/^\.[^\\/.]+$/.test(t)&&(n=e.close=`)${t})${o})`),"bos"===e.prev.type&&(O.negatedExtglob=!0)}J({type:"paren",extglob:!0,value:B,output:n}),K("parens")};if(!1!==r.fastpaths&&!/(^[*!]|[/()[\]{}"])/.test(e)){let n=!1,i=e.replace(c,(e,t,r,o,i,a)=>"\\"===o?(n=!0,e):"?"===o?t?t+o+(i?x.repeat(i.length):""):0===a?R+(i?x.repeat(i.length):""):x.repeat(r.length):"."===o?w.repeat(r.length):"*"===o?t?t+o+(i?F:""):F:t?e:"\\"+e);return!0===n&&(i=!0===r.unescape?i.replace(/\\/g,""):i.replace(/\\+/g,e=>e.length%2==0?"\\\\":e?"\\":"")),i===e&&!0===r.contains?(O.output=e,O):(O.output=o.wrapOutput(i,O,t),O)}for(;!$();){if(B=U(),"\0"===B)continue;if("\\"===B){const e=H();if("/"===e&&!0!==r.bash)continue;if("."===e||";"===e)continue;if(!e){B+="\\",J({type:"text",value:B});continue}const t=/^\\+/.exec(G());let n=0;if(t&&t[0].length>2&&(n=t[0].length,O.index+=n,n%2!=0&&(B+="\\")),!0===r.unescape?B=U():B+=U(),0===O.brackets){J({type:"text",value:B});continue}}if(O.brackets>0&&("]"!==B||"["===V.value||"[^"===V.value)){if(!1!==r.posix&&":"===B){const e=V.value.slice(1);if(e.includes("[")&&(V.posix=!0,e.includes(":"))){const e=V.value.lastIndexOf("["),t=V.value.slice(0,e),r=V.value.slice(e+2),n=a[r];if(n){V.value=t+n,O.backtrack=!0,U(),f.output||1!==m.indexOf(V)||(f.output=P);continue}}}("["===B&&":"!==H()||"-"===B&&"]"===H())&&(B="\\"+B),"]"!==B||"["!==V.value&&"[^"!==V.value||(B="\\"+B),!0===r.posix&&"!"===B&&"["===V.value&&(B="^"),V.value+=B,W({value:B});continue}if(1===O.quotes&&'"'!==B){B=o.escapeRegex(B),V.value+=B,W({value:B});continue}if('"'===B){O.quotes=1===O.quotes?0:1,!0===r.keepQuotes&&J({type:"text",value:B});continue}if("("===B){Q("parens"),J({type:"paren",value:B});continue}if(")"===B){if(0===O.parens&&!0===r.strictBrackets)throw new SyntaxError(p("opening","("));const e=L[L.length-1];if(e&&O.parens===e.parens+1){Z(L.pop());continue}J({type:"paren",value:B,output:O.parens?")":"\\)"}),K("parens");continue}if("["===B){if(!0!==r.nobracket&&G().includes("]"))Q("brackets");else{if(!0!==r.nobracket&&!0===r.strictBrackets)throw new SyntaxError(p("closing","]"));B="\\"+B}J({type:"bracket",value:B});continue}if("]"===B){if(!0===r.nobracket||V&&"bracket"===V.type&&1===V.value.length){J({type:"text",value:B,output:"\\"+B});continue}if(0===O.brackets){if(!0===r.strictBrackets)throw new SyntaxError(p("opening","["));J({type:"text",value:B,output:"\\"+B});continue}K("brackets");const e=V.value.slice(1);if(!0===V.posix||"^"!==e[0]||e.includes("/")||(B="/"+B),V.value+=B,W({value:B}),!1===r.literalBrackets||o.hasRegexChars(e))continue;const t=o.escapeRegex(V.value);if(O.output=O.output.slice(0,-V.value.length),!0===r.literalBrackets){O.output+=t,V.value=t;continue}V.value=`(${g}${t}|${V.value})`,O.output+=V.value;continue}if("{"===B&&!0!==r.nobrace){Q("braces");const e={type:"brace",value:B,output:"(",outputIndex:O.output.length,tokensIndex:O.tokens.length};q.push(e),J(e);continue}if("}"===B){const e=q[q.length-1];if(!0===r.nobrace||!e){J({type:"text",value:B,output:B});continue}let t=")";if(!0===e.dots){const e=m.slice(),n=[];for(let t=e.length-1;t>=0&&(m.pop(),"brace"!==e[t].type);t--)"dots"!==e[t].type&&n.unshift(e[t].value);t=u(n,r),O.backtrack=!0}if(!0!==e.comma&&!0!==e.dots){const r=O.output.slice(0,e.outputIndex),n=O.tokens.slice(e.tokensIndex);e.value=e.output="\\{",B=t="\\}",O.output=r;for(const e of n)O.output+=e.output||e.value}J({type:"brace",value:B,output:t}),K("braces"),q.pop();continue}if("|"===B){L.length>0&&L[L.length-1].conditions++,J({type:"text",value:B});continue}if(","===B){let e=B;const t=q[q.length-1];t&&"braces"===M[M.length-1]&&(t.comma=!0,e="|"),J({type:"comma",value:B,output:e});continue}if("/"===B){if("dot"===V.type&&O.index===O.start+1){O.start=O.index+1,O.consumed="",O.output="",m.pop(),V=f;continue}J({type:"slash",value:B,output:E});continue}if("."===B){if(O.braces>0&&"dot"===V.type){"."===V.value&&(V.output=w);const e=q[q.length-1];V.type="dots",V.output+=B,V.value+=B,e.dots=!0;continue}if(O.braces+O.parens===0&&"bos"!==V.type&&"slash"!==V.type){J({type:"text",value:B,output:w});continue}J({type:"dot",value:B,output:w});continue}if("?"===B){if(!(V&&"("===V.value)&&!0!==r.noextglob&&"("===H()&&"?"!==H(2)){Y("qmark",B);continue}if(V&&"paren"===V.type){const e=H();let t=B;if("<"===e&&!o.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");("("===V.value&&!/[!=<:]/.test(e)||"<"===e&&!/<([!=]|\w+>)/.test(G()))&&(t="\\"+B),J({type:"text",value:B,output:t});continue}if(!0!==r.dot&&("slash"===V.type||"bos"===V.type)){J({type:"qmark",value:B,output:I});continue}J({type:"qmark",value:B,output:x});continue}if("!"===B){if(!0!==r.noextglob&&"("===H()&&("?"!==H(2)||!/[!=<:]/.test(H(3)))){Y("negate",B);continue}if(!0!==r.nonegate&&0===O.index){X();continue}}if("+"===B){if(!0!==r.noextglob&&"("===H()&&"?"!==H(2)){Y("plus",B);continue}if(V&&"("===V.value||!1===r.regex){J({type:"plus",value:B,output:S});continue}if(V&&("bracket"===V.type||"paren"===V.type||"brace"===V.type)||O.parens>0){J({type:"plus",value:B});continue}J({type:"plus",value:S});continue}if("@"===B){if(!0!==r.noextglob&&"("===H()&&"?"!==H(2)){J({type:"at",extglob:!0,value:B,output:""});continue}J({type:"text",value:B});continue}if("*"!==B){"$"!==B&&"^"!==B||(B="\\"+B);const e=s.exec(G());e&&(B+=e[0],O.index+=e[0].length),J({type:"text",value:B});continue}if(V&&("globstar"===V.type||!0===V.star)){V.type="star",V.star=!0,V.value+=B,V.output=F,O.backtrack=!0,O.globstar=!0,z(B);continue}let t=G();if(!0!==r.noextglob&&/^\([^?]/.test(t)){Y("star",B);continue}if("star"===V.type){if(!0===r.noglobstar){z(B);continue}const n=V.prev,o=n.prev,i="slash"===n.type||"bos"===n.type,a=o&&("star"===o.type||"globstar"===o.type);if(!0===r.bash&&(!i||t[0]&&"/"!==t[0])){J({type:"star",value:B,output:""});continue}const s=O.braces>0&&("comma"===n.type||"brace"===n.type),c=L.length&&("pipe"===n.type||"paren"===n.type);if(!i&&"paren"!==n.type&&!s&&!c){J({type:"star",value:B,output:""});continue}for(;"/**"===t.slice(0,3);){const r=e[O.index+4];if(r&&"/"!==r)break;t=t.slice(3),z("/**",3)}if("bos"===n.type&&$()){V.type="globstar",V.value+=B,V.output=A(r),O.output=V.output,O.globstar=!0,z(B);continue}if("slash"===n.type&&"bos"!==n.prev.type&&!a&&$()){O.output=O.output.slice(0,-(n.output+V.output).length),n.output="(?:"+n.output,V.type="globstar",V.output=A(r)+(r.strictSlashes?")":"|$)"),V.value+=B,O.globstar=!0,O.output+=n.output+V.output,z(B);continue}if("slash"===n.type&&"bos"!==n.prev.type&&"/"===t[0]){const e=void 0!==t[1]?"|$":"";O.output=O.output.slice(0,-(n.output+V.output).length),n.output="(?:"+n.output,V.type="globstar",V.output=`${A(r)}${E}|${E}${e})`,V.value+=B,O.output+=n.output+V.output,O.globstar=!0,z(B+U()),J({type:"slash",value:"/",output:""});continue}if("bos"===n.type&&"/"===t[0]){V.type="globstar",V.value+=B,V.output=`(?:^|${E}|${A(r)}${E})`,O.output=V.output,O.globstar=!0,z(B+U()),J({type:"slash",value:"/",output:""});continue}O.output=O.output.slice(0,-V.output.length),V.type="globstar",V.output=A(r),V.value+=B,O.output+=V.output,O.globstar=!0,z(B);continue}const n={type:"star",value:B,output:F};!0!==r.bash?!V||"bracket"!==V.type&&"paren"!==V.type||!0!==r.regex?(O.index!==O.start&&"slash"!==V.type&&"dot"!==V.type||("dot"===V.type?(O.output+=D,V.output+=D):!0===r.dot?(O.output+=C,V.output+=C):(O.output+=k,V.output+=k),"*"!==H()&&(O.output+=P,V.output+=P)),J(n)):(n.output=B,J(n)):(n.output=".*?","bos"!==V.type&&"slash"!==V.type||(n.output=k+n.output),J(n))}for(;O.brackets>0;){if(!0===r.strictBrackets)throw new SyntaxError(p("closing","]"));O.output=o.escapeLast(O.output,"["),K("brackets")}for(;O.parens>0;){if(!0===r.strictBrackets)throw new SyntaxError(p("closing",")"));O.output=o.escapeLast(O.output,"("),K("parens")}for(;O.braces>0;){if(!0===r.strictBrackets)throw new SyntaxError(p("closing","}"));O.output=o.escapeLast(O.output,"{"),K("braces")}if(!0===r.strictSlashes||"star"!==V.type&&"bracket"!==V.type||J({type:"maybe_slash",value:"",output:E+"?"}),!0===O.backtrack){O.output="";for(const e of O.tokens)O.output+=null!=e.output?e.output:e.value,e.suffix&&(O.output+=e.suffix)}return O};d.fastpaths=(e,t)=>{const r={...t},a="number"==typeof r.maxLength?Math.min(i,r.maxLength):i,s=e.length;if(s>a)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${a}`);e=l[e]||e;const c=o.isWindows(t),{DOT_LITERAL:u,SLASH_LITERAL:p,ONE_CHAR:d,DOTS_SLASH:h,NO_DOT:f,NO_DOTS:m,NO_DOTS_SLASH:g,STAR:y,START_ANCHOR:v}=n.globChars(c),b=r.dot?m:f,w=r.dot?g:f,S=r.capture?"":"?:";let E=!0===r.bash?".*?":y;r.capture&&(E=`(${E})`);const P=e=>!0===e.noglobstar?E:`(${S}(?:(?!${v}${e.dot?h:u}).)*?)`,T=e=>{switch(e){case"*":return`${b}${d}${E}`;case".*":return`${u}${d}${E}`;case"*.*":return`${b}${E}${u}${d}${E}`;case"*/*":return`${b}${E}${p}${d}${w}${E}`;case"**":return b+P(r);case"**/*":return`(?:${b}${P(r)}${p})?${w}${d}${E}`;case"**/*.*":return`(?:${b}${P(r)}${p})?${w}${E}${u}${d}${E}`;case"**/.*":return`(?:${b}${P(r)}${p})?${u}${d}${E}`;default:{const t=/^(.*?)\.(\w+)$/.exec(e);if(!t)return;const r=T(t[1]);if(!r)return;return r+u+t[2]}}},_=o.removePrefix(e,{negated:!1,prefix:""});let D=T(_);return D&&!0!==r.strictSlashes&&(D+=p+"?"),D},e.exports=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.merge=void 0;const n=r(148);function o(e){e.forEach(e=>e.emit("close"))}t.merge=function(e){const t=n(e);return e.forEach(e=>{e.once("error",e=>t.emit("error",e))}),t.once("close",()=>o(e)),t.once("end",()=>o(e)),t}},function(e,t,r){"use strict";const n=r(21).PassThrough,o=Array.prototype.slice;function i(e,t){if(Array.isArray(e))for(let r=0,n=e.length;r<n;r++)e[r]=i(e[r],t);else{if(!e._readableState&&e.pipe&&(e=e.pipe(n(t))),!e._readableState||!e.pause||!e.pipe)throw new Error("Only readable stream can be merged.");e.pause()}return e}e.exports=function(){const e=[],t=o.call(arguments);let r=!1,a=t[t.length-1];a&&!Array.isArray(a)&&null==a.pipe?t.pop():a={};const s=!1!==a.end,c=!0===a.pipeError;null==a.objectMode&&(a.objectMode=!0);null==a.highWaterMark&&(a.highWaterMark=65536);const l=n(a);function u(){for(let t=0,r=arguments.length;t<r;t++)e.push(i(arguments[t],a));return p(),this}function p(){if(r)return;r=!0;let t=e.shift();if(!t)return void process.nextTick(d);Array.isArray(t)||(t=[t]);let n=t.length+1;function o(){--n>0||(r=!1,p())}function i(e){function t(){e.removeListener("merge2UnpipeEnd",t),e.removeListener("end",t),c&&e.removeListener("error",r),o()}function r(e){l.emit("error",e)}if(e._readableState.endEmitted)return o();e.on("merge2UnpipeEnd",t),e.on("end",t),c&&e.on("error",r),e.pipe(l,{end:!1}),e.resume()}for(let e=0;e<t.length;e++)i(t[e]);o()}function d(){r=!1,l.emit("queueDrain"),s&&l.end()}l.setMaxListeners(0),l.add=u,l.on("unpipe",(function(e){e.emit("merge2UnpipeEnd")})),t.length&&u.apply(null,t);return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isString=void 0,t.isString=function(e){return"string"==typeof e},t.isEmpty=function(e){return""===e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(76),o=r(55);class i extends o.default{constructor(){super(...arguments),this._reader=new n.default(this._settings)}read(e){const t=this._getRootDirectory(e),r=this._getReaderOptions(e),n=[];return new Promise((o,i)=>{const a=this.api(t,e,r);a.once("error",i),a.on("data",e=>n.push(r.transform(e))),a.once("end",()=>o(n))})}api(e,t,r){return t.dynamic?this._reader.dynamic(e,r):this._reader.static(t.patterns,r)}}t.default=i},function(e,t,r){"use strict";function n(e,t){e(t)}function o(e,t){e(null,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.read=function(e,t,r){t.fs.lstat(e,(i,a)=>null!==i?n(r,i):a.isSymbolicLink()&&t.followSymbolicLink?void t.fs.stat(e,(e,i)=>{if(null!==e)return t.throwErrorOnBrokenSymbolicLink?n(r,e):o(r,a);t.markSymbolicLink&&(i.isSymbolicLink=()=>!0),o(r,i)}):o(r,a))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.read=function(e,t){const r=t.fs.lstatSync(e);if(!r.isSymbolicLink()||!t.followSymbolicLink)return r;try{const r=t.fs.statSync(e);return t.markSymbolicLink&&(r.isSymbolicLink=()=>!0),r}catch(e){if(!t.throwErrorOnBrokenSymbolicLink)return r;throw e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(154);t.default=class{constructor(e={}){this._options=e,this.followSymbolicLink=this._getValue(this._options.followSymbolicLink,!0),this.fs=n.createFileSystemAdapter(this._options.fs),this.markSymbolicLink=this._getValue(this._options.markSymbolicLink,!1),this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,!0)}_getValue(e,t){return void 0===e?t:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4);t.FILE_SYSTEM_ADAPTER={lstat:n.lstat,stat:n.stat,lstatSync:n.lstatSync,statSync:n.statSync},t.createFileSystemAdapter=function(e){return void 0===e?t.FILE_SYSTEM_ADAPTER:Object.assign(Object.assign({},t.FILE_SYSTEM_ADAPTER),e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(78);t.default=class{constructor(e,t){this._root=e,this._settings=t,this._reader=new n.default(this._root,this._settings),this._storage=new Set}read(e){this._reader.onError(t=>{!function(e,t){e(t)}(e,t)}),this._reader.onEntry(e=>{this._storage.add(e)}),this._reader.onEnd(()=>{!function(e,t){e(null,t)}(e,[...this._storage])}),this._reader.read()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),o=r(157),i=r(80),a=r(81);function s(e,t,r){t.fs.readdir(e,{withFileTypes:!0},(n,i)=>{if(null!==n)return l(r,n);const s=i.map(r=>({dirent:r,name:r.name,path:`${e}${t.pathSegmentSeparator}${r.name}`}));if(!t.followSymbolicLinks)return u(r,s);const c=s.map(e=>function(e,t){return r=>{if(!e.dirent.isSymbolicLink())return r(null,e);t.fs.stat(e.path,(n,o)=>null!==n?t.throwErrorOnBrokenSymbolicLink?r(n):r(null,e):(e.dirent=a.fs.createDirentFromStats(e.name,o),r(null,e)))}}(e,t));o(c,(e,t)=>{if(null!==e)return l(r,e);u(r,t)})})}function c(e,t,r){t.fs.readdir(e,(i,s)=>{if(null!==i)return l(r,i);const c=s.map(r=>`${e}${t.pathSegmentSeparator}${r}`),p=c.map(e=>r=>n.stat(e,t.fsStatSettings,r));o(p,(e,n)=>{if(null!==e)return l(r,e);const o=[];s.forEach((e,r)=>{const i=n[r],s={name:e,path:c[r],dirent:a.fs.createDirentFromStats(e,i)};t.stats&&(s.stats=i),o.push(s)}),u(r,o)})})}function l(e,t){e(t)}function u(e,t){e(null,t)}t.read=function(e,t,r){return!t.stats&&i.IS_SUPPORT_READDIR_WITH_FILE_TYPES?s(e,t,r):c(e,t,r)},t.readdirWithFileTypes=s,t.readdir=c},function(e,t){e.exports=function(e,t){var r,n,o,i=!0;Array.isArray(e)?(r=[],n=e.length):(o=Object.keys(e),r={},n=o.length);function a(e){function n(){t&&t(e,r),t=null}i?process.nextTick(n):n()}function s(e,t,o){r[e]=o,(0==--n||t)&&a(t)}n?o?o.forEach((function(t){e[t]((function(e,r){s(t,e,r)}))})):e.forEach((function(e,t){e((function(e,r){s(t,e,r)}))})):a(null);i=!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t){this.name=e,this.isBlockDevice=t.isBlockDevice.bind(t),this.isCharacterDevice=t.isCharacterDevice.bind(t),this.isDirectory=t.isDirectory.bind(t),this.isFIFO=t.isFIFO.bind(t),this.isFile=t.isFile.bind(t),this.isSocket=t.isSocket.bind(t),this.isSymbolicLink=t.isSymbolicLink.bind(t)}}t.createDirentFromStats=function(e,t){return new n(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),o=r(80),i=r(81);function a(e,t){return t.fs.readdirSync(e,{withFileTypes:!0}).map(r=>{const n={dirent:r,name:r.name,path:`${e}${t.pathSegmentSeparator}${r.name}`};if(n.dirent.isSymbolicLink()&&t.followSymbolicLinks)try{const e=t.fs.statSync(n.path);n.dirent=i.fs.createDirentFromStats(n.name,e)}catch(e){if(t.throwErrorOnBrokenSymbolicLink)throw e}return n})}function s(e,t){return t.fs.readdirSync(e).map(r=>{const o=`${e}${t.pathSegmentSeparator}${r}`,a=n.statSync(o,t.fsStatSettings),s={name:r,path:o,dirent:i.fs.createDirentFromStats(r,a)};return t.stats&&(s.stats=a),s})}t.read=function(e,t){return!t.stats&&o.IS_SUPPORT_READDIR_WITH_FILE_TYPES?a(e,t):s(e,t)},t.readdirWithFileTypes=a,t.readdir=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(22),i=r(161);t.default=class{constructor(e={}){this._options=e,this.followSymbolicLinks=this._getValue(this._options.followSymbolicLinks,!1),this.fs=i.createFileSystemAdapter(this._options.fs),this.pathSegmentSeparator=this._getValue(this._options.pathSegmentSeparator,n.sep),this.stats=this._getValue(this._options.stats,!1),this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,!0),this.fsStatSettings=new o.Settings({followSymbolicLink:this.followSymbolicLinks,fs:this.fs,throwErrorOnBrokenSymbolicLink:this.throwErrorOnBrokenSymbolicLink})}_getValue(e,t){return void 0===e?t:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4);t.FILE_SYSTEM_ADAPTER={lstat:n.lstat,stat:n.stat,lstatSync:n.lstatSync,statSync:n.statSync,readdir:n.readdir,readdirSync:n.readdirSync},t.createFileSystemAdapter=function(e){return void 0===e?t.FILE_SYSTEM_ADAPTER:Object.assign(Object.assign({},t.FILE_SYSTEM_ADAPTER),e)}},function(e,t,r){"use strict";var n=r(163);function o(){}function i(){this.value=null,this.callback=o,this.next=null,this.release=o,this.context=null;var e=this;this.worked=function(t,r){var n=e.callback;e.value=null,e.callback=o,n.call(e.context,t,r),e.release(e)}}e.exports=function(e,t,r){"function"==typeof e&&(r=t,t=e,e=null);var a=n(i),s=null,c=null,l=0,u={push:function(r,n){var i=a.get();i.context=e,i.release=p,i.value=r,i.callback=n||o,l===u.concurrency||u.paused?c?(c.next=i,c=i):(s=i,c=i,u.saturated()):(l++,t.call(e,i.value,i.worked))},drain:o,saturated:o,pause:function(){u.paused=!0},paused:!1,concurrency:r,running:function(){return l},resume:function(){if(!u.paused)return;u.paused=!1;for(var e=0;e<u.concurrency;e++)l++,p()},idle:function(){return 0===l&&0===u.length()},length:function(){var e=s,t=0;for(;e;)e=e.next,t++;return t},getQueue:function(){var e=s,t=[];for(;e;)t.push(e.value),e=e.next;return t},unshift:function(r,n){var i=a.get();i.context=e,i.release=p,i.value=r,i.callback=n||o,l===u.concurrency||u.paused?s?(i.next=s,s=i):(s=i,c=i,u.saturated()):(l++,t.call(e,i.value,i.worked))},empty:o,kill:function(){s=null,c=null,u.drain=o},killAndDrain:function(){s=null,c=null,u.drain(),u.drain=o}};return u;function p(r){r&&a.release(r);var n=s;n?u.paused?l--:(c===s&&(c=null),s=n.next,n.next=null,t.call(e,n.value,n.worked),null===c&&u.empty()):0==--l&&u.drain()}}},function(e,t,r){"use strict";e.exports=function(e){var t=new e,r=t;return{get:function(){var n=t;return n.next?t=n.next:(t=new e,r=t),n.next=null,n},release:function(e){r.next=e,r=e}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(21),o=r(78);t.default=class{constructor(e,t){this._root=e,this._settings=t,this._reader=new o.default(this._root,this._settings),this._stream=new n.Readable({objectMode:!0,read:()=>{},destroy:this._reader.destroy.bind(this._reader)})}read(){return this._reader.onError(e=>{this._stream.emit("error",e)}),this._reader.onEntry(e=>{this._stream.push(e)}),this._reader.onEnd(()=>{this._stream.push(null)}),this._reader.read(),this._stream}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(166);t.default=class{constructor(e,t){this._root=e,this._settings=t,this._reader=new n.default(this._root,this._settings)}read(){return this._reader.read()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(53),o=r(54),i=r(82);class a extends i.default{constructor(){super(...arguments),this._scandir=n.scandirSync,this._storage=new Set,this._queue=new Set}read(){return this._pushToQueue(this._root,this._settings.basePath),this._handleQueue(),[...this._storage]}_pushToQueue(e,t){this._queue.add({directory:e,base:t})}_handleQueue(){for(const e of this._queue.values())this._handleDirectory(e.directory,e.base)}_handleDirectory(e,t){try{const r=this._scandir(e,this._settings.fsScandirSettings);for(const e of r)this._handleEntry(e,t)}catch(e){this._handleError(e)}}_handleError(e){if(o.isFatalError(this._settings,e))throw e}_handleEntry(e,t){const r=e.path;void 0!==t&&(e.path=o.joinPathSegments(t,e.name,this._settings.pathSegmentSeparator)),o.isAppliedFilter(this._settings.entryFilter,e)&&this._pushToStorage(e),e.dirent.isDirectory()&&o.isAppliedFilter(this._settings.deepFilter,e)&&this._pushToQueue(r,e.path)}_pushToStorage(e){this._storage.add(e)}}t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(53);t.default=class{constructor(e={}){this._options=e,this.basePath=this._getValue(this._options.basePath,void 0),this.concurrency=this._getValue(this._options.concurrency,1/0),this.deepFilter=this._getValue(this._options.deepFilter,null),this.entryFilter=this._getValue(this._options.entryFilter,null),this.errorFilter=this._getValue(this._options.errorFilter,null),this.pathSegmentSeparator=this._getValue(this._options.pathSegmentSeparator,n.sep),this.fsScandirSettings=new o.Settings({followSymbolicLinks:this._options.followSymbolicLinks,fs:this._options.fs,pathSegmentSeparator:this._options.pathSegmentSeparator,stats:this._options.stats,throwErrorOnBrokenSymbolicLink:this._options.throwErrorOnBrokenSymbolicLink})}_getValue(e,t){return void 0===e?t:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(17),o=r(169);t.default=class{constructor(e,t){this._settings=e,this._micromatchOptions=t}getFilter(e,t,r){const n=this._getMatcher(t),o=this._getNegativePatternsRe(r);return t=>this._filter(e,t,n,o)}_getMatcher(e){return new o.default(e,this._settings,this._micromatchOptions)}_getNegativePatternsRe(e){const t=e.filter(n.pattern.isAffectDepthOfReadingPattern);return n.pattern.convertPatternsToRe(t,this._micromatchOptions)}_filter(e,t,r,o){if(this._isSkippedByDeep(e,t.path))return!1;if(this._isSkippedSymbolicLink(t))return!1;const i=n.path.removeLeadingDotSegment(t.path);return!this._isSkippedByPositivePatterns(i,r)&&this._isSkippedByNegativePatterns(i,o)}_isSkippedByDeep(e,t){return this._settings.deep!==1/0&&this._getEntryLevel(e,t)>=this._settings.deep}_getEntryLevel(e,t){const r=t.split("/").length;if(""===e)return r;return r-e.split("/").length}_isSkippedSymbolicLink(e){return!this._settings.followSymbolicLinks&&e.dirent.isSymbolicLink()}_isSkippedByPositivePatterns(e,t){return!this._settings.baseNameMatch&&!t.match(e)}_isSkippedByNegativePatterns(e,t){return!n.pattern.matchAny(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(170);class o extends n.default{match(e){const t=e.split("/"),r=t.length,n=this._storage.filter(e=>!e.complete||e.segments.length>r);for(const e of n){const n=e.sections[0];if(!e.complete&&r>n.length)return!0;if(t.every((t,r)=>{const n=e.segments[r];return!(!n.dynamic||!n.patternRe.test(t))||!n.dynamic&&n.pattern===t}))return!0}return!1}}t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(17);t.default=class{constructor(e,t,r){this._patterns=e,this._settings=t,this._micromatchOptions=r,this._storage=[],this._fillStorage()}_fillStorage(){const e=n.pattern.expandPatternsWithBraceExpansion(this._patterns);for(const t of e){const e=this._getPatternSegments(t),r=this._splitSegmentsIntoSections(e);this._storage.push({complete:r.length<=1,pattern:t,segments:e,sections:r})}}_getPatternSegments(e){return n.pattern.getPatternParts(e,this._micromatchOptions).map(e=>n.pattern.isDynamicPattern(e,this._settings)?{dynamic:!0,pattern:e,patternRe:n.pattern.makeRe(e,this._micromatchOptions)}:{dynamic:!1,pattern:e})}_splitSegmentsIntoSections(e){return n.array.splitWhen(e,e=>e.dynamic&&n.pattern.hasGlobStar(e.pattern))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(17);t.default=class{constructor(e,t){this._settings=e,this._micromatchOptions=t,this.index=new Map}getFilter(e,t){const r=n.pattern.convertPatternsToRe(e,this._micromatchOptions),o=n.pattern.convertPatternsToRe(t,this._micromatchOptions);return e=>this._filter(e,r,o)}_filter(e,t,r){if(this._settings.unique&&this._isDuplicateEntry(e))return!1;if(this._onlyFileFilter(e)||this._onlyDirectoryFilter(e))return!1;if(this._isSkippedByAbsoluteNegativePatterns(e.path,r))return!1;const n=this._settings.baseNameMatch?e.name:e.path,o=this._isMatchToPatterns(n,t)&&!this._isMatchToPatterns(e.path,r);return this._settings.unique&&o&&this._createIndexRecord(e),o}_isDuplicateEntry(e){return this.index.has(e.path)}_createIndexRecord(e){this.index.set(e.path,void 0)}_onlyFileFilter(e){return this._settings.onlyFiles&&!e.dirent.isFile()}_onlyDirectoryFilter(e){return this._settings.onlyDirectories&&!e.dirent.isDirectory()}_isSkippedByAbsoluteNegativePatterns(e,t){if(!this._settings.absolute)return!1;const r=n.path.makeAbsolute(this._settings.cwd,e);return n.pattern.matchAny(r,t)}_isMatchToPatterns(e,t){const r=n.path.removeLeadingDotSegment(e);return n.pattern.matchAny(r,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(17);t.default=class{constructor(e){this._settings=e}getFilter(){return e=>this._isNonFatalError(e)}_isNonFatalError(e){return n.errno.isEnoentCodeError(e)||this._settings.suppressErrors}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(17);t.default=class{constructor(e){this._settings=e}getTransformer(){return e=>this._transform(e)}_transform(e){let t=e.path;return this._settings.absolute&&(t=n.path.makeAbsolute(this._settings.cwd,t),t=n.path.unixify(t)),this._settings.markDirectories&&e.dirent.isDirectory()&&(t+="/"),this._settings.objectMode?Object.assign(Object.assign({},e),{path:t}):t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(21),o=r(76),i=r(55);class a extends i.default{constructor(){super(...arguments),this._reader=new o.default(this._settings)}read(e){const t=this._getRootDirectory(e),r=this._getReaderOptions(e),o=this.api(t,e,r),i=new n.Readable({objectMode:!0,read:()=>{}});return o.once("error",e=>i.emit("error",e)).on("data",e=>i.emit("data",r.transform(e))).once("end",()=>i.emit("end")),i.once("close",()=>o.destroy()),i}api(e,t,r){return t.dynamic?this._reader.dynamic(e,r):this._reader.static(t.patterns,r)}}t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(176),o=r(55);class i extends o.default{constructor(){super(...arguments),this._reader=new n.default(this._settings)}read(e){const t=this._getRootDirectory(e),r=this._getReaderOptions(e);return this.api(t,e,r).map(r.transform)}api(e,t,r){return t.dynamic?this._reader.dynamic(e,r):this._reader.static(t.patterns,r)}}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),o=r(77),i=r(83);class a extends i.default{constructor(){super(...arguments),this._walkSync=o.walkSync,this._statSync=n.statSync}dynamic(e,t){return this._walkSync(e,t)}static(e,t){const r=[];for(const n of e){const e=this._getFullEntryPath(n),o=this._getEntry(e,n,t);null!==o&&t.entryFilter(o)&&r.push(o)}return r}_getEntry(e,t,r){try{const r=this._getStat(e);return this._makeEntry(r,t)}catch(e){if(r.errorFilter(e))return null;throw e}}_getStat(e){return this._statSync(e,this._fsStatSettings)}}t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_FILE_SYSTEM_ADAPTER=void 0;const n=r(4),o=r(9),i=Math.max(o.cpus().length,1);t.DEFAULT_FILE_SYSTEM_ADAPTER={lstat:n.lstat,lstatSync:n.lstatSync,stat:n.stat,statSync:n.statSync,readdir:n.readdir,readdirSync:n.readdirSync};t.default=class{constructor(e={}){this._options=e,this.absolute=this._getValue(this._options.absolute,!1),this.baseNameMatch=this._getValue(this._options.baseNameMatch,!1),this.braceExpansion=this._getValue(this._options.braceExpansion,!0),this.caseSensitiveMatch=this._getValue(this._options.caseSensitiveMatch,!0),this.concurrency=this._getValue(this._options.concurrency,i),this.cwd=this._getValue(this._options.cwd,process.cwd()),this.deep=this._getValue(this._options.deep,1/0),this.dot=this._getValue(this._options.dot,!1),this.extglob=this._getValue(this._options.extglob,!0),this.followSymbolicLinks=this._getValue(this._options.followSymbolicLinks,!0),this.fs=this._getFileSystemMethods(this._options.fs),this.globstar=this._getValue(this._options.globstar,!0),this.ignore=this._getValue(this._options.ignore,[]),this.markDirectories=this._getValue(this._options.markDirectories,!1),this.objectMode=this._getValue(this._options.objectMode,!1),this.onlyDirectories=this._getValue(this._options.onlyDirectories,!1),this.onlyFiles=this._getValue(this._options.onlyFiles,!0),this.stats=this._getValue(this._options.stats,!1),this.suppressErrors=this._getValue(this._options.suppressErrors,!1),this.throwErrorOnBrokenSymbolicLink=this._getValue(this._options.throwErrorOnBrokenSymbolicLink,!1),this.unique=this._getValue(this._options.unique,!0),this.onlyDirectories&&(this.onlyFiles=!1),this.stats&&(this.objectMode=!0)}_getValue(e,t){return void 0===e?t:e}_getFileSystemMethods(e={}){return Object.assign(Object.assign({},t.DEFAULT_FILE_SYSTEM_ADAPTER),e)}}},function(e,t,r){"use strict";e.exports=function(){const e=[].slice.call(arguments).filter(e=>e),t=e.shift();return e.forEach(e=>{Object.keys(e).forEach(r=>{t[r]=e[r]})}),t}},function(e,t,r){var n=r(85),o=process.cwd,i=null,a=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return i||(i=o.call(process)),i};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var s=process.chdir;process.chdir=function(e){i=null,s.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,s)}e.exports=function(e){n.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,r,o){e.open(t,n.O_WRONLY|n.O_SYMLINK,r,(function(t,n){t?o&&o(t):e.fchmod(n,r,(function(t){e.close(n,(function(e){o&&o(t||e)}))}))}))},e.lchmodSync=function(t,r){var o,i=e.openSync(t,n.O_WRONLY|n.O_SYMLINK,r),a=!0;try{o=e.fchmodSync(i,r),a=!1}finally{if(a)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return o}}(e);e.lutimes||function(e){n.hasOwnProperty("O_SYMLINK")?(e.lutimes=function(t,r,o,i){e.open(t,n.O_SYMLINK,(function(t,n){t?i&&i(t):e.futimes(n,r,o,(function(t){e.close(n,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,r,o){var i,a=e.openSync(t,n.O_SYMLINK),s=!0;try{i=e.futimesSync(a,r,o),s=!1}finally{if(s)try{e.closeSync(a)}catch(e){}else e.closeSync(a)}return i}):(e.lutimes=function(e,t,r,n){n&&process.nextTick(n)},e.lutimesSync=function(){})}(e);e.chown=i(e.chown),e.fchown=i(e.fchown),e.lchown=i(e.lchown),e.chmod=r(e.chmod),e.fchmod=r(e.fchmod),e.lchmod=r(e.lchmod),e.chownSync=s(e.chownSync),e.fchownSync=s(e.fchownSync),e.lchownSync=s(e.lchownSync),e.chmodSync=o(e.chmodSync),e.fchmodSync=o(e.fchmodSync),e.lchmodSync=o(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=l(e.statSync),e.fstatSync=l(e.fstatSync),e.lstatSync=l(e.lstatSync),e.lchmod||(e.lchmod=function(e,t,r){r&&process.nextTick(r)},e.lchmodSync=function(){});e.lchown||(e.lchown=function(e,t,r,n){n&&process.nextTick(n)},e.lchownSync=function(){});"win32"===a&&(e.rename=(t=e.rename,function(r,n,o){var i=Date.now(),a=0;t(r,n,(function s(c){if(c&&("EACCES"===c.code||"EPERM"===c.code)&&Date.now()-i<6e4)return setTimeout((function(){e.stat(n,(function(e,i){e&&"ENOENT"===e.code?t(r,n,s):o(c)}))}),a),void(a<100&&(a+=10));o&&o(c)}))}));var t;function r(t){return t?function(r,n,o){return t.call(e,r,n,(function(e){u(e)&&(e=null),o&&o.apply(this,arguments)}))}:t}function o(t){return t?function(r,n){try{return t.call(e,r,n)}catch(e){if(!u(e))throw e}}:t}function i(t){return t?function(r,n,o,i){return t.call(e,r,n,o,(function(e){u(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function s(t){return t?function(r,n,o){try{return t.call(e,r,n,o)}catch(e){if(!u(e))throw e}}:t}function c(t){return t?function(r,n,o){function i(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),o&&o.apply(this,arguments)}return"function"==typeof n&&(o=n,n=null),n?t.call(e,r,n,i):t.call(e,r,i)}:t}function l(t){return t?function(r,n){var o=n?t.call(e,r,n):t.call(e,r);return o.uid<0&&(o.uid+=4294967296),o.gid<0&&(o.gid+=4294967296),o}:t}function u(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}e.read=function(t){function r(r,n,o,i,a,s){var c;if(s&&"function"==typeof s){var l=0;c=function(u,p,d){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,r,n,o,i,a,c);s.apply(this,arguments)}}return t.call(e,r,n,o,i,a,c)}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.read),e.readSync=(p=e.readSync,function(t,r,n,o,i){for(var a=0;;)try{return p.call(e,t,r,n,o,i)}catch(e){if("EAGAIN"===e.code&&a<10){a++;continue}throw e}});var p}},function(e,t,r){var n=r(21).Stream;e.exports=function(e){return{ReadStream:function t(r,o){if(!(this instanceof t))return new t(r,o);n.call(this);var i=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,o=o||{};for(var a=Object.keys(o),s=0,c=a.length;s<c;s++){var l=a[s];this[l]=o[l]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick((function(){i._read()}));e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()}))},WriteStream:function t(r,o){if(!(this instanceof t))return new t(r,o);n.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,o=o||{};for(var i=Object.keys(o),a=0,s=i.length;a<s;a++){var c=i[a];this[c]=o[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},function(e,t,r){"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:n(e)};else t=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})),t};var n=Object.getPrototypeOf||function(e){return e.__proto__}},function(e,t,r){const n=r(10).fromCallback;e.exports={copy:n(r(86))}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(87).invalidWin32Path,a=parseInt("0777",8);e.exports=function e(t,r,s,c){if("function"==typeof r?(s=r,r={}):r&&"object"==typeof r||(r={mode:r}),"win32"===process.platform&&i(t)){const e=new Error(t+" contains invalid WIN32 path characters.");return e.code="EINVAL",s(e)}let l=r.mode;const u=r.fs||n;void 0===l&&(l=a&~process.umask()),c||(c=null),s=s||function(){},t=o.resolve(t),u.mkdir(t,l,n=>{if(!n)return s(null,c=c||t);switch(n.code){case"ENOENT":if(o.dirname(t)===t)return s(n);e(o.dirname(t),r,(n,o)=>{n?s(n,o):e(t,r,s,o)});break;default:u.stat(t,(e,t)=>{e||!t.isDirectory()?s(n,c):s(null,c)})}})}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(87).invalidWin32Path,a=parseInt("0777",8);e.exports=function e(t,r,s){r&&"object"==typeof r||(r={mode:r});let c=r.mode;const l=r.fs||n;if("win32"===process.platform&&i(t)){const e=new Error(t+" contains invalid WIN32 path characters.");throw e.code="EINVAL",e}void 0===c&&(c=a&~process.umask()),s||(s=null),t=o.resolve(t);try{l.mkdirSync(t,c),s=s||t}catch(n){switch(n.code){case"ENOENT":if(o.dirname(t)===t)throw n;s=e(o.dirname(t),r,s),e(t,r,s);break;default:let i;try{i=l.statSync(t)}catch(e){throw n}if(!i.isDirectory())throw n}}return s}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(11).mkdirsSync,a=r(88).utimesMillisSync,s=Symbol("notExist"),c=Symbol("existsReg");function l(e,t,r){if(!r.filter||r.filter(e,t))return function(e,t,r){const i=(r.dereference?n.statSync:n.lstatSync)(e);if(i.isDirectory())return function(e,t,r,o){const i=h(r);if(i===s){if(f(t,r))throw new Error(`Cannot copy '${t}' to a subdirectory of itself, '${r}'.`);return function(e,t,r,o){return n.mkdirSync(r,e.mode),n.chmodSync(r,e.mode),d(t,r,o)}(e,t,r,o)}if(i===c){if(f(t,r))throw new Error(`Cannot copy '${t}' to a subdirectory of itself, '${r}'.`);return function(e,t,r){if(!n.statSync(t).isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);return d(e,t,r)}(t,r,o)}if(t===i)return;return d(t,r,o)}(i,e,t,r);if(i.isFile()||i.isCharacterDevice()||i.isBlockDevice())return function(e,t,r,n){const o=h(r);if(o===s)return p(e,t,r,n);if(o===c)return u(e,t,r,n);if(t===o)return;return u(e,t,r,n)}(i,e,t,r);if(i.isSymbolicLink())return function(e,t,r){let i=n.readlinkSync(e);r.dereference&&(i=o.resolve(process.cwd(),i));let a=h(t);if(a===s||a===c)return n.symlinkSync(i,t);if(r.dereference&&(a=o.resolve(process.cwd(),a)),a===i)return;if(n.statSync(t).isDirectory()&&f(a,i))throw new Error(`Cannot overwrite '${a}' with '${i}'.`);return function(e,t){return n.unlinkSync(t),n.symlinkSync(e,t)}(i,t)}(e,t,r)}(e,t,r)}function u(e,t,r,o){if(o.overwrite)return n.unlinkSync(r),p(e,t,r,o);if(o.errorOnExist)throw new Error(`'${r}' already exists`)}function p(e,t,o,i){return"function"==typeof n.copyFileSync?(n.copyFileSync(t,o),n.chmodSync(o,e.mode),i.preserveTimestamps?a(o,e.atime,e.mtime):void 0):function(e,t,o,i){const a=r(90)(65536),s=n.openSync(t,"r"),c=n.openSync(o,"w",e.mode);let l=1,u=0;for(;l>0;)l=n.readSync(s,a,0,65536,u),n.writeSync(c,a,0,l),u+=l;i.preserveTimestamps&&n.futimesSync(c,e.atime,e.mtime);n.closeSync(s),n.closeSync(c)}(e,t,o,i)}function d(e,t,r){n.readdirSync(e).forEach(n=>{l(o.join(e,n),o.join(t,n),r)})}function h(e){let t;try{t=n.readlinkSync(e)}catch(e){if("ENOENT"===e.code)return s;if("EINVAL"===e.code||"UNKNOWN"===e.code)return c;throw e}return t}function f(e,t){const r=t.split(o.dirname(e)+o.sep)[1];if(r){const n=r.split(o.sep)[0];return!!n&&(e!==t&&t.indexOf(e)>-1&&n===o.basename(e))}return!1}e.exports=function(e,t,r){if("function"==typeof r&&(r={filter:r}),(r=r||{}).clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&console.warn("fs-extra: Using the preserveTimestamps option in 32-bit node is not recommended;\n\n    see https://github.com/jprichardson/node-fs-extra/issues/269"),(e=o.resolve(e))===(t=o.resolve(t)))throw new Error("Source and destination must not be the same.");if(r.filter&&!r.filter(e,t))return;const a=o.dirname(t);return n.existsSync(a)||i(a),l(e,t,r)}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(26),a="win32"===process.platform;function s(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(t=>{e[t]=e[t]||n[t],e[t+="Sync"]=e[t]||n[t]}),e.maxBusyTries=e.maxBusyTries||3}function c(e,t,r){let n=0;"function"==typeof t&&(r=t,t={}),i(e,"rimraf: missing path"),i.equal(typeof e,"string","rimraf: path should be a string"),i.equal(typeof r,"function","rimraf: callback function required"),i(t,"rimraf: invalid options argument provided"),i.equal(typeof t,"object","rimraf: options should be object"),s(t),l(e,t,(function o(i){if(i){if(("EBUSY"===i.code||"ENOTEMPTY"===i.code||"EPERM"===i.code)&&n<t.maxBusyTries){return n++,setTimeout(()=>l(e,t,o),100*n)}"ENOENT"===i.code&&(i=null)}r(i)}))}function l(e,t,r){i(e),i(t),i("function"==typeof r),t.lstat(e,(n,o)=>n&&"ENOENT"===n.code?r(null):n&&"EPERM"===n.code&&a?u(e,t,n,r):o&&o.isDirectory()?d(e,t,n,r):void t.unlink(e,n=>{if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return a?u(e,t,n,r):d(e,t,n,r);if("EISDIR"===n.code)return d(e,t,n,r)}return r(n)}))}function u(e,t,r,n){i(e),i(t),i("function"==typeof n),r&&i(r instanceof Error),t.chmod(e,438,o=>{o?n("ENOENT"===o.code?null:r):t.stat(e,(o,i)=>{o?n("ENOENT"===o.code?null:r):i.isDirectory()?d(e,t,r,n):t.unlink(e,n)})})}function p(e,t,r){let n;i(e),i(t),r&&i(r instanceof Error);try{t.chmodSync(e,438)}catch(e){if("ENOENT"===e.code)return;throw r}try{n=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw r}n.isDirectory()?f(e,t,r):t.unlinkSync(e)}function d(e,t,r,n){i(e),i(t),r&&i(r instanceof Error),i("function"==typeof n),t.rmdir(e,a=>{!a||"ENOTEMPTY"!==a.code&&"EEXIST"!==a.code&&"EPERM"!==a.code?a&&"ENOTDIR"===a.code?n(r):n(a):function(e,t,r){i(e),i(t),i("function"==typeof r),t.readdir(e,(n,i)=>{if(n)return r(n);let a,s=i.length;if(0===s)return t.rmdir(e,r);i.forEach(n=>{c(o.join(e,n),t,n=>{if(!a)return n?r(a=n):void(0==--s&&t.rmdir(e,r))})})})}(e,t,n)})}function h(e,t){let r;s(t=t||{}),i(e,"rimraf: missing path"),i.equal(typeof e,"string","rimraf: path should be a string"),i(t,"rimraf: missing options"),i.equal(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&a&&p(e,t,r)}try{r&&r.isDirectory()?f(e,t,null):t.unlinkSync(e)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return a?p(e,t,r):f(e,t,r);if("EISDIR"!==r.code)throw r;f(e,t,r)}}function f(e,t,r){i(e),i(t),r&&i(r instanceof Error);try{t.rmdirSync(e)}catch(n){if("ENOTDIR"===n.code)throw r;if("ENOTEMPTY"===n.code||"EEXIST"===n.code||"EPERM"===n.code)!function(e,t){i(e),i(t),t.readdirSync(e).forEach(r=>h(o.join(e,r),t));const r=a?100:1;let n=0;for(;;){let o=!0;try{const i=t.rmdirSync(e,t);return o=!1,i}finally{if(++n<r&&o)continue}}}(e,t);else if("ENOENT"!==n.code)throw n}}e.exports=c,c.sync=h},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(56);o.outputJson=n(r(189)),o.outputJsonSync=r(190),o.outputJSON=o.outputJson,o.outputJSONSync=o.outputJsonSync,o.writeJSON=o.writeJson,o.writeJSONSync=o.writeJsonSync,o.readJSON=o.readJson,o.readJSONSync=o.readJsonSync,e.exports=o},function(e,t,r){var n;try{n=r(6)}catch(e){n=r(4)}function o(e,t){var r,n="\n";return"object"==typeof t&&null!==t&&(t.spaces&&(r=t.spaces),t.EOL&&(n=t.EOL)),JSON.stringify(e,t?t.replacer:null,r).replace(/\n/g,n)+n}function i(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e=e.replace(/^\uFEFF/,"")}var a={readFile:function(e,t,r){null==r&&(r=t,t={}),"string"==typeof t&&(t={encoding:t});var o=(t=t||{}).fs||n,a=!0;"throws"in t&&(a=t.throws),o.readFile(e,t,(function(n,o){if(n)return r(n);var s;o=i(o);try{s=JSON.parse(o,t?t.reviver:null)}catch(t){return a?(t.message=e+": "+t.message,r(t)):r(null,null)}r(null,s)}))},readFileSync:function(e,t){"string"==typeof(t=t||{})&&(t={encoding:t});var r=t.fs||n,o=!0;"throws"in t&&(o=t.throws);try{var a=r.readFileSync(e,t);return a=i(a),JSON.parse(a,t.reviver)}catch(t){if(o)throw t.message=e+": "+t.message,t;return null}},writeFile:function(e,t,r,i){null==i&&(i=r,r={});var a=(r=r||{}).fs||n,s="";try{s=o(t,r)}catch(e){return void(i&&i(e,null))}a.writeFile(e,s,r,i)},writeFileSync:function(e,t,r){var i=(r=r||{}).fs||n,a=o(t,r);return i.writeFileSync(e,a,r)}};e.exports=a},function(e,t,r){"use strict";const n=r(0),o=r(11),i=r(18).pathExists,a=r(56);e.exports=function(e,t,r,s){"function"==typeof r&&(s=r,r={});const c=n.dirname(e);i(c,(n,i)=>n?s(n):i?a.writeJson(e,t,r,s):void o.mkdirs(c,n=>{if(n)return s(n);a.writeJson(e,t,r,s)}))}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(11),a=r(56);e.exports=function(e,t,r){const s=o.dirname(e);n.existsSync(s)||i.mkdirsSync(s),a.writeJsonSync(e,t,r)}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(6),i=r(86),a=r(0),s=r(36).remove,c=r(11).mkdirs;function l(e,t,r,n){o.stat(e,(i,a)=>{if(i)return n(i);a.isDirectory()?u(e,t,r,n):function(e,t,r,n){const i=r?"w":"wx",a=o.createReadStream(e),s=o.createWriteStream(t,{flags:i});function c(){o.unlink(e,n)}a.on("error",i=>{a.destroy(),s.destroy(),s.removeListener("close",c),o.unlink(t,()=>{"EISDIR"===i.code||"EPERM"===i.code?u(e,t,r,n):n(i)})}),s.on("error",e=>{a.destroy(),s.destroy(),s.removeListener("close",c),n(e)}),s.once("close",c),a.pipe(s)}(e,t,r,n)})}function u(e,t,r,n){const o={overwrite:!1};function a(){i(e,t,o,t=>{if(t)return n(t);s(e,n)})}r?s(t,e=>{if(e)return n(e);a()}):a()}e.exports={move:n((function e(t,r,n,i){"function"==typeof n&&(i=n,n={});const u=n.overwrite||n.clobber||!1;!function(e,t,r){o.stat(e,(n,o)=>{if(n)return r(n);if(o.isDirectory()){const n=t.split(a.dirname(e)+a.sep)[1];if(n){const o=n.split(a.sep)[0];return r(null,o?e!==t&&t.indexOf(e)>-1&&o===a.basename(e):!1)}return r(null,!1)}return r(null,!1)})}(t,r,(p,d)=>p?i(p):d?i(new Error(`Cannot move '${t}' to a subdirectory of itself, '${r}'.`)):void c(a.dirname(r),c=>{if(c)return i(c);a.resolve(t)===a.resolve(r)?o.access(t,i):u?o.rename(t,r,o=>{if(!o)return i();if("ENOTEMPTY"!==o.code&&"EEXIST"!==o.code){if("EPERM"!==o.code)return"EXDEV"!==o.code?i(o):void l(t,r,u,i);setTimeout(()=>{s(r,o=>{if(o)return i(o);n.overwrite=!1,e(t,r,n,i)})},200)}else s(r,o=>{if(o)return i(o);n.overwrite=!1,e(t,r,n,i)})}):o.link(t,r,e=>e?"EXDEV"===e.code||"EISDIR"===e.code||"EPERM"===e.code||"ENOTSUP"===e.code?l(t,r,u,i):i(e):o.unlink(t,i))}))}))}},function(e,t,r){"use strict";const n=r(6),o=r(0),i=r(89).copySync,a=r(36).removeSync,s=r(11).mkdirsSync,c=r(90);function l(e,t,r){return n.statSync(e).isDirectory()?function(e,t,r){const n={overwrite:!1};r?(a(t),o()):o();function o(){return i(e,t,n),a(e)}}(e,t,r):function(e,t,r){const o=c(65536),i=r?"w":"wx",a=n.openSync(e,"r"),s=n.fstatSync(a),l=n.openSync(t,i,s.mode);let u=1,p=0;for(;u>0;)u=n.readSync(a,o,0,65536,p),n.writeSync(l,o,0,u),p+=u;return n.closeSync(a),n.closeSync(l),n.unlinkSync(e)}(e,t,r)}e.exports={moveSync:function e(t,r,i){const c=(i=i||{}).overwrite||i.clobber||!1;if(t=o.resolve(t),r=o.resolve(r),t===r)return n.accessSync(t);if(function(e,t){try{return n.statSync(e).isDirectory()&&e!==t&&t.indexOf(e)>-1&&t.split(o.dirname(e)+o.sep)[1].split(o.sep)[0]===o.basename(e)}catch(e){return!1}}(t,r))throw new Error(`Cannot move '${t}' into itself '${r}'.`);s(o.dirname(r)),function(){if(c)try{n.renameSync(t,r)}catch(n){if("ENOTEMPTY"===n.code||"EEXIST"===n.code||"EPERM"===n.code)return a(r),i.overwrite=!1,e(t,r,i);if("EXDEV"!==n.code)throw n;return l(t,r,c)}else try{n.linkSync(t,r),n.unlinkSync(t)}catch(e){if("EXDEV"===e.code||"EISDIR"===e.code||"EPERM"===e.code||"ENOTSUP"===e.code)return l(t,r,c);throw e}}()}}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(4),i=r(0),a=r(11),s=r(36),c=n((function(e,t){t=t||function(){},o.readdir(e,(r,n)=>{if(r)return a.mkdirs(e,t);n=n.map(t=>i.join(e,t)),function e(){const r=n.pop();if(!r)return t();s.remove(r,r=>{if(r)return t(r);e()})}()})}));function l(e){let t;try{t=o.readdirSync(e)}catch(t){return a.mkdirsSync(e)}t.forEach(t=>{t=i.join(e,t),s.removeSync(t)})}e.exports={emptyDirSync:l,emptydirSync:l,emptyDir:c,emptydir:c}},function(e,t,r){"use strict";const n=r(195),o=r(196),i=r(197);e.exports={createFile:n.createFile,createFileSync:n.createFileSync,ensureFile:n.createFile,ensureFileSync:n.createFileSync,createLink:o.createLink,createLinkSync:o.createLinkSync,ensureLink:o.createLink,ensureLinkSync:o.createLinkSync,createSymlink:i.createSymlink,createSymlinkSync:i.createSymlinkSync,ensureSymlink:i.createSymlink,ensureSymlinkSync:i.createSymlinkSync}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(0),i=r(6),a=r(11),s=r(18).pathExists;e.exports={createFile:n((function(e,t){function r(){i.writeFile(e,"",e=>{if(e)return t(e);t()})}i.stat(e,(n,i)=>{if(!n&&i.isFile())return t();const c=o.dirname(e);s(c,(e,n)=>e?t(e):n?r():void a.mkdirs(c,e=>{if(e)return t(e);r()}))})})),createFileSync:function(e){let t;try{t=i.statSync(e)}catch(e){}if(t&&t.isFile())return;const r=o.dirname(e);i.existsSync(r)||a.mkdirsSync(r),i.writeFileSync(e,"")}}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(0),i=r(6),a=r(11),s=r(18).pathExists;e.exports={createLink:n((function(e,t,r){function n(e,t){i.link(e,t,e=>{if(e)return r(e);r(null)})}s(t,(c,l)=>c?r(c):l?r(null):void i.lstat(e,(i,c)=>{if(i)return i.message=i.message.replace("lstat","ensureLink"),r(i);const l=o.dirname(t);s(l,(o,i)=>o?r(o):i?n(e,t):void a.mkdirs(l,o=>{if(o)return r(o);n(e,t)}))}))})),createLinkSync:function(e,t,r){if(i.existsSync(t))return;try{i.lstatSync(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const n=o.dirname(t);return i.existsSync(n)||a.mkdirsSync(n),i.linkSync(e,t)}}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(0),i=r(6),a=r(11),s=a.mkdirs,c=a.mkdirsSync,l=r(198),u=l.symlinkPaths,p=l.symlinkPathsSync,d=r(199),h=d.symlinkType,f=d.symlinkTypeSync,m=r(18).pathExists;e.exports={createSymlink:n((function(e,t,r,n){n="function"==typeof r?r:n,r="function"!=typeof r&&r,m(t,(a,c)=>a?n(a):c?n(null):void u(e,t,(a,c)=>{if(a)return n(a);e=c.toDst,h(c.toCwd,r,(r,a)=>{if(r)return n(r);const c=o.dirname(t);m(c,(r,o)=>r?n(r):o?i.symlink(e,t,a,n):void s(c,r=>{if(r)return n(r);i.symlink(e,t,a,n)}))})}))})),createSymlinkSync:function(e,t,r,n){if(n="function"==typeof r?r:n,r="function"!=typeof r&&r,i.existsSync(t))return;const a=p(e,t);e=a.toDst,r=f(a.toCwd,r);const s=o.dirname(t);return i.existsSync(s)||c(s),i.symlinkSync(e,t,r)}}},function(e,t,r){"use strict";const n=r(0),o=r(6),i=r(18).pathExists;e.exports={symlinkPaths:function(e,t,r){if(n.isAbsolute(e))return o.lstat(e,(t,n)=>t?(t.message=t.message.replace("lstat","ensureSymlink"),r(t)):r(null,{toCwd:e,toDst:e}));{const a=n.dirname(t),s=n.join(a,e);return i(s,(t,i)=>t?r(t):i?r(null,{toCwd:s,toDst:e}):o.lstat(e,(t,o)=>t?(t.message=t.message.replace("lstat","ensureSymlink"),r(t)):r(null,{toCwd:e,toDst:n.relative(a,e)})))}},symlinkPathsSync:function(e,t){let r;if(n.isAbsolute(e)){if(r=o.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}{const i=n.dirname(t),a=n.join(i,e);if(r=o.existsSync(a),r)return{toCwd:a,toDst:e};if(r=o.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:n.relative(i,e)}}}}},function(e,t,r){"use strict";const n=r(6);e.exports={symlinkType:function(e,t,r){if(r="function"==typeof t?t:r,t="function"!=typeof t&&t)return r(null,t);n.lstat(e,(e,n)=>{if(e)return r(null,"file");t=n&&n.isDirectory()?"dir":"file",r(null,t)})},symlinkTypeSync:function(e,t){let r;if(t)return t;try{r=n.lstatSync(e)}catch(e){return"file"}return r&&r.isDirectory()?"dir":"file"}}},function(e,t,r){"use strict";const n=r(10).fromCallback,o=r(6),i=r(0),a=r(11),s=r(18).pathExists;e.exports={outputFile:n((function(e,t,r,n){"function"==typeof r&&(n=r,r="utf8");const c=i.dirname(e);s(c,(i,s)=>i?n(i):s?o.writeFile(e,t,r,n):void a.mkdirs(c,i=>{if(i)return n(i);o.writeFile(e,t,r,n)}))})),outputFileSync:function(e,t,r){const n=i.dirname(e);if(o.existsSync(n))return o.writeFileSync.apply(o,arguments);a.mkdirsSync(n),o.writeFileSync.apply(o,arguments)}}},function(e,t,r){const n="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,o=r(0),i=n?";":":",a=r(202),s=e=>Object.assign(new Error("not found: "+e),{code:"ENOENT"}),c=(e,t)=>{const r=t.colon||i,o=e.match(/\//)||n&&e.match(/\\/)?[""]:[...n?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],a=n?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=n?a.split(r):[""];return n&&-1!==e.indexOf(".")&&""!==s[0]&&s.unshift(""),{pathEnv:o,pathExt:s,pathExtExe:a}},l=(e,t,r)=>{"function"==typeof t&&(r=t,t={}),t||(t={});const{pathEnv:n,pathExt:i,pathExtExe:l}=c(e,t),u=[],p=r=>new Promise((i,a)=>{if(r===n.length)return t.all&&u.length?i(u):a(s(e));const c=n[r],l=/^".*"$/.test(c)?c.slice(1,-1):c,p=o.join(l,e),h=!l&&/^\.[\\\/]/.test(e)?e.slice(0,2)+p:p;i(d(h,r,0))}),d=(e,r,n)=>new Promise((o,s)=>{if(n===i.length)return o(p(r+1));const c=i[n];a(e+c,{pathExt:l},(i,a)=>{if(!i&&a){if(!t.all)return o(e+c);u.push(e+c)}return o(d(e,r,n+1))})});return r?p(0).then(e=>r(null,e),r):p(0)};e.exports=l,l.sync=(e,t)=>{t=t||{};const{pathEnv:r,pathExt:n,pathExtExe:i}=c(e,t),l=[];for(let s=0;s<r.length;s++){const c=r[s],u=/^".*"$/.test(c)?c.slice(1,-1):c,p=o.join(u,e),d=!u&&/^\.[\\\/]/.test(e)?e.slice(0,2)+p:p;for(let e=0;e<n.length;e++){const r=d+n[e];try{if(a.sync(r,{pathExt:i})){if(!t.all)return r;l.push(r)}}catch(e){}}}if(t.all&&l.length)return l;if(t.nothrow)return null;throw s(e)}},function(e,t,r){var n;r(4);function o(e,t,r){if("function"==typeof t&&(r=t,t={}),!r){if("function"!=typeof Promise)throw new TypeError("callback not provided");return new Promise((function(r,n){o(e,t||{},(function(e,t){e?n(e):r(t)}))}))}n(e,t||{},(function(e,n){e&&("EACCES"===e.code||t&&t.ignoreErrors)&&(e=null,n=!1),r(e,n)}))}n="win32"===process.platform||global.TESTING_WINDOWS?r(203):r(204),e.exports=o,o.sync=function(e,t){try{return n.sync(e,t||{})}catch(e){if(t&&t.ignoreErrors||"EACCES"===e.code)return!1;throw e}}},function(e,t,r){e.exports=i,i.sync=function(e,t){return o(n.statSync(e),e,t)};var n=r(4);function o(e,t,r){return!(!e.isSymbolicLink()&&!e.isFile())&&function(e,t){var r=void 0!==t.pathExt?t.pathExt:process.env.PATHEXT;if(!r)return!0;if(-1!==(r=r.split(";")).indexOf(""))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}(t,r)}function i(e,t,r){n.stat(e,(function(n,i){r(n,!n&&o(i,e,t))}))}},function(e,t,r){e.exports=o,o.sync=function(e,t){return i(n.statSync(e),t)};var n=r(4);function o(e,t,r){n.stat(e,(function(e,n){r(e,!e&&i(n,t))}))}function i(e,t){return e.isFile()&&function(e,t){var r=e.mode,n=e.uid,o=e.gid,i=void 0!==t.uid?t.uid:process.getuid&&process.getuid(),a=void 0!==t.gid?t.gid:process.getgid&&process.getgid(),s=parseInt("100",8),c=parseInt("010",8),l=parseInt("001",8),u=s|c;return r&l||r&c&&o===a||r&s&&n===i||r&u&&0===i}(e,t)}},function(e){e.exports=JSON.parse('{"name":"sql-database-projects","displayName":"SQL Database Projects","description":"Enables users to develop and publish database schemas for MSSQL Databases","version":"0.14.1","publisher":"Microsoft","preview":true,"engines":{"vscode":"^1.30.1","azdata":">=1.31.0"},"license":"https://raw.githubusercontent.com/Microsoft/azuredatastudio/main/LICENSE.txt","icon":"images/sqlDatabaseProjects.png","aiKey":"AIF-37eefaf0-8022-4671-a3fb-64752724682e","activationEvents":["onCommand:sqlDatabaseProjects.new","onCommand:sqlDatabaseProjects.open","onCommand:sqlDatabaseProjects.createProjectFromDatabase","onCommand:sqlDatabaseProjects.generateProjectFromOpenApiSpec","onCommand:sqlDatabaseProjects.addSqlBinding","workspaceContains:**/*.sqlproj","onView:dataworkspace.views.main"],"main":"./out/extension","repository":{"type":"git","url":"https://github.com/Microsoft/azuredatastudio.git"},"extensionDependencies":["Microsoft.mssql","Microsoft.schema-compare"],"capabilities":{"virtualWorkspaces":false,"untrustedWorkspaces":{"supported":true}},"contributes":{"projects":["sqlproj"],"configuration":[{"title":"%sqlDatabaseProjects.Settings%","properties":{"sqlDatabaseProjects.dotnetSDK Location":{"type":"string","description":"%sqlDatabaseProjects.dotnetInstallLocation%"},"sqlDatabaseProjects.netCoreDoNotAsk":{"type":"boolean","description":"%sqlDatabaseProjects.netCoreDoNotAsk%"},"sqlDatabaseProjects.nodejsDoNotAsk":{"type":"boolean","description":"%sqlDatabaseProjects.nodejsDoNotAsk%"},"sqlDatabaseProjects.autorestSqlVersion":{"type":"string","description":"%sqlDatabaseProjects.autorestSqlVersion%"}}}],"commands":[{"command":"sqlDatabaseProjects.newScript","title":"%sqlDatabaseProjects.newScript%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newPreDeploymentScript","title":"%sqlDatabaseProjects.newPreDeploymentScript%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newPostDeploymentScript","title":"%sqlDatabaseProjects.newPostDeploymentScript%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newTable","title":"%sqlDatabaseProjects.newTable%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newView","title":"%sqlDatabaseProjects.newView%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newExternalStreamingJob","title":"%sqlDatabaseProjects.newExternalStreamingJob%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newStoredProcedure","title":"%sqlDatabaseProjects.newStoredProcedure%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newItem","title":"%sqlDatabaseProjects.newItem%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.newFolder","title":"%sqlDatabaseProjects.newFolder%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.delete","title":"%sqlDatabaseProjects.delete%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.exclude","title":"%sqlDatabaseProjects.exclude%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.build","title":"%sqlDatabaseProjects.build%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.publish","title":"%sqlDatabaseProjects.publish%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.properties","title":"%sqlDatabaseProjects.properties%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.schemaCompare","title":"%sqlDatabaseProjects.schemaCompare%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.createProjectFromDatabase","title":"%sqlDatabaseProjects.createProjectFromDatabase%","category":"%sqlDatabaseProjects.displayName%","icon":"images/databaseProjectToolbar.svg"},{"command":"sqlDatabaseProjects.addDatabaseReference","title":"%sqlDatabaseProjects.addDatabaseReference%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.validateExternalStreamingJob","title":"%sqlDatabaseProjects.validateExternalStreamingJob%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.openContainingFolder","title":"%sqlDatabaseProjects.openContainingFolder%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.editProjectFile","title":"%sqlDatabaseProjects.editProjectFile%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.addSqlBinding","title":"%sqlDatabaseProjects.addSqlBinding%","category":"MS SQL"},{"command":"sqlDatabaseProjects.changeTargetPlatform","title":"%sqlDatabaseProjects.changeTargetPlatform%","category":"%sqlDatabaseProjects.displayName%"},{"command":"sqlDatabaseProjects.generateProjectFromOpenApiSpec","title":"%sqlDatabaseProjects.generateProjectFromOpenApiSpec%","category":"%sqlDatabaseProjects.displayName%"}],"menus":{"view/title":[{"command":"sqlDatabaseProjects.createProjectFromDatabase","when":"view == dataworkspace.views.main","group":"1_currentWorkspace@1"},{"command":"sqlDatabaseProjects.generateProjectFromOpenApiSpec","when":"view == dataworkspace.views.main","group":"1_currentWorkspace@2"}],"commandPalette":[{"command":"sqlDatabaseProjects.newScript","when":"false"},{"command":"sqlDatabaseProjects.newPreDeploymentScript","when":"false"},{"command":"sqlDatabaseProjects.newPostDeploymentScript","when":"false"},{"command":"sqlDatabaseProjects.newTable","when":"false"},{"command":"sqlDatabaseProjects.newView","when":"false"},{"command":"sqlDatabaseProjects.newExternalStreamingJob","when":"false"},{"command":"sqlDatabaseProjects.newStoredProcedure","when":"false"},{"command":"sqlDatabaseProjects.newItem","when":"false"},{"command":"sqlDatabaseProjects.newFolder","when":"false"},{"command":"sqlDatabaseProjects.delete","when":"false"},{"command":"sqlDatabaseProjects.build","when":"false"},{"command":"sqlDatabaseProjects.publish","when":"false"},{"command":"sqlDatabaseProjects.properties","when":"false"},{"command":"sqlDatabaseProjects.schemaCompare","when":"false"},{"command":"sqlDatabaseProjects.createProjectFromDatabase"},{"command":"sqlDatabaseProjects.addDatabaseReference","when":"false"},{"command":"sqlDatabaseProjects.validateExternalStreamingJob","when":"false"},{"command":"sqlDatabaseProjects.openContainingFolder","when":"false"},{"command":"sqlDatabaseProjects.editProjectFile","when":"false"},{"command":"sqlDatabaseProjects.addSqlBinding","when":"editorLangId == csharp && !azdataAvailable && resourceScheme != untitled"},{"command":"sqlDatabaseProjects.exclude","when":"false"},{"command":"sqlDatabaseProjects.changeTargetPlatform","when":"false"}],"view/item/context":[{"command":"sqlDatabaseProjects.build","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project","group":"1_dbProjectsFirst@1"},{"command":"sqlDatabaseProjects.publish","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project","group":"1_dbProjectsFirst@2"},{"command":"sqlDatabaseProjects.schemaCompare","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project && azdataAvailable","group":"1_dbProjectsFirst@3"},{"command":"sqlDatabaseProjects.newItem","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"2_dbProjects_newMain@1"},{"command":"sqlDatabaseProjects.newFolder","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"2_dbProjects_newMain@2"},{"command":"sqlDatabaseProjects.newTable","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@1"},{"command":"sqlDatabaseProjects.newView","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@2"},{"command":"sqlDatabaseProjects.newStoredProcedure","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@3"},{"command":"sqlDatabaseProjects.newExternalStreamingJob","when":"view =~ /^(sqlDatabaseProjectsView|dataworkspace.views.main)$/ && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@4"},{"command":"sqlDatabaseProjects.newScript","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@7"},{"command":"sqlDatabaseProjects.newPreDeploymentScript","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@8"},{"command":"sqlDatabaseProjects.newPostDeploymentScript","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project || viewItem == databaseProject.itemType.folder","group":"3_dbProjects_newItem@9"},{"command":"sqlDatabaseProjects.addDatabaseReference","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.referencesRoot","group":"4_dbProjects_addDatabaseReference"},{"command":"sqlDatabaseProjects.validateExternalStreamingJob","when":"view =~ /^(sqlDatabaseProjectsView|dataworkspace.views.main)$/ && viewItem == databaseProject.itemType.file.externalStreamingJob","group":"5_dbProjects_streamingJob"},{"command":"sqlDatabaseProjects.exclude","when":"view =~ /^(sqlDatabaseProjectsView|dataworkspace.views.main)$/ && viewItem == databaseProject.itemType.folder || viewItem =~ /^databaseProject.itemType.file/","group":"9_dbProjectsLast@1"},{"command":"sqlDatabaseProjects.delete","when":"view =~ /^(sqlDatabaseProjectsView|dataworkspace.views.main)$/ && viewItem == databaseProject.itemType.folder || viewItem =~ /^databaseProject.itemType.file/ || viewItem == databaseProject.itemType.reference","group":"9_dbProjectsLast@2"},{"command":"sqlDatabaseProjects.changeTargetPlatform","when":"view =~ /^(sqlDatabaseProjectsView|dataworkspace.views.main)$/ && viewItem == databaseProject.itemType.project","group":"9_dbProjectsLast@6"},{"command":"sqlDatabaseProjects.editProjectFile","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project","group":"9_dbProjectsLast@7"},{"command":"sqlDatabaseProjects.openContainingFolder","when":"view == dataworkspace.views.main && viewItem == databaseProject.itemType.project","group":"9_dbProjectsLast@8"},{"command":"sqlDatabaseProjects.createProjectFromDatabase","when":"!azdataAvailable && view == objectExplorer && viewItem =~ /^(disconnectedServer|Server|Database)$/","group":"sqldbproj@1"}],"objectExplorer/item/context":[{"command":"sqlDatabaseProjects.createProjectFromDatabase","when":"nodeType =~ /^(Database|Server)$/ && connectionProvider == MSSQL && mssql:engineedition != 11","group":"export"}],"dataExplorer/context":[{"command":"sqlDatabaseProjects.createProjectFromDatabase","when":"nodeType =~ /^(Database|Server)$/ && connectionProvider == MSSQL && mssql:engineedition != 11","group":"export"}],"dashboard/toolbar":[{"command":"sqlDatabaseProjects.createProjectFromDatabase","when":"connectionProvider == \'MSSQL\' && mssql:engineedition != 11"}]}},"dependencies":{"@microsoft/ads-extension-telemetry":"^1.1.5","fast-glob":"^3.2.7","fs-extra":"^5.0.0","jsonc-parser":"^2.3.1","promisify-child-process":"^3.1.1","semver":"^7.3.5","vscode-languageclient":"^5.3.0-next.1","vscode-nls":"^4.1.2","which":"^2.0.2","xml-formatter":"^2.1.0","xmldom":"^0.3.0"},"devDependencies":{"@types/fs-extra":"^5.0.0","@types/mocha":"^5.2.5","@types/sinon":"^9.0.4","@types/which":"^2.0.1","@types/xml-formatter":"^1.1.0","@types/xmldom":"^0.1.29","mocha":"^5.2.0","mocha-junit-reporter":"^1.17.0","mocha-multi-reporters":"^1.1.7","should":"^13.2.1","sinon":"^9.0.2","tslint":"^5.8.0","typemoq":"^2.1.0","vscodetestcover":"^1.1.0"},"__metadata":{"id":"70","publisherDisplayName":"Microsoft","publisherId":"Microsoft"}}')},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),o=r(37),i=r(0),a=r(207),s=r(43),c=r(15),l=r(1),u=r(333),p=r(335),d=r(337);t.default=class{constructor(e){this.context=e,this._outputChannel=n.window.createOutputChannel(l.projectsOutputChannel),this.projectsController=new a.ProjectsController(this._outputChannel),this.netcoreTool=new s.NetCoreTool(this._outputChannel),this.packageHelper=new d.PackageHelper(this._outputChannel)}get extensionContext(){return this.context}get projController(){return this.projectsController}deactivate(){}async activate(){const e=n.workspace.getConfiguration(s.DBProjectConfigurationKey)[s.NetCoreInstallLocationKey];return e&&!n.workspace.getConfiguration(s.DBProjectConfigurationKey)[s.DotnetInstallLocationKey]&&await n.workspace.getConfiguration(s.DBProjectConfigurationKey).update(s.DotnetInstallLocationKey,e,!0),await this.initializeDatabaseProjects(),new u.SqlDatabaseProjectProvider(this.projectsController)}async initializeDatabaseProjects(){n.commands.registerCommand("sqlDatabaseProjects.properties",async e=>n.window.showErrorMessage("Properties not yet implemented: "+e.element.uri.path)),n.commands.registerCommand("sqlDatabaseProjects.build",async e=>this.projectsController.buildProject(e)),n.commands.registerCommand("sqlDatabaseProjects.publish",async e=>this.projectsController.publishProject(e)),n.commands.registerCommand("sqlDatabaseProjects.schemaCompare",async e=>this.projectsController.schemaCompare(e)),n.commands.registerCommand("sqlDatabaseProjects.createProjectFromDatabase",async e=>this.projectsController.createProjectFromDatabase(e)),n.commands.registerCommand("sqlDatabaseProjects.generateProjectFromOpenApiSpec",async()=>this.projectsController.generateProjectFromOpenApiSpec()),n.commands.registerCommand("sqlDatabaseProjects.newScript",async e=>this.projectsController.addItemPromptFromNode(e,o.script)),n.commands.registerCommand("sqlDatabaseProjects.newPreDeploymentScript",async e=>this.projectsController.addItemPromptFromNode(e,o.preDeployScript)),n.commands.registerCommand("sqlDatabaseProjects.newPostDeploymentScript",async e=>this.projectsController.addItemPromptFromNode(e,o.postDeployScript)),n.commands.registerCommand("sqlDatabaseProjects.newTable",async e=>this.projectsController.addItemPromptFromNode(e,o.table)),n.commands.registerCommand("sqlDatabaseProjects.newView",async e=>this.projectsController.addItemPromptFromNode(e,o.view)),n.commands.registerCommand("sqlDatabaseProjects.newStoredProcedure",async e=>this.projectsController.addItemPromptFromNode(e,o.storedProcedure)),n.commands.registerCommand("sqlDatabaseProjects.newExternalStreamingJob",async e=>this.projectsController.addItemPromptFromNode(e,o.externalStreamingJob)),n.commands.registerCommand("sqlDatabaseProjects.newItem",async e=>this.projectsController.addItemPromptFromNode(e)),n.commands.registerCommand("sqlDatabaseProjects.newFolder",async e=>this.projectsController.addFolderPrompt(e)),n.commands.registerCommand("sqlDatabaseProjects.addDatabaseReference",async e=>this.projectsController.addDatabaseReference(e)),n.commands.registerCommand("sqlDatabaseProjects.openContainingFolder",async e=>this.projectsController.openContainingFolder(e)),n.commands.registerCommand("sqlDatabaseProjects.editProjectFile",async e=>this.projectsController.editProjectFile(e)),n.commands.registerCommand("sqlDatabaseProjects.delete",async e=>this.projectsController.delete(e)),n.commands.registerCommand("sqlDatabaseProjects.exclude",async e=>this.projectsController.exclude(e)),n.commands.registerCommand("sqlDatabaseProjects.changeTargetPlatform",async e=>this.projectsController.changeTargetPlatform(e)),n.commands.registerCommand("sqlDatabaseProjects.validateExternalStreamingJob",async e=>this.projectsController.validateExternalStreamingJob(e)),n.commands.registerCommand("sqlDatabaseProjects.addSqlBinding",async e=>p.launchAddSqlBindingQuickpick(e,this.packageHelper)),c.IconPathHelper.setExtensionContext(this.extensionContext),await o.loadTemplates(i.join(this.context.extensionPath,"resources","templates"))}dispose(){this.deactivate()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectsController=t.TaskExecutionMode=void 0;const n=r(1),o=r(9),i=r(0),a=r(3),s=r(92),c=r(37),l=r(2),u=r(4),p=r(93),d=r(108),h=r(111),f=r(112),m=r(43),g=r(326),y=r(117),v=r(118),b=r(113),w=r(119),S=r(27),E=r(15),P=r(327),T=r(121),_=r(328),D=r(329),C=r(330),x=r(331),I=r(332),j=r(42);var N;!function(e){e[e.execute=0]="execute",e[e.script=1]="script",e[e.executeAndScript=2]="executeAndScript"}(N=t.TaskExecutionMode||(t.TaskExecutionMode={}));t.ProjectsController=class{constructor(e){this._outputChannel=e,this.buildInfo=[],this.publishInfo=[],this.projFileWatchers=new Map,this.netCoreTool=new m.NetCoreTool(this._outputChannel),this.buildHelper=new g.BuildHelper,this.deployService=new D.DeployService(this._outputChannel),this.autorestHelper=new C.AutorestHelper(this._outputChannel)}getDashboardPublishData(e){const t=[];for(let r=this.publishInfo.length-1;r>=0;r--)if(this.publishInfo[r].projectFile===e){let e,o;this.publishInfo[r].status===P.Status.success?(e=E.IconPathHelper.success,o=n.Success):this.publishInfo[r].status===P.Status.failed?(e=E.IconPathHelper.error,o=n.Failed):(e=E.IconPathHelper.inProgress,o=n.InProgress);let i=[{text:o,icon:e},this.publishInfo[r].startDate,this.publishInfo[r].timeToCompleteAction,this.publishInfo[r].target,this.publishInfo[r].targetServer,this.publishInfo[r].targetDatabase];t.push(i)}return t}getDashboardBuildData(e){const t=[];for(let r=this.buildInfo.length-1;r>=0;r--)if(this.buildInfo[r].projectFile===e){let e,o;this.buildInfo[r].status===P.Status.success?(e=E.IconPathHelper.success,o=n.Success):this.buildInfo[r].status===P.Status.failed?(e=E.IconPathHelper.error,o=n.Failed):(e=E.IconPathHelper.inProgress,o=n.InProgress);let i=[{text:o,icon:e},this.buildInfo[r].startDate,this.buildInfo[r].timeToCompleteAction,this.buildInfo[r].target];t.push(i)}return t}refreshProjectsTree(e){e.treeDataProvider.notifyTreeDataChanged()}async createNewProject(e){var t;if(S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.createNewProject).withAdditionalProperties({template:e.projectTypeId}).send(),e.projectGuid&&!s.isUUID(e.projectGuid))throw new Error(n.invalidGuid(e.projectGuid));if(e.targetPlatform&&!n.targetPlatformToVersion.get(e.targetPlatform))throw new Error(n.invalidTargetPlatform(e.targetPlatform,Array.from(n.targetPlatformToVersion.keys())));const r={PROJECT_NAME:e.newProjName,PROJECT_GUID:null!==(t=e.projectGuid)&&void 0!==t?t:s.generateUuid().toUpperCase(),PROJECT_DSP:e.targetPlatform?n.targetPlatformToVersion.get(e.targetPlatform):n.defaultDSP};let o=c.macroExpansion(c.newSqlProjectTemplate,r),l=e.newProjName;l.toLowerCase().endsWith(n.sqlprojExtension)||(l+=n.sqlprojExtension);const p=i.join(e.folderUri.fsPath,i.parse(l).name,l);if(await a.exists(p))throw new Error(n.projectAlreadyExists(l,i.parse(p).dir));return await u.promises.mkdir(i.dirname(p),{recursive:!0}),await u.promises.writeFile(p,o),await this.addTemplateFiles(p,e.projectTypeId),p}async buildProject(e){const t=this.getProjectFromContext(e),r=new Date,o=`${r.toLocaleDateString()} ${n.at} ${r.toLocaleTimeString()}`;let i=new P.DashboardData(t.projectFilePath,P.Status.inProgress,t.getProjectTargetVersion(),o);this.buildInfo.push(i),this.buildInfo.length-1==10&&this.buildInfo.shift(),await this.buildHelper.createBuildDirFolder();const s={commandTitle:"Build",workingDirectory:t.projectFolderPath,argument:this.buildHelper.constructBuildArguments(t.projectFilePath,this.buildHelper.extensionBuildDirPath,t.isSdkStyleProject)};try{await this.netCoreTool.runDotnetCommand(s);const e=(new Date).getTime()-r.getTime(),n=this.buildInfo.findIndex(e=>e.startDate===o);return this.buildInfo[n].status=P.Status.success,this.buildInfo[n].timeToCompleteAction=a.timeConversion(e),S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.build).withAdditionalMeasurements({duration:e}).send(),t.dacpacOutputPath}catch(e){const t=(new Date).getTime()-r.getTime(),i=this.buildInfo.findIndex(e=>e.startDate===o);this.buildInfo[i].status=P.Status.failed,this.buildInfo[i].timeToCompleteAction=a.timeConversion(t),S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.build).withAdditionalMeasurements({duration:t}).send();const s=a.getErrorMessage(e);return e instanceof m.DotNetError?console.error(s):l.window.showErrorMessage(n.projBuildFailed(s)),""}}async publishToDockerContainer(e,t){const r=this.getProjectFromContext(e);try{if(t&&t.deploySettings){let e;if(t.localDbSetting&&(a.showInfoMessageWithOutputChannel(n.publishingProjectMessage,this._outputChannel),e=await this.deployService.deploy(t,r),e&&(t.deploySettings.connectionUri=e)),t.deploySettings.connectionUri){const e=await this.publishOrScriptProject(r,t.deploySettings,!0);e&&e.success?(t.localDbSetting&&await this.deployService.getConnection(t.localDbSetting,!0,t.localDbSetting.dbName),l.window.showInformationMessage(n.publishProjectSucceed)):a.showErrorMessageWithOutputChannel(n.publishToContainerFailed,(null==e?void 0:e.errorMessage)||"",this._outputChannel)}else a.showErrorMessageWithOutputChannel(n.publishToContainerFailed,n.deployProjectFailedMessage,this._outputChannel)}}catch(e){a.showErrorMessageWithOutputChannel(n.publishToContainerFailed,e,this._outputChannel)}}async publishProject(e){const t=this.getProjectFromContext(e);if(a.getAzdataApi()){let e=this.getPublishDialog(t);return e.publish=async(e,t)=>this.publishOrScriptProject(e,t,!0),e.publishToContainer=async(e,t)=>this.publishToDockerContainer(e,t),e.generateScript=async(e,t)=>this.publishOrScriptProject(e,t,!1),e.readPublishProfile=async e=>y.readPublishProfile(e),e.openDialog(),e.waitForClose()}this.publishDatabase(t)}async publishDatabase(e){const t=await T.launchPublishTargetOption();if(t)if(t===n.publishToDockerContainer){const t=await _.launchPublishToDockerContainerQuickpick(e);(null==t?void 0:t.deploySettings)&&await this.publishToDockerContainer(e,t)}else{let t=await T.getPublishDatabaseSettings(e);if(t){const r=await l.window.showQuickPick([n.generateScriptButtonText,n.publish],{title:n.chooseAction,ignoreFocusOut:!0});if(!r)return;await this.publishOrScriptProject(e,t,r===n.publish)}}}async publishOrScriptProject(e,t,r){var s;const c={},l={},p=(new Date).getTime(),d=await this.buildProject(e),h=(new Date).getTime();if(l.buildDuration=h-p,c.buildSucceeded=(""!==d).toString(),!d)return void S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.publishProject).withAdditionalProperties(c).withAdditionalMeasurements(l).send();const f=i.join(o.tmpdir(),`${i.parse(d).name}_${(new Date).getTime()}${n.sqlprojExtension}`);await u.promises.copyFile(d,f);const m=await a.getDacFxService();let g;c.profileUsed=(null!==(s=t.profileUsed)&&void 0!==s&&s).toString();const y=new Date,v=y.getTime(),b=`${y.toLocaleDateString()} ${n.at} ${y.toLocaleTimeString()}`;let w=new P.PublishData(e.projectFilePath,P.Status.inProgress,e.getProjectTargetVersion(),b,t.databaseName,t.serverName);this.publishInfo.push(w),this.publishInfo.length-1==10&&this.publishInfo.shift();try{const e=a.getAzdataApi();r?(c.publishAction="deploy",g=e?await m.deployDacpac(f,t.databaseName,!0,t.connectionUri,e.TaskExecutionMode.execute,t.sqlCmdVariables,t.deploymentOptions):await m.deployDacpac(f,t.databaseName,!0,t.connectionUri,N.execute,t.sqlCmdVariables,t.deploymentOptions)):(c.publishAction="generateScript",g=e?await m.generateDeployScript(f,t.databaseName,t.connectionUri,e.TaskExecutionMode.script,t.sqlCmdVariables,t.deploymentOptions):await m.generateDeployScript(f,t.databaseName,t.connectionUri,N.script,t.sqlCmdVariables,t.deploymentOptions))}catch(e){const t=(new Date).getTime(),r=t-v;c.actionDuration=r.toString(),c.totalDuration=(t-p).toString(),S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.publishProject).withAdditionalProperties(c).send();const n=this.publishInfo.findIndex(e=>e.startDate===b);throw this.publishInfo[n].status=P.Status.failed,this.publishInfo[n].timeToCompleteAction=a.timeConversion(r),e}const E=(new Date).getTime(),T=E-v;c.actionDuration=T.toString(),c.totalDuration=(E-p).toString();const _=this.publishInfo.findIndex(e=>e.startDate===b);return this.publishInfo[_].status=g.success?P.Status.success:P.Status.failed,this.publishInfo[_].timeToCompleteAction=a.timeConversion(T),S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.publishProject).withAdditionalProperties(c).send(),g}async schemaCompare(e){try{if(!l.extensions.getExtension(n.schemaCompareExtensionId))throw new Error(n.schemaCompareNotInstalled);{const t=await this.buildProject(e);if(!await a.exists(t))throw new Error(n.buildFailedCannotStartSchemaCompare);S.TelemetryReporter.sendActionEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.projectSchemaCompareCommandInvoked),await l.commands.executeCommand(n.schemaCompareStartCommand,t)}}catch(e){const t={},r=a.getErrorMessage(e);r!==n.buildFailedCannotStartSchemaCompare&&r!==n.schemaCompareNotInstalled||(t.errorMessage=r),S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectController,S.TelemetryActions.projectSchemaCompareCommandInvoked).withAdditionalProperties(t).send(),l.window.showErrorMessage(a.getErrorMessage(e))}}async addFolderPrompt(e){const t=this.getProjectFromContext(e),r=this.getRelativePath(e.element),o=i.join(t.projectFolderPath,r),s=await this.promptForNewObjectName(new c.ProjectScriptType(c.folder,n.folderFriendlyName,""),t,o);if(!s)return;const u=i.join(r,s);try{const r=i.join(o,s);if(await a.exists(r)||this.isReservedFolder(r,t.projectFolderPath))throw new Error(n.folderAlreadyExists(i.parse(r).name));await t.addFolderItem(u),this.refreshProjectsTree(e)}catch(e){l.window.showErrorMessage(a.getErrorMessage(e))}}isReservedFolder(e,t){const r=void 0!==d.reservedProjectFolders.find(t=>t===i.parse(e).name),n=i.parse(e).dir===t;return r&&n}async addItemPromptFromNode(e,t){await this.addItemPrompt(this.getProjectFromContext(e),this.getRelativePath(e.element),t,e.treeDataProvider)}async addItemPrompt(e,t,r,o){var s;if(!r){const e=[];for(const t of c.projectScriptTypes())e.push({label:t.friendlyName});if(!(r=null===(s=await l.window.showQuickPick(e,{canPickMany:!1}))||void 0===s?void 0:s.label))return}const u=c.get(r),p=i.join(e.projectFolderPath,t);let d=await this.promptForNewObjectName(u,e,p,n.sqlFileExtension);if(d=null==d?void 0:d.trim(),!d)return;const h=c.macroExpansion(u.templateScript,{OBJECT_NAME:d}),f=i.join(t,d+n.sqlFileExtension),m={itemType:u.type},g={};u.type===c.preDeployScript?g.numPredeployScripts=e.preDeployScripts.length:u.type===c.postDeployScript&&(g.numPostdeployScripts=e.postDeployScripts.length);try{const t=await e.addScriptItem(f,h,u.type);S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.addItemFromTree).withAdditionalProperties(m).withAdditionalMeasurements(g).send(),await l.commands.executeCommand(n.vscodeOpenCommand,t.fsUri),null==o||o.notifyTreeDataChanged()}catch(e){l.window.showErrorMessage(a.getErrorMessage(e)),S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.addItemFromTree).withAdditionalProperties(m).withAdditionalMeasurements(g).send()}}async exclude(e){const t=e.element,r=this.getProjectFromContext(t),o=this.getFileProjectEntry(r,t);o?(S.TelemetryReporter.sendActionEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.excludeFromProject),await r.exclude(o)):(S.TelemetryReporter.sendErrorEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.excludeFromProject),l.window.showErrorMessage(n.unableToPerformAction(n.excludeAction,t.projectUri.path))),this.refreshProjectsTree(e)}async delete(e){const t=e.element,r=this.getProjectFromContext(t);let o;o=t instanceof b.DatabaseReferenceTreeItem?n.deleteReferenceConfirmation(t.friendlyName):t instanceof h.FolderNode?n.deleteConfirmationContents(t.friendlyName):n.deleteConfirmation(t.friendlyName);if(await l.window.showWarningMessage(o,{modal:!0},n.yesString)!==n.yesString)return;let i=!1;if(t instanceof b.DatabaseReferenceTreeItem){const e=this.getDatabaseReference(r,t);e&&(await r.deleteDatabaseReference(e),i=!0)}else if(t instanceof h.FileNode||h.FolderNode){const e=this.getFileProjectEntry(r,t);e&&(await r.deleteFileFolder(e),i=!0)}i?(S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.deleteObjectFromProject).withAdditionalProperties({objectType:t.constructor.name}).send(),this.refreshProjectsTree(e)):(S.TelemetryReporter.createErrorEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.deleteObjectFromProject).withAdditionalProperties({objectType:t.constructor.name}).send(),l.window.showErrorMessage(n.unableToPerformAction(n.deleteAction,t.projectUri.path)))}getFileProjectEntry(e,t){const r=t.root,n=t||t;if(r&&n){const t=e.files.concat(e.preDeployScripts).concat(e.postDeployScripts).concat(e.noneDeployScripts),o=a.trimChars(a.getPlatformSafeFileEntryPath(a.trimUri(r.fileSystemUri,n.fileSystemUri)),"/");return t.find(e=>a.trimChars(a.getPlatformSafeFileEntryPath(e.relativePath),"/")===o)}return e.files.find(e=>a.getPlatformSafeFileEntryPath(e.relativePath)===a.getPlatformSafeFileEntryPath(a.trimUri(t.root.projectUri,t.projectUri)))}getDatabaseReference(e,t){const r=t.root,n=t;if(r&&n)return e.databaseReferences.find(e=>e.databaseName===n.treeItem.label)}async openContainingFolder(e){const t=this.getProjectFromContext(e);await l.commands.executeCommand(n.revealFileInOsCommand,l.Uri.file(t.projectFilePath))}async editProjectFile(e){const t=this.getProjectFromContext(e);try{await l.commands.executeCommand(n.vscodeOpenCommand,l.Uri.file(t.projectFilePath)),S.TelemetryReporter.sendActionEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.editProjectFile);const r=l.workspace.createFileSystemWatcher(t.projectFilePath);this.projFileWatchers.set(t.projectFilePath,r),r.onDidChange(async()=>{if(await l.window.showInformationMessage(n.reloadProject,n.yesString,n.noString)===n.yesString)return this.reloadProject(e)});const o=l.workspace.onDidCloseTextDocument(e=>{this.projFileWatchers.has(e.uri.fsPath)&&(this.projFileWatchers.get(e.uri.fsPath).dispose(),this.projFileWatchers.delete(e.uri.fsPath),o.dispose())})}catch(e){l.window.showErrorMessage(a.getErrorMessage(e))}}async reloadProject(e){const t=this.getProjectFromContext(e);if(!t)throw new Error(n.invalidProjectReload);await t.readProjFile(),this.refreshProjectsTree(e)}async changeTargetPlatform(e){var t;const r=this.getProjectFromContext(e),o=null===(t=await l.window.showQuickPick(Array.from(n.targetPlatformToVersion.keys()).map(e=>({label:e})),{canPickMany:!1,placeHolder:n.selectTargetPlatform(n.getTargetPlatformFromVersion(r.getProjectTargetVersion()))}))||void 0===t?void 0:t.label;o&&(await r.changeTargetPlatform(n.targetPlatformToVersion.get(o)),l.window.showInformationMessage(n.currentTargetPlatform(r.projectFileName,n.getTargetPlatformFromVersion(r.getProjectTargetVersion()))))}async addDatabaseReference(e){const t=this.getProjectFromContext(e);if(a.getAzdataApi()){const r=this.getAddDatabaseReferenceDialog(t);return r.addReference=async(t,r)=>await this.addDatabaseReferenceCallback(t,r,e),await r.openDialog(),r}{const r=await I.addDatabaseReferenceQuickpick(t);return void(r&&await this.addDatabaseReferenceCallback(t,r,e))}}async addDatabaseReferenceCallback(e,t,r){var o;try{if(void 0!==t.projectName){const r=t,s=await a.getSqlProjectsInWorkspace(),c=await d.Project.openProject(s.filter(e=>i.parse(e.fsPath).name===r.projectName)[0].fsPath),u=i.relative(e.projectFolderPath,null==c?void 0:c.projectFilePath);r.projectRelativePath=l.Uri.file(u),r.projectGuid=null==c?void 0:c.projectGuid;const p=null!==(o=null==c?void 0:c.databaseReferences.filter(e=>e instanceof j.SqlProjectReferenceProjectEntry))&&void 0!==o?o:[];for(let t of p)if(t.projectName===e.projectFileName)return void l.window.showErrorMessage(n.cantAddCircularProjectReference(null==c?void 0:c.projectFileName));await e.addProjectReference(r)}else if(void 0!==t.systemDb)await e.addSystemDatabaseReference(t);else{const r=t;r.dacpacFileLocation=l.Uri.file(i.relative(e.projectFolderPath,r.dacpacFileLocation.fsPath)),await e.addDatabaseReference(r)}this.refreshProjectsTree(r)}catch(e){l.window.showErrorMessage(a.getErrorMessage(e))}}async validateExternalStreamingJob(e){const t=this.getProjectFromContext(e);let r=t.dacpacOutputPath;const o=await a.exists(r),i={preExistingDacpac:o.toString()};o||(r=await this.buildProject(t));const s=(await u.promises.readFile(e.element.fileSystemUri.fsPath)).toString(),c=await a.getDacFxService(),p=(new Date).getTime(),d=await c.validateStreamingJob(r,s),h=(new Date).getTime()-p;return i.success=d.success.toString(),d.success?l.window.showInformationMessage(n.externalStreamingJobValidationPassed):l.window.showErrorMessage(d.errorMessage),S.TelemetryReporter.createActionEvent(S.TelemetryViews.ProjectTree,S.TelemetryActions.runStreamingJobValidation).withAdditionalProperties(i).withAdditionalMeasurements({duration:h}).send(),d}async selectAutorestSpecFile(){if(!await l.window.showQuickPick([n.browseEllipsisWithIcon],{title:n.selectSpecFile,ignoreFocusOut:!0}))return;const e={};e[n.specSelectionText]=n.openApiSpecFileExtensions;let t=await l.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,openLabel:n.selectString,filters:e,title:n.selectSpecFile});return t?t[0].fsPath:void 0}async selectAutorestProjectLocation(e){var t,r;let o=!1,s="",c="",u=await l.window.showQuickPick([n.browseEllipsisWithIcon],{title:n.selectProjectLocation,ignoreFocusOut:!0});if(u){for(;!o;){const p=await l.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,openLabel:n.selectString,defaultUri:null===(r=null===(t=l.workspace.workspaceFolders)||void 0===t?void 0:t[0])||void 0===r?void 0:r.uri,title:n.selectProjectLocation});if(!p)return;if(c=p[0].fsPath,s=i.join(c,e),await a.exists(s)){if(u=await l.window.showQuickPick([n.browseEllipsisWithIcon],{title:n.folderAlreadyExistsChooseNewLocation(s),ignoreFocusOut:!0}),!u)return}else o=!0}return{newProjectFolder:s,outputFolder:c,projectName:e}}}async generateAutorestFiles(e,t){return await u.promises.mkdir(t,{recursive:!0}),l.window.withProgress({location:l.ProgressLocation.Notification,title:n.generatingProjectFromAutorest(i.basename(e)),cancellable:!1},async(r,n)=>this.autorestHelper.generateAutorestFiles(e,t))}async openProjectInWorkspace(e){const t=a.getDataWorkspaceExtensionApi();await t.validateWorkspace(),await t.addProjectsToWorkspace([l.Uri.file(e)]),t.showProjectsView()}async promptForAutorestProjectName(e){let t=await l.window.showInputBox({ignoreFocusOut:!0,prompt:n.autorestProjectName,value:e,validateInput:e=>e.trim()?void 0:n.nameMustNotBeEmpty});if(void 0!==t)return t=t.trim(),t}async generateProjectFromOpenApiSpec(){try{const e=await this.selectAutorestSpecFile();if(!e)return;const t=await this.promptForAutorestProjectName(i.basename(e,i.extname(e)));if(!t)return;const r=await this.selectAutorestProjectLocation(t);if(!r)return;if(!await this.generateAutorestFiles(e,r.newProjectFolder))return;const o=await this.getSqlFileList(r.newProjectFolder);if(!o||0===o.length)return l.window.showInformationMessage(n.noSqlFilesGenerated),void this._outputChannel.show();const a=await this.createNewProject({newProjName:r.projectName,folderUri:l.Uri.file(r.outputFolder),projectTypeId:n.emptySqlDatabaseProjectTypeId}),s=await d.Project.openProject(a);await s.addToProject(o.filter(e=>!e.fsPath.endsWith(n.autorestPostDeploymentScriptName)));const u=this.findPostDeploymentScript(o);return u&&await s.addScriptItem(i.relative(s.projectFolderPath,u.fsPath),void 0,c.postDeployScript),await this.openProjectInWorkspace(a),s}catch(e){return l.window.showErrorMessage(n.generatingProjectFailed(a.getErrorMessage(e))),void this._outputChannel.show()}}findPostDeploymentScript(e){const t=e.filter(e=>e.fsPath.endsWith(n.autorestPostDeploymentScriptName));switch(t.length){case 0:return;case 1:return t[0];default:throw new Error(n.multipleMostDeploymentScripts(t.length))}}async getSqlFileList(e){var t;if(!await a.exists(e))return;const r=await u.promises.readdir(e,{withFileTypes:!0}),o=r.filter(e=>e.isDirectory()).map(t=>i.join(e,t.name)),s=r.filter(e=>!e.isDirectory()&&i.extname(e.name)===n.sqlFileExtension).map(t=>l.Uri.file(i.join(e,t.name)));for(const e of o)s.push(...null!==(t=await this.getSqlFileList(e))&&void 0!==t?t:[]);return s}getPublishDialog(e){return new p.PublishDatabaseDialog(e)}getAddDatabaseReferenceDialog(e){return new v.AddDatabaseReferenceDialog(e)}async addTemplateFiles(e,t){if(t!==n.emptySqlDatabaseProjectTypeId&&""!==e&&t===n.edgeSqlDatabaseProjectTypeId){const t=await d.Project.openProject(e);await this.createFileFromTemplate(t,c.get(c.table),"DataTable.sql",{OBJECT_NAME:"DataTable"}),await this.createFileFromTemplate(t,c.get(c.dataSource),"EdgeHubInputDataSource.sql",{OBJECT_NAME:"EdgeHubInputDataSource",LOCATION:"edgehub://"}),await this.createFileFromTemplate(t,c.get(c.dataSource),"SqlOutputDataSource.sql",{OBJECT_NAME:"SqlOutputDataSource",LOCATION:"sqlserver://tcp:.,1433"}),await this.createFileFromTemplate(t,c.get(c.fileFormat),"StreamFileFormat.sql",{OBJECT_NAME:"StreamFileFormat"}),await this.createFileFromTemplate(t,c.get(c.externalStream),"EdgeHubInputStream.sql",{OBJECT_NAME:"EdgeHubInputStream",DATA_SOURCE_NAME:"EdgeHubInputDataSource",LOCATION:"input",OPTIONS:",\n\tFILE_FORMAT = StreamFileFormat"}),await this.createFileFromTemplate(t,c.get(c.externalStream),"SqlOutputStream.sql",{OBJECT_NAME:"SqlOutputStream",DATA_SOURCE_NAME:"SqlOutputDataSource",LOCATION:"TSQLStreaming.dbo.DataTable",OPTIONS:""}),await this.createFileFromTemplate(t,c.get(c.externalStreamingJob),"EdgeStreamingJob.sql",{OBJECT_NAME:"EdgeStreamingJob"})}}async createFileFromTemplate(e,t,r,n){const o=c.macroExpansion(t.templateScript,n);await e.addScriptItem(r,o,t.type)}getProjectFromContext(e){if("element"in e)return e.element.root.project;if(e instanceof d.Project)return e;if(e.root instanceof f.ProjectRootTreeItem)return e.root.project;throw new Error(n.unexpectedProjectContext(e.projectUri.path))}async promptForNewObjectName(e,t,r,o){const s=e.friendlyName.replace(/\s+/g,"");let c=0;do{c++}while(c<Number.MAX_SAFE_INTEGER&&await a.exists(i.join(r,`${s}${c}${null!=o?o:""}`)));return await l.window.showInputBox({prompt:n.newObjectNamePrompt(e.friendlyName),value:`${s}${c}`,ignoreFocusOut:!0})}getRelativePath(e){return e instanceof h.FolderNode?a.trimUri(e.root.projectUri,e.projectUri):""}async createProjectFromDatabase(e){const t=this.getConnectionProfileFromContext(e);if(a.getAzdataApi()){let e=this.getCreateProjectFromDatabaseDialog(t);return e.createProjectFromDatabaseCallback=async e=>await this.createProjectFromDatabaseCallback(e),await e.openDialog(),e}{if(e){const r=e,n=(await a.getVscodeMssqlApi()).getDatabaseNameFromTreeNode(r);t.database=n}const r=await x.createNewProjectFromDatabaseWithQuickpick(t);return void(r&&await this.createProjectFromDatabaseCallback(r))}}getCreateProjectFromDatabaseDialog(e){return new w.CreateProjectFromDatabaseDialog(e)}async createProjectFromDatabaseCallback(e){try{const t=e.filePath,r=await this.createNewProject({newProjName:e.projName,folderUri:l.Uri.file(t),projectTypeId:n.emptySqlDatabaseProjectTypeId});e.filePath=i.dirname(r),this.setFilePath(e);const o=await d.Project.openProject(r);await this.createProjectFromDatabaseApiCall(e);let s=1===e.extractTarget?[l.Uri.file(e.filePath)]:await this.generateList(e.filePath);await o.addToProject(s);const c=a.getDataWorkspaceExtensionApi();c.showProjectsView(),await c.addProjectsToWorkspace([l.Uri.file(r)])}catch(e){l.window.showErrorMessage(a.getErrorMessage(e))}}setFilePath(e){1===e.extractTarget&&(e.filePath=i.join(e.filePath,e.projName+".sql"))}getConnectionProfileFromContext(e){var t,r,n;if(e)return null!==(n=null!==(r=null===(t=e)||void 0===t?void 0:t.connectionProfile)&&void 0!==r?r:e.connectionInfo)&&void 0!==n?n:e}async createProjectFromDatabaseApiCall(e){const t=await a.getDacFxService(),r=a.getAzdataApi();r?await t.createProjectFromDatabase(e.database,e.filePath,e.projName,e.version,e.connectionUri,e.extractTarget,r.TaskExecutionMode.execute):await t.createProjectFromDatabase(e.database,e.filePath,e.projName,e.version,e.connectionUri,e.extractTarget,N.execute)}async generateList(e){let t=[];if(!await a.exists(e)){if(!await a.exists(e+n.sqlFileExtension))return l.window.showErrorMessage(n.cannotResolvePath(e)),t;e+=n.sqlFileExtension}const r=[e];do{const e=r.pop();if(e){const n=await u.promises.stat(e);n.isDirectory()?(t.push(l.Uri.file(e)),(await u.promises.readdir(e)).forEach(t=>r.push(i.join(e,t)))):n.isFile()&&t.push(l.Uri.file(e))}}while(0!==r.length);return t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.load=t.NoDataSourcesFileError=t.DataSource=void 0;const n=r(4),o=r(1);t.DataSource=class{constructor(e){this.name=e}};class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name=i.name}}t.NoDataSourcesFileError=i,t.load=async function(e){let t;try{t=await n.promises.readFile(e)}catch(e){throw new i(o.noDataSourcesFile)}const r=JSON.parse(t.toString());if(void 0===r.version)throw new Error(o.missingVersion);switch(r.version){case"0.0.0":break;default:throw new Error(o.unrecognizedDataSourcesVersion+r.version)}return[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(210),o={};try{const e=r(91);o["common.adsversion"]=null==e?void 0:e.version}catch(e){}class i{constructor(e,t,r,n){this.reporter=e,this.eventName=t,this.properties=r,this.measurements=n,this.properties=r||{},Object.assign(this.properties,o),this.measurements=n||{}}send(){try{this.reporter.sendTelemetryEvent(this.eventName,this.properties,this.measurements)}catch(e){const t=e instanceof Error?e.message:e;console.error(`Error sending ${this.eventName} event ${t}`)}}withAdditionalProperties(e){return Object.assign(this.properties,e),this}withAdditionalMeasurements(e){return Object.assign(this.measurements,e),this}withConnectionInfo(e){return Object.assign(this.properties,{authenticationType:e.authenticationType,providerName:e.providerName,serverType:e.serverType,engineType:e.engineType}),this}}t.default=class{constructor(e,t,r){this._telemetryReporter=new n.default(e,t,r)}createViewEvent(e){return new i(this._telemetryReporter,"view",{view:e})}sendViewEvent(e){this.createViewEvent(e).send()}createActionEvent(e,t,r="",n="",o){const a=o?{durationInMs:o}:{};return new i(this._telemetryReporter,"action",{view:e,action:t,target:r,source:n},a)}sendActionEvent(e,t,r="",n="",o){this.createActionEvent(e,t,r,n,o).send()}createMetricsEvent(e,t=""){return new i(this._telemetryReporter,"metrics",{groupName:t},e)}sendMetricsEvent(e,t=""){this.createMetricsEvent(e,t).send()}createErrorEvent(e,t,r="",n=""){return new i(this._telemetryReporter,"error",{view:e,name:t,errorCode:r,errorType:n})}sendErrorEvent(e,t,r="",n=""){this.createErrorEvent(e,t,r,n).send()}createTelemetryEvent(e,t,r){return new i(this._telemetryReporter,e,t,r)}sendTelemetryEvent(e,t,r){this.createTelemetryEvent(e,t,r).send()}dispose(){return this._telemetryReporter.dispose()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL=!0;var n=r(4),o=r(9),i=r(0),a=r(2),s=r(211),c=function(){function e(e,t,r,o){var s=this;this.extensionId=e,this.extensionVersion=t,this.firstParty=!1,this.userOptIn=!1,this.firstParty=!!o;var c=process.env.VSCODE_LOGS||"";c&&e&&"trace"===process.env.VSCODE_LOG_LEVEL&&(c=i.join(c,e+".txt"),this.logStream=n.createWriteStream(c,{flags:"a",encoding:"utf8",autoClose:!0})),this.updateUserOptIn(r),this.configListener=a.workspace.onDidChangeConfiguration((function(){return s.updateUserOptIn(r)}))}return e.prototype.updateUserOptIn=function(t){var r=a.workspace.getConfiguration(e.TELEMETRY_CONFIG_ID);this.userOptIn!==r.get(e.TELEMETRY_CONFIG_ENABLED_ID,!0)&&(this.userOptIn=r.get(e.TELEMETRY_CONFIG_ENABLED_ID,!0),this.userOptIn?this.createAppInsightsClient(t):this.dispose())},e.prototype.createAppInsightsClient=function(e){s.defaultClient?(this.appInsightsClient=new s.TelemetryClient(e),this.appInsightsClient.channel.setUseDiskRetryCaching(!0)):(s.setup(e).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this.appInsightsClient=s.defaultClient),this.appInsightsClient.commonProperties=this.getCommonProperties(),a&&a.env&&(this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.userId]=a.env.machineId,this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.sessionId]=a.env.sessionId),e&&0===e.indexOf("AIF-")&&(this.appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1",this.firstParty=!0)},e.prototype.getCommonProperties=function(){var e=Object.create(null);if(e["common.os"]=o.platform(),e["common.platformversion"]=(o.release()||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),e["common.extname"]=this.extensionId,e["common.extversion"]=this.extensionVersion,a&&a.env){switch(e["common.vscodemachineid"]=a.env.machineId,e["common.vscodesessionid"]=a.env.sessionId,e["common.vscodeversion"]=a.version,a.env.uiKind){case a.UIKind.Web:e["common.uikind"]="web";break;case a.UIKind.Desktop:e["common.uikind"]="desktop";break;default:e["common.uikind"]="unknown"}e["common.remotename"]=this.cleanRemoteName(a.env.remoteName)}return e},e.prototype.cleanRemoteName=function(e){if(!e)return"none";var t="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach((function(r){0===e.indexOf(r+"+")&&(t=r)})),t},e.prototype.shouldSendErrorTelemetry=function(){return!this.firstParty||("other"!==this.cleanRemoteName(a.env.remoteName)||void 0!==this.extension&&this.extension.extensionKind!==a.ExtensionKind.Workspace&&a.env.uiKind!==a.UIKind.Web)},Object.defineProperty(e.prototype,"extension",{get:function(){return void 0===this._extension&&(this._extension=a.extensions.getExtension(this.extensionId)),this._extension},enumerable:!0,configurable:!0}),e.prototype.cloneAndChange=function(e,t){if(null===e||"object"!=typeof e)return e;if("function"!=typeof t)return e;var r={};for(var n in e)r[n]=t(n,e[n]);return r},e.prototype.anonymizeFilePaths=function(e,t){if(null==e)return"";var r=[new RegExp(a.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")];this.extension&&r.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));var n=e;if(t){for(var o=[],i=0,s=r;i<s.length;i++)for(var c=s[i];;){var l=c.exec(e);if(!l)break;o.push([l.index,c.lastIndex])}var u=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,p=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g,d=0;n="";for(var h=function(){var t=p.exec(e);if(!t)return"break";!u.test(t[0])&&o.every((function(e){var r=e[0],n=e[1];return t.index<r||t.index>=n}))&&(n+=e.substring(d,t.index)+"<REDACTED: user-file-path>",d=p.lastIndex)};;){if("break"===h())break}d<e.length&&(n+=e.substr(d))}for(var f=0,m=r;f<m.length;f++){c=m[f];n=n.replace(c,"")}return n},e.prototype.sendTelemetryEvent=function(e,t,r){var n=this;if(this.userOptIn&&e&&this.appInsightsClient){var o=this.cloneAndChange(t,(function(e,t){return n.anonymizeFilePaths(t,n.firstParty)}));this.appInsightsClient.trackEvent({name:this.extensionId+"/"+e,properties:o,measurements:r}),this.logStream&&this.logStream.write("telemetry/"+e+" "+JSON.stringify({properties:t,measurements:r})+"\n")}},e.prototype.sendTelemetryErrorEvent=function(e,t,r,n){var o=this;if(this.userOptIn&&e&&this.appInsightsClient){var i=this.cloneAndChange(t,(function(e,t){return o.shouldSendErrorTelemetry()?o.anonymizeFilePaths(t,o.firstParty):void 0===n||-1!==n.indexOf(e)?"REDACTED":o.anonymizeFilePaths(t,o.firstParty)}));this.appInsightsClient.trackEvent({name:this.extensionId+"/"+e,properties:i,measurements:r}),this.logStream&&this.logStream.write("telemetry/"+e+" "+JSON.stringify({properties:t,measurements:r})+"\n")}},e.prototype.sendTelemetryException=function(e,t,r){var n=this;if(this.shouldSendErrorTelemetry()&&this.userOptIn&&e&&this.appInsightsClient){var o=this.cloneAndChange(t,(function(e,t){return n.anonymizeFilePaths(t,n.firstParty)}));this.appInsightsClient.trackException({exception:e,properties:o,measurements:r}),this.logStream&&this.logStream.write("telemetry/"+e.name+" "+e.message+" "+JSON.stringify({properties:t,measurements:r})+"\n")}},e.prototype.dispose=function(){var e=this;this.configListener.dispose();var t=new Promise((function(t){if(!e.logStream)return t(void 0);e.logStream.on("finish",t),e.logStream.end()})),r=new Promise((function(t){e.appInsightsClient?e.appInsightsClient.flush({callback:function(){e.appInsightsClient=void 0,t(void 0)}}):t(void 0)}));return Promise.all([r,t])},e.TELEMETRY_CONFIG_ID="telemetry",e.TELEMETRY_CONFIG_ENABLED_ID="enableTelemetry",e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(28),i=r(250),a=r(271),s=r(63),c=r(40),l=r(107),u=r(23),p=r(7),d=r(279),h=r(283);t.TelemetryClient=r(285),t.Contracts=r(12),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"}(n=t.DistributedTracingModes||(t.DistributedTracingModes={}));var f,m,g,y,v,b,w,S,E,P=!0,T=!1,_=!0,D=!0,C=!0,x=!0,I=!0,j=!0,N=!1,A=!0,k=void 0,R=void 0,F=!1;function O(){return t.defaultClient?(F=!0,g.enable(P,T),y.enable(_),v.enable(D),b.enable(A,m),w.useAutoCorrelation(j,f),w.enable(C),S.enable(x),t.liveMetricsClient&&N&&t.liveMetricsClient.enable(N)):p.warn("Start cannot be called before setup"),L}t.setup=function(e){return t.defaultClient?p.info("The default client is already setup"):(t.defaultClient=new t.TelemetryClient(e),g=new i(t.defaultClient),y=new a(t.defaultClient),v=new s(t.defaultClient),w=new l(t.defaultClient),S=new c(t.defaultClient),b||(b=new h.AutoCollectNativePerformance(t.defaultClient))),t.defaultClient&&t.defaultClient.channel&&t.defaultClient.channel.setUseDiskRetryCaching(I,k,R),L},t.start=O,t.getCorrelationContext=function(){return j?o.CorrelationContextManager.getCurrentContext():null},t.wrapWithCorrelationContext=function(e){return o.CorrelationContextManager.wrapCallback(e)};var L=function(){function e(){}return e.setDistributedTracingMode=function(t){return u.w3cEnabled=t===n.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return void 0===r&&(r=!1),P=t,T=r,F&&g.enable(t,r),e},e.setAutoCollectExceptions=function(t){return _=t,F&&y.enable(t),e},e.setAutoCollectPerformance=function(t,r){void 0===r&&(r=!0),D=t;var n=h.AutoCollectNativePerformance.parseEnabled(r);return A=n.isEnabled,m=n.disabledMetrics,F&&(v.enable(t),b.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectRequests=function(t){return C=t,F&&w.enable(t),e},e.setAutoCollectDependencies=function(t){return x=t,F&&S.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return j=t,f=r,F&&w.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(r,n,o){return I=r,k=n,R=o,t.defaultClient&&t.defaultClient.channel&&t.defaultClient.channel.setUseDiskRetryCaching(r,n,o),e},e.setInternalLogging=function(t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),p.enableDebug=t,p.disableWarnings=!r,e},e.setSendLiveMetrics=function(r){return void 0===r&&(r=!1),t.defaultClient?(!t.liveMetricsClient&&r?(t.liveMetricsClient=new d(t.defaultClient.config.instrumentationKey),E=new s(t.liveMetricsClient,1e3,!0),t.liveMetricsClient.addCollector(E),t.defaultClient.quickPulseClient=t.liveMetricsClient):t.liveMetricsClient&&t.liveMetricsClient.enable(r),N=r,e):(p.warn("Live metrics client cannot be setup without the default client"),e)},e.start=O,e}();t.Configuration=L,t.dispose=function(){t.defaultClient=null,F=!1,g&&g.dispose(),y&&y.dispose(),v&&v.dispose(),b&&b.dispose(),w&&w.dispose(),S&&S.dispose(),t.liveMetricsClient&&(t.liveMetricsClient.enable(!1),N=!1,t.liveMetricsClient=void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(213);t.azuresdk=n;var o=r(217);t.bunyan=o;var i=r(218);t.console=i;var a=r(220);t.mongodbCore=a;var s=r(221);t.mongodb=s;var c=r(222);t.mysql=c;var l=r(225);t.pgPool=l;var u=r(226);t.pg=u;var p=r(227);t.redis=p;var d=r(228);t.tedious=d;var h=r(229);t.winston=h,t.enable=function(){o.enable(),i.enable(),a.enable(),s.enable(),c.enable(),u.enable(),l.enable(),p.enable(),h.enable(),n.enable(),d.enable()}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5);t.AzureMonitorSymbol="Azure_Monitor_Tracer";var i=function(){function e(){}return e.prototype.onStart=function(e){},e.prototype.onEnd=function(e){o.channel.publish("azure-coretracing",e)},e.prototype.shutdown=function(){},e}();t.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(e){try{var a=new(0,r(216).BasicTracer)(o.channel.spanContextPropagator?{scopeManager:o.channel.spanContextPropagator}:void 0),s=a.startSpan;a.startSpan=function(e,t){if(!t||!t.parent){var r=a.getCurrentSpan();r&&r.operation&&r.operation.traceparent&&(t=n({},t,{parent:{traceId:r.operation.traceparent.traceId,spanId:r.operation.traceparent.spanId}}))}var o=s.call(this,e,t);return o.addEvent("Application Insights Integration enabled"),o},a.addSpanProcessor(new i),a[t.AzureMonitorSymbol]=!0,e.setTracer(a)}catch(e){}return e}},t.enable=function(){o.channel.registerMonkeyPatch("@azure/core-tracing",t.azureCoreTracing)}},function(e,t){var r;t=e.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],i=t.src=[],a=0,s=a++;i[s]="0|[1-9]\\d*";var c=a++;i[c]="[0-9]+";var l=a++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=a++;i[u]="("+i[s]+")\\.("+i[s]+")\\.("+i[s]+")";var p=a++;i[p]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=a++;i[d]="(?:"+i[s]+"|"+i[l]+")";var h=a++;i[h]="(?:"+i[c]+"|"+i[l]+")";var f=a++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var m=a++;i[m]="(?:-?("+i[h]+"(?:\\."+i[h]+")*))";var g=a++;i[g]="[0-9A-Za-z-]+";var y=a++;i[y]="(?:\\+("+i[g]+"(?:\\."+i[g]+")*))";var v=a++,b="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+b+"$";var w="[v=\\s]*"+i[p]+i[m]+"?"+i[y]+"?",S=a++;i[S]="^"+w+"$";var E=a++;i[E]="((?:<|>)?=?)";var P=a++;i[P]=i[c]+"|x|X|\\*";var T=a++;i[T]=i[s]+"|x|X|\\*";var _=a++;i[_]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var D=a++;i[D]="[v=\\s]*("+i[P]+")(?:\\.("+i[P]+")(?:\\.("+i[P]+")(?:"+i[m]+")?"+i[y]+"?)?)?";var C=a++;i[C]="^"+i[E]+"\\s*"+i[_]+"$";var x=a++;i[x]="^"+i[E]+"\\s*"+i[D]+"$";var I=a++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var j=a++;i[j]="(?:~>?)";var N=a++;i[N]="(\\s*)"+i[j]+"\\s+",o[N]=new RegExp(i[N],"g");var A=a++;i[A]="^"+i[j]+i[_]+"$";var k=a++;i[k]="^"+i[j]+i[D]+"$";var R=a++;i[R]="(?:\\^)";var F=a++;i[F]="(\\s*)"+i[R]+"\\s+",o[F]=new RegExp(i[F],"g");var O=a++;i[O]="^"+i[R]+i[_]+"$";var L=a++;i[L]="^"+i[R]+i[D]+"$";var q=a++;i[q]="^"+i[E]+"\\s*("+w+")$|^$";var M=a++;i[M]="^"+i[E]+"\\s*("+b+")$|^$";var B=a++;i[B]="(\\s*)"+i[E]+"\\s*("+w+"|"+i[_]+")",o[B]=new RegExp(i[B],"g");var V=a++;i[V]="^\\s*("+i[_]+")\\s+-\\s+("+i[_]+")\\s*$";var $=a++;i[$]="^\\s*("+i[D]+")\\s+-\\s+("+i[D]+")\\s*$";var H=a++;i[H]="(<|>)?=?\\s*\\*";for(var U=0;U<35;U++)r(U,i[U]),o[U]||(o[U]=new RegExp(i[U]));function G(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?o[S]:o[v]).test(e))return null;try{return new z(e,t)}catch(e){return null}}function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?o[S]:o[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}t.parse=G,t.valid=function(e,t){var r=G(e,t);return r?r.version:null},t.clean=function(e,t){var r=G(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return X(n,o)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(Y(e,t))return null;var r=G(e),n=G(t),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var i="prerelease"}for(var a in r)if(("major"===a||"minor"===a||"patch"===a)&&r[a]!==n[a])return o+a;return i},t.compareIdentifiers=X;var W=/^[0-9]+$/;function X(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Q(e,t,r){return new z(e,r).compare(new z(t,r))}function K(e,t,r){return Q(e,t,r)>0}function J(e,t,r){return Q(e,t,r)<0}function Y(e,t,r){return 0===Q(e,t,r)}function Z(e,t,r){return 0!==Q(e,t,r)}function ee(e,t,r){return Q(e,t,r)>=0}function te(e,t,r){return Q(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Y(e,r,n);case"!=":return Z(e,r,n);case">":return K(e,r,n);case">=":return ee(e,r,n);case"<":return J(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return X(t,e)},t.major=function(e,t){return new z(e,t).major},t.minor=function(e,t){return new z(e,t).minor},t.patch=function(e,t){return new z(e,t).patch},t.compare=Q,t.compareLoose=function(e,t){return Q(e,t,!0)},t.rcompare=function(e,t,r){return Q(t,e,r)},t.sort=function(e,r){return e.sort((function(e,n){return t.compare(e,n,r)}))},t.rsort=function(e,r){return e.sort((function(e,n){return t.rcompare(e,n,r)}))},t.gt=K,t.lt=J,t.eq=Y,t.neq=Z,t.gte=ee,t.lte=te,t.cmp=re,t.Comparator=ne;var oe={};function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function se(e,t,r,n,o,i,a,s,c,l,u,p,d){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(o)?">="+r+"."+n+".0":">="+t)+" "+(s=ae(c)?"":ae(l)?"<"+(+c+1)+".0.0":ae(u)?"<"+c+"."+(+l+1)+".0":p?"<="+c+"."+l+"."+u+"-"+p:"<="+s)).trim()}function ce(e,t,n){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(r(e[o].semver),e[o].semver!==oe&&e[o].semver.prerelease.length>0){var i=e[o].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch(e){return!1}return t.test(e)}function ue(e,t,r,n){var o,i,a,s,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":o=K,i=te,a=J,s=">",c=">=";break;case"<":o=J,i=ee,a=K,s="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],p=null,d=null;if(u.forEach((function(e){e.semver===oe&&(e=new ne(">=0.0.0")),p=p||e,d=d||e,o(e.semver,p.semver,n)?p=e:a(e.semver,d.semver,n)&&(d=e)})),p.operator===s||p.operator===c)return!1;if((!d.operator||d.operator===s)&&i(e,d.semver))return!1;if(d.operator===c&&a(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?o[q]:o[M],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=oe},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||i&&a||s||c},t.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[$]:o[V];e=e.replace(n,se),r("hyphen replace",e),e=e.replace(o[B],"$1$2$3"),r("comparator trim",e,o[B]),e=(e=(e=e.replace(o[N],"$1~")).replace(o[F],"$1^")).split(/\s+/).join(" ");var i=t?o[q]:o[M],a=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[L]:o[O];return e.replace(n,(function(t,n,o,i,a){var s;return r("caret",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":a?(r("replaceCaret pr",a),s="0"===n?"0"===o?">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+"-"+a+" <"+(+n+1)+".0.0"):(r("no pr"),s="0"===n?"0"===o?">="+n+"."+o+"."+i+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+" <"+(+n+1)+".0.0"),r("caret return",s),s}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?o[k]:o[A];return e.replace(n,(function(t,n,o,i,a){var s;return r("tilde",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":a?(r("replaceTilde pr",a),s=">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0"):s=">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0",r("tilde return",s),s}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?o[x]:o[C];return e.replace(n,(function(t,n,o,i,a,s){r("xRange",e,t,n,o,i,a,s);var c=ae(o),l=c||ae(i),u=l||ae(a);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),a=0,">"===n?(n=">=",l?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",l?o=+o+1:i=+i+1),t=n+o+"."+i+"."+a):l?t=">="+o+".0.0 <"+(+o+1)+".0.0":u&&(t=">="+o+"."+i+".0 <"+o+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[H],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(i)}))),a=a.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},t.satisfies=le,t.maxSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&-1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r))return r;if(r=new z("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!K(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},t.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return ue(e,t,"<",r)},t.gtr=function(e,t,r){return ue(e,t,">",r)},t.outside=ue,t.prerelease=function(e,t){var r=G(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(o[I]);if(null==t)return null;return G(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}},function(e){e.exports=JSON.parse('{"name":"diagnostic-channel","version":"0.2.0","main":"./dist/src/channel.js","types":"./dist/src/channel.d.ts","scripts":{"build":"tsc","lint":"tslint -c tslint.json -p tsconfig.json","clean":"rimraf ./dist","test":"mocha ./dist/tests/**/*.js"},"homepage":"https://github.com/Microsoft/node-diagnostic-channel","bugs":{"url":"https://github.com/Microsoft/node-diagnostic-channel/issues"},"repository":{"type":"git","url":"https://github.com/Microsoft/node-diagnostic-channel.git"},"description":"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers","dependencies":{"semver":"^5.3.0"},"devDependencies":{"@types/mocha":"^2.2.40","@types/node":"^7.0.12","mocha":"^3.2.0","rimraf":"^2.6.1","tslint":"^5.0.0","typescript":"^2.2.1"},"files":["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],"license":"MIT"}')},function(e,t){e.exports=require("@opentelemetry/tracing")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:function(e){var t=e.prototype._emit;return e.prototype._emit=function(e,r){var o=t.apply(this,arguments);if(!r){var i=o;i||(i=t.call(this,e,!0)),n.channel.publish("bunyan",{level:e.level,result:i})}return o},e}},t.enable=function(){n.channel.registerMonkeyPatch("bunyan",t.bunyan)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(21);t.console={versionSpecifier:">= 4.0.0",patch:function(e){var t=new o.Writable,r=new o.Writable;t.write=function(e){if(!e)return!0;var t=e.toString();return n.channel.publish("console",{message:t}),!0},r.write=function(e){if(!e)return!0;var t=e.toString();return n.channel.publish("console",{message:t,stderr:!0}),!0};for(var i=new e.Console(t,r),a=function(t){var r=e[t];r&&(e[t]=function(){if(i[t])try{i[t].apply(i,arguments)}catch(e){}return r.apply(e,arguments)})},s=0,c=["log","info","warn","error","dir","time","timeEnd","trace","assert"];s<c.length;s++){a(c[s])}return e}},t.enable=function(){n.channel.registerMonkeyPatch("console",t.console),r(219)}},function(e,t){e.exports=require("console")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var e=t.apply(this,arguments),r=this.s.pool.write;this.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=n.channel.bindToContext(arguments[e])),r.apply(this,arguments)};var o=this.s.pool.logout;return this.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=n.channel.bindToContext(arguments[1])),o.apply(this,arguments)},e},e}},t.enable=function(){n.channel.registerMonkeyPatch("mongodb-core",t.mongoCore)}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5);t.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:function(e){var t=e.instrument({operationIdGenerator:{next:function(){return o.channel.bindToContext((function(e){return e()}))}}}),r={};return t.on("started",(function(e){r[e.requestId]||(r[e.requestId]=n({},e,{time:new Date}))})),t.on("succeeded",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})):o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),t.on("failed",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"function"==typeof e.operationId?e.operationId((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})):o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),e}},t.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:function(e){var t=e.instrument(),r={},i={};return t.on("started",(function(e){r[e.requestId]||(i[e.requestId]=o.channel.bindToContext((function(e){return e()})),r[e.requestId]=n({},e,{time:new Date}))})),t.on("succeeded",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete i[e.requestId])})),t.on("failed",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"object"==typeof e&&"function"==typeof i[e.requestId]&&(i[e.requestId]((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete i[e.requestId])})),e}},t.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:function(e){!function(e){var t=e.Server.prototype.connect;e.Server.prototype.connect=function(){var e=t.apply(this,arguments),r=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var e="function"==typeof arguments[1]?1:2;return"function"==typeof arguments[e]&&(arguments[e]=o.channel.bindToContext(arguments[e])),r.apply(this,arguments)};var n=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return"function"==typeof arguments[1]&&(arguments[1]=o.channel.bindToContext(arguments[1])),n.apply(this,arguments)},e}}(e);var t=e.instrument(),r={},n={};return t.on("started",(function(e){r[e.requestId]||(n[e.requestId]=o.channel.bindToContext((function(e){return e()})),r[e.requestId]=e)})),t.on("succeeded",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"object"==typeof e&&"function"==typeof n[e.requestId]&&(n[e.requestId]((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!0})})),delete n[e.requestId])})),t.on("failed",(function(e){var t=r[e.requestId];t&&delete r[e.requestId],"object"==typeof e&&"function"==typeof n[e.requestId]&&(n[e.requestId]((function(){return o.channel.publish("mongodb",{startedData:t,event:e,succeeded:!1})})),delete n[e.requestId])})),e}},t.enable=function(){o.channel.registerMonkeyPatch("mongodb",t.mongo2),o.channel.registerMonkeyPatch("mongodb",t.mongo3),o.channel.registerMonkeyPatch("mongodb",t.mongo330)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(0);t.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:function(e,t){var i=function(e,t){return function(t,r){var o=e[t];o&&(e[t]=function(){for(var e=arguments.length-1,t=arguments.length-1;t>=0;--t){if("function"==typeof arguments[t]){e=t;break}if(void 0!==arguments[t])break}var i=arguments[e],a={result:null,startTime:null,startDate:null};"function"==typeof i&&(r?(a.startTime=process.hrtime(),a.startDate=new Date,arguments[e]=n.channel.bindToContext(r(a,i))):arguments[e]=n.channel.bindToContext(i));var s=o.apply(this,arguments);return a.result=s,s})}},a=function(e,t){return i(e.prototype)},s=r(223)(o.dirname(t)+"/lib/Connection");["connect","changeUser","ping","statistics","end"].forEach((function(e){return a(s)(e)})),i(s)("createQuery",(function(e,t){return function(r){var o=process.hrtime(e.startTime),i=1e3*o[0]+o[1]/1e6|0;n.channel.publish("mysql",{query:e.result,callbackArgs:arguments,err:r,duration:i,time:e.startDate}),t.apply(this,arguments)}}));var c=r(224)(o.dirname(t)+"/lib/Pool");return["_enqueueCallback"].forEach((function(e){return a(c)(e)})),e}},t.enable=function(){n.channel.registerMonkeyPatch("mysql",t.mysql)}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=223},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=224},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:function(e){var t=e.prototype.connect;return e.prototype.connect=function(e){return e&&(arguments[0]=n.channel.bindToContext(e)),t.apply(this,arguments)},e}},t.enable=function(){n.channel.registerMonkeyPatch("pg-pool",t.postgresPool1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(79);t.postgres6={versionSpecifier:"6.*",patch:function(e,t){var r=e.Client.prototype.query;return e.Client.prototype.query=function(e,t,i){var a,s={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},c=process.hrtime();function l(e){e&&e.__diagnosticOriginalFunc&&(e=e.__diagnosticOriginalFunc);var t=n.channel.bindToContext((function(t,r){var i=process.hrtime(c);if(s.result=r&&{rowCount:r.rowCount,command:r.command},s.error=t,s.duration=Math.ceil(1e3*i[0]+i[1]/1e6),n.channel.publish("postgres",s),t){if(e)return e.apply(this,arguments);a&&a instanceof o.EventEmitter&&a.emit("error",t)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(t,"__diagnosticOriginalFunc",{value:e}),t}catch(t){return e}}try{"string"==typeof e?t instanceof Array?(s.query.preparable={text:e,args:t},i=l(i)):(s.query.text=e,i?i=l(i):t=l(t)):("string"==typeof e.name?s.query.plan=e.name:e.values instanceof Array?s.query.preparable={text:e.text,args:e.values}:s.query.text=e.text,i?i=l(i):t?t=l(t):e.callback=l(e.callback))}catch(e){return r.apply(this,arguments)}return arguments[0]=e,arguments[1]=t,arguments[2]=i,arguments.length=arguments.length>3?arguments.length:3,a=r.apply(this,arguments)},e}},t.postgres7={versionSpecifier:">=7.* <=8.*",patch:function(e,t){var r=e.Client.prototype.query;return e.Client.prototype.query=function(e,t,i){var a,s=this,c=!!i,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},u=process.hrtime();function p(e){e&&e.__diagnosticOriginalFunc&&(e=e.__diagnosticOriginalFunc);var t=n.channel.bindToContext((function(t,r){var i=process.hrtime(u);if(l.result=r&&{rowCount:r.rowCount,command:r.command},l.error=t,l.duration=Math.ceil(1e3*i[0]+i[1]/1e6),n.channel.publish("postgres",l),t){if(e)return e.apply(this,arguments);a&&a instanceof o.EventEmitter&&a.emit("error",t)}else e&&e.apply(this,arguments)}));try{return Object.defineProperty(t,"__diagnosticOriginalFunc",{value:e}),t}catch(t){return e}}try{"string"==typeof e?t instanceof Array?(l.query.preparable={text:e,args:t},i=(c="function"==typeof i)?p(i):i):(l.query.text=e,i?i=(c="function"==typeof i)?p(i):i:t=(c="function"==typeof t)?p(t):t):("string"==typeof e.name?l.query.plan=e.name:e.values instanceof Array?l.query.preparable={text:e.text,args:e.values}:l.query.text=e.text,i?(c="function"==typeof i,i=p(i)):t?t=(c="function"==typeof t)?p(t):t:(c="function"==typeof e.callback,e.callback=c?p(e.callback):e.callback))}catch(e){return r.apply(this,arguments)}return arguments[0]=e,arguments[1]=t,arguments[2]=i,arguments.length=arguments.length>3?arguments.length:3,a=r.apply(this,arguments),c?a:a.then((function(e){return p()(void 0,e),new s._Promise((function(t,r){t(e)}))})).catch((function(e){return p()(e,void 0),new s._Promise((function(t,r){r(e)}))}))},e}},t.enable=function(){n.channel.registerMonkeyPatch("pg",t.postgres6),n.channel.registerMonkeyPatch("pg",t.postgres7)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(e){if(e){var r=e.callback;if(!r||!r.pubsubBound){var o=this.address,i=process.hrtime(),a=new Date;e.callback=n.channel.bindToContext((function(t,s){var c=process.hrtime(i),l=1e3*c[0]+c[1]/1e6|0;n.channel.publish("redis",{duration:l,address:o,commandObj:e,err:t,result:s,time:a}),"function"==typeof r&&r.apply(this,arguments)})),e.callback.pubsubBound=!0}}return t.call(this,e)},e}},t.enable=function(){n.channel.registerMonkeyPatch("redis",t.redis)}},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5);t.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function e(e){var t=process.hrtime(),r={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return o.channel.bindToContext((function(i,a,s){var c=process.hrtime(t);r=n({},r,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!i&&{rowCount:a,rows:s},query:{text:this.parametersByName.statement.value},error:i,duration:Math.ceil(1e3*c[0]+c[1]/1e6)}),o.channel.publish("tedious",r),e.call(this,i,a,s)}))}var r=arguments[0];arguments[0].callback=e(r.callback),t.apply(this,arguments)},e}},t.enable=function(){o.channel.registerMonkeyPatch("tedious",t.tedious)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var a=r(5);t.winston3={versionSpecifier:"3.x",patch:function(e){var t=function(e){function t(t,r){var n=e.call(this,r)||this;return n.winston=t,n}return o(t,e),t.prototype.log=function(e,t){var r=e.message,n=e.level,o=e.meta,s=i(e,["message","level","meta"]);n="function"==typeof Symbol.for?e[Symbol.for("level")]:n,r=e instanceof Error?e:r;var c=function(e,t){return null!=e.config.npm.levels[t]?"npm":null!=e.config.syslog.levels[t]?"syslog":"unknown"}(this.winston,n);for(var l in o=o||{},s)s.hasOwnProperty(l)&&(o[l]=s[l]);a.channel.publish("winston",{message:r,level:n,levelKind:c,meta:o}),t()},t}(e.Transport);function r(){var r,n=arguments[0].levels||e.config.npm.levels;for(var o in n)n.hasOwnProperty(o)&&(r=void 0===r||n[o]>n[r]?o:r);this.add(new t(e,{level:r}))}var n=e.createLogger;e.createLogger=function(){var o,i=arguments[0].levels||e.config.npm.levels;for(var a in i)i.hasOwnProperty(a)&&(o=void 0===o||i[a]>i[o]?a:o);var s=n.apply(this,arguments);s.add(new t(e,{level:o}));var c=s.configure;return s.configure=function(){c.apply(this,arguments),r.apply(this,arguments)},s};var s=e.createLogger;return e.configure=function(){s.apply(this,arguments),r.apply(this,arguments)},e.add(new t(e)),e}},t.winston2={versionSpecifier:"2.x",patch:function(e){var t,r=e.Logger.prototype.log,n=function(r,n,o){var i;return i=t===e.config.npm.levels?"npm":t===e.config.syslog.levels?"syslog":"unknown",a.channel.publish("winston",{level:r,message:n,meta:o,levelKind:i}),n};return e.Logger.prototype.log=function(){return t=this.levels,this.filters&&0!==this.filters.length?this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter((function(e){return e!==n})),this.filters.push(n)):this.filters=[n],r.apply(this,arguments)},e}},t.enable=function(){a.channel.registerMonkeyPatch("winston",t.winston2),a.channel.registerMonkeyPatch("winston",t.winston3)}},function(e,t,r){"use strict";const n=r(231);process&&n.gte(process.versions.node,"8.0.0")?e.exports=r(232):e.exports=r(234)},function(e,t){var r;t=e.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],i=t.src=[],a=0,s=a++;i[s]="0|[1-9]\\d*";var c=a++;i[c]="[0-9]+";var l=a++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=a++;i[u]="("+i[s]+")\\.("+i[s]+")\\.("+i[s]+")";var p=a++;i[p]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=a++;i[d]="(?:"+i[s]+"|"+i[l]+")";var h=a++;i[h]="(?:"+i[c]+"|"+i[l]+")";var f=a++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var m=a++;i[m]="(?:-?("+i[h]+"(?:\\."+i[h]+")*))";var g=a++;i[g]="[0-9A-Za-z-]+";var y=a++;i[y]="(?:\\+("+i[g]+"(?:\\."+i[g]+")*))";var v=a++,b="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+b+"$";var w="[v=\\s]*"+i[p]+i[m]+"?"+i[y]+"?",S=a++;i[S]="^"+w+"$";var E=a++;i[E]="((?:<|>)?=?)";var P=a++;i[P]=i[c]+"|x|X|\\*";var T=a++;i[T]=i[s]+"|x|X|\\*";var _=a++;i[_]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var D=a++;i[D]="[v=\\s]*("+i[P]+")(?:\\.("+i[P]+")(?:\\.("+i[P]+")(?:"+i[m]+")?"+i[y]+"?)?)?";var C=a++;i[C]="^"+i[E]+"\\s*"+i[_]+"$";var x=a++;i[x]="^"+i[E]+"\\s*"+i[D]+"$";var I=a++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var j=a++;i[j]="(?:~>?)";var N=a++;i[N]="(\\s*)"+i[j]+"\\s+",o[N]=new RegExp(i[N],"g");var A=a++;i[A]="^"+i[j]+i[_]+"$";var k=a++;i[k]="^"+i[j]+i[D]+"$";var R=a++;i[R]="(?:\\^)";var F=a++;i[F]="(\\s*)"+i[R]+"\\s+",o[F]=new RegExp(i[F],"g");var O=a++;i[O]="^"+i[R]+i[_]+"$";var L=a++;i[L]="^"+i[R]+i[D]+"$";var q=a++;i[q]="^"+i[E]+"\\s*("+w+")$|^$";var M=a++;i[M]="^"+i[E]+"\\s*("+b+")$|^$";var B=a++;i[B]="(\\s*)"+i[E]+"\\s*("+w+"|"+i[_]+")",o[B]=new RegExp(i[B],"g");var V=a++;i[V]="^\\s*("+i[_]+")\\s+-\\s+("+i[_]+")\\s*$";var $=a++;i[$]="^\\s*("+i[D]+")\\s+-\\s+("+i[D]+")\\s*$";var H=a++;i[H]="(<|>)?=?\\s*\\*";for(var U=0;U<35;U++)r(U,i[U]),o[U]||(o[U]=new RegExp(i[U]));function G(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?o[S]:o[v]).test(e))return null;try{return new z(e,t)}catch(e){return null}}function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?o[S]:o[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}t.parse=G,t.valid=function(e,t){var r=G(e,t);return r?r.version:null},t.clean=function(e,t){var r=G(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return X(n,o)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(Y(e,t))return null;var r=G(e),n=G(t),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var i="prerelease"}for(var a in r)if(("major"===a||"minor"===a||"patch"===a)&&r[a]!==n[a])return o+a;return i},t.compareIdentifiers=X;var W=/^[0-9]+$/;function X(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Q(e,t,r){return new z(e,r).compare(new z(t,r))}function K(e,t,r){return Q(e,t,r)>0}function J(e,t,r){return Q(e,t,r)<0}function Y(e,t,r){return 0===Q(e,t,r)}function Z(e,t,r){return 0!==Q(e,t,r)}function ee(e,t,r){return Q(e,t,r)>=0}function te(e,t,r){return Q(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Y(e,r,n);case"!=":return Z(e,r,n);case">":return K(e,r,n);case">=":return ee(e,r,n);case"<":return J(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return X(t,e)},t.major=function(e,t){return new z(e,t).major},t.minor=function(e,t){return new z(e,t).minor},t.patch=function(e,t){return new z(e,t).patch},t.compare=Q,t.compareLoose=function(e,t){return Q(e,t,!0)},t.rcompare=function(e,t,r){return Q(t,e,r)},t.sort=function(e,r){return e.sort((function(e,n){return t.compare(e,n,r)}))},t.rsort=function(e,r){return e.sort((function(e,n){return t.rcompare(e,n,r)}))},t.gt=K,t.lt=J,t.eq=Y,t.neq=Z,t.gte=ee,t.lte=te,t.cmp=re,t.Comparator=ne;var oe={};function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function se(e,t,r,n,o,i,a,s,c,l,u,p,d){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(o)?">="+r+"."+n+".0":">="+t)+" "+(s=ae(c)?"":ae(l)?"<"+(+c+1)+".0.0":ae(u)?"<"+c+"."+(+l+1)+".0":p?"<="+c+"."+l+"."+u+"-"+p:"<="+s)).trim()}function ce(e,t,n){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(r(e[o].semver),e[o].semver!==oe&&e[o].semver.prerelease.length>0){var i=e[o].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch(e){return!1}return t.test(e)}function ue(e,t,r,n){var o,i,a,s,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":o=K,i=te,a=J,s=">",c=">=";break;case"<":o=J,i=ee,a=K,s="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],p=null,d=null;if(u.forEach((function(e){e.semver===oe&&(e=new ne(">=0.0.0")),p=p||e,d=d||e,o(e.semver,p.semver,n)?p=e:a(e.semver,d.semver,n)&&(d=e)})),p.operator===s||p.operator===c)return!1;if((!d.operator||d.operator===s)&&i(e,d.semver))return!1;if(d.operator===c&&a(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?o[q]:o[M],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=oe},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||i&&a||s||c},t.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[$]:o[V];e=e.replace(n,se),r("hyphen replace",e),e=e.replace(o[B],"$1$2$3"),r("comparator trim",e,o[B]),e=(e=(e=e.replace(o[N],"$1~")).replace(o[F],"$1^")).split(/\s+/).join(" ");var i=t?o[q]:o[M],a=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[L]:o[O];return e.replace(n,(function(t,n,o,i,a){var s;return r("caret",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":a?(r("replaceCaret pr",a),s="0"===n?"0"===o?">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+"-"+a+" <"+(+n+1)+".0.0"):(r("no pr"),s="0"===n?"0"===o?">="+n+"."+o+"."+i+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+" <"+(+n+1)+".0.0"),r("caret return",s),s}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?o[k]:o[A];return e.replace(n,(function(t,n,o,i,a){var s;return r("tilde",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":a?(r("replaceTilde pr",a),s=">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0"):s=">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0",r("tilde return",s),s}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?o[x]:o[C];return e.replace(n,(function(t,n,o,i,a,s){r("xRange",e,t,n,o,i,a,s);var c=ae(o),l=c||ae(i),u=l||ae(a);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),a=0,">"===n?(n=">=",l?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",l?o=+o+1:i=+i+1),t=n+o+"."+i+"."+a):l?t=">="+o+".0.0 <"+(+o+1)+".0.0":u&&(t=">="+o+"."+i+".0 <"+o+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[H],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(i)}))),a=a.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},t.satisfies=le,t.maxSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&-1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r))return r;if(r=new z("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!K(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},t.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return ue(e,t,"<",r)},t.gtr=function(e,t,r){return ue(e,t,">",r)},t.outside=ue,t.prerelease=function(e,t){var r=G(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(o[I]);if(null==t)return null;return G(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}},function(e,t,r){"use strict";const n=r(20),o=r(26),i=r(61),a=r(233),s=process.env.DEBUG_CLS_HOOKED;let c=-1;function l(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}function u(e){return process.namespaces[e]}function p(e){let t=u(e);o.ok(t,"can't delete nonexistent namespace! \""+e+'"'),o.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function d(...e){s&&process._rawDebug(""+n.format(...e))}e.exports={getNamespace:u,createNamespace:function(e){o.ok(e,"namespace must be given a name."),s&&d(`NS-CREATING NAMESPACE (${e})`);let t=new l(e);t.id=c;return a.createHook({init(r,o,i,l){c=a.executionAsyncId();if(t.active){t._contexts.set(r,t.active);if(s){const a=" ".repeat(t._indent<0?0:t._indent);d(`${a}INIT [${o}] (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} resource:${l}`)}}else if(c===0){const i=a.triggerAsyncId();const u=t._contexts.get(i);if(u){t._contexts.set(r,u);if(s){const a=" ".repeat(t._indent<0?0:t._indent);d(`${a}INIT USING CONTEXT FROM TRIGGERID [${o}] (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} resource:${l}`)}}else if(s){const a=" ".repeat(t._indent<0?0:t._indent);d(`${a}INIT MISSING CONTEXT [${o}] (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} resource:${l}`)}}if(s&&o==="PROMISE"){d(n.inspect(l,{showHidden:true}));const a=l.parentId;const s=" ".repeat(t._indent<0?0:t._indent);d(`${s}INIT RESOURCE-PROMISE [${o}] (${e}) parentId:${a} asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} resource:${l}`)}},before(r){c=a.executionAsyncId();let o;o=t._contexts.get(r)||t._contexts.get(c);if(o){if(s){const i=a.triggerAsyncId();const s=" ".repeat(t._indent<0?0:t._indent);d(`${s}BEFORE (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} context:${n.inspect(o)}`);t._indent+=2}t.enter(o)}else if(s){const o=a.triggerAsyncId();const i=" ".repeat(t._indent<0?0:t._indent);d(`${i}BEFORE MISSING CONTEXT (${e}) asyncId:${r} currentUid:${c} triggerId:${o} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} namespace._contexts:${n.inspect(t._contexts,{showHidden:true,depth:2,colors:true})}`);t._indent+=2}},after(r){c=a.executionAsyncId();let o;o=t._contexts.get(r)||t._contexts.get(c);if(o){if(s){const i=a.triggerAsyncId();t._indent-=2;const s=" ".repeat(t._indent<0?0:t._indent);d(`${s}AFTER (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} context:${n.inspect(o)}`)}t.exit(o)}else if(s){const i=a.triggerAsyncId();t._indent-=2;const s=" ".repeat(t._indent<0?0:t._indent);d(`${s}AFTER MISSING CONTEXT (${e}) asyncId:${r} currentUid:${c} triggerId:${i} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} context:${n.inspect(o)}`)}},destroy(r){c=a.executionAsyncId();if(s){const o=a.triggerAsyncId();const i=" ".repeat(t._indent<0?0:t._indent);d(`${i}DESTROY (${e}) currentUid:${c} asyncId:${r} triggerId:${o} active:${n.inspect(t.active,{showHidden:true,depth:2,colors:true})} context:${n.inspect(t._contexts.get(c))}`)}t._contexts.delete(r)}}).enable(),process.namespaces[e]=t,t},destroyNamespace:p,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){p(e)}));process.namespaces=Object.create(null)},ERROR_SYMBOL:"error@context"},l.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=t,s){d(" ".repeat(this._indent<0?0:this._indent)+"CONTEXT-SET KEY:"+e+"="+t+" in ns:"+this.name+" currentUid:"+c+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return t},l.prototype.get=function(e){if(this.active){if(s){const t=a.executionAsyncId(),r=a.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);d(o+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+c+" active:"+n.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),d(`${o}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${c} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} active:${n.inspect(this.active)}`)}return this.active[e]}if(s){const t=a.currentId(),r=a.triggerAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${c} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length}`)}},l.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=c,s){const t=a.executionAsyncId(),r=a.triggerAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-CREATED Context: (${this.name}) currentUid:${c} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} context:${n.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e},l.prototype.run=function(e){let t=this.createContext();this.enter(t);try{if(s){const e=a.triggerAsyncId(),r=a.executionAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${c} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} context:${n.inspect(t)}`)}return e(t),t}catch(e){throw e&&(e["error@context"]=t),e}finally{if(s){const e=a.triggerAsyncId(),r=a.executionAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-RUN END: (${this.name}) currentUid:${c} triggerId:${e} asyncHooksCurrentId:${r} len:${this._set.length} ${n.inspect(t)}`)}this.exit(t)}},l.prototype.runAndReturn=function(e){let t;return this.run((function(r){t=e(r)})),t},l.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return s&&d("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+c+" len:"+this._set.length+" "+n.inspect(t)),r.then(e=>(s&&d("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+c+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e)).catch(e=>{throw e["error@context"]=t,s&&d("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+c+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e})},l.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e["error@context"]=t),e}finally{r.exit(t)}}},l.prototype.enter=function(e){if(o.ok(e,"context must be provided for entering"),s){const t=a.executionAsyncId(),r=a.triggerAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-ENTER: (${this.name}) currentUid:${c} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}this._set.push(this.active),this.active=e},l.prototype.exit=function(e){if(o.ok(e,"context must be provided for exiting"),s){const t=a.executionAsyncId(),r=a.triggerAsyncId();d(`${" ".repeat(this._indent<0?0:this._indent)}CONTEXT-EXIT: (${this.name}) currentUid:${c} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${n.inspect(e)}`)}if(this.active===e)return o.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(s&&d("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),o.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(o.ok(t,"can't remove top context"),this._set.splice(t,1))},l.prototype.bindEmitter=function(e){o.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;i(e,(function(e){e&&(e["cls@contexts"]||(e["cls@contexts"]=Object.create(null)),e["cls@contexts"][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e["cls@contexts"])return e;let t=e,r=e["cls@contexts"];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},l.prototype.fromException=function(e){return e["error@context"]},process.namespaces={}},function(e,t){e.exports=require("async_hooks")},function(e,t,r){"use strict";const n=r(20),o=r(26),i=r(61),a=r(235),s=[];for(let e in a.providers)s[a.providers[e]]=e;const c=process.env.DEBUG_CLS_HOOKED;let l=-1;function u(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}function p(e){return process.namespaces[e]}function d(e){let t=p(e);o.ok(t,"can't delete nonexistent namespace! \""+e+'"'),o.ok(t.id,"don't assign to process.namespaces directly! "+n.inspect(t)),process.namespaces[e]=null}function h(e){process.env.DEBUG&&process._rawDebug(e)}function f(e){return e?"function"==typeof e?e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1]:e.constructor&&e.constructor.name?e.constructor.name:void 0:e}if(e.exports={getNamespace:p,createNamespace:function(e){o.ok(e,"namespace must be given a name."),c&&h("CREATING NAMESPACE "+e);let t=new u(e);return t.id=l,a.addHooks({init(r,o,i,a,u){l=r,a?(t._contexts.set(r,t._contexts.get(a)),c&&h("PARENTID: "+e+" uid:"+r+" parent:"+a+" provider:"+i)):t._contexts.set(l,t.active),c&&h("INIT "+e+" uid:"+r+" parent:"+a+" provider:"+s[i]+" active:"+n.inspect(t.active,!0))},pre(r,o){l=r;let i=t._contexts.get(r);i?(c&&h(" PRE "+e+" uid:"+r+" handle:"+f(o)+" context:"+n.inspect(i)),t.enter(i)):c&&h(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+f(o))},post(r,o){l=r;let i=t._contexts.get(r);i?(c&&h(" POST "+e+" uid:"+r+" handle:"+f(o)+" context:"+n.inspect(i)),t.exit(i)):c&&h(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+f(o))},destroy(r){l=r,c&&h("DESTROY "+e+" uid:"+r+" context:"+n.inspect(t._contexts.get(l))+" active:"+n.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t},destroyNamespace:d,reset:function(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){d(e)}));process.namespaces=Object.create(null)},ERROR_SYMBOL:"error@context"},u.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return c&&h("    SETTING KEY:"+e+"="+t+" in ns:"+this.name+" uid:"+l+" active:"+n.inspect(this.active,!0)),this.active[e]=t,t},u.prototype.get=function(e){if(this.active)return c&&h("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+l+" active:"+n.inspect(this.active,!0)),this.active[e];c&&h("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+l+" active:"+n.inspect(this.active,!0))},u.prototype.createContext=function(){c&&h("   CREATING Context: "+this.name+" uid:"+l+" len:"+this._set.length+"  active:"+n.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=l,c&&h("   CREATED Context: "+this.name+" uid:"+l+" len:"+this._set.length+"  context:"+n.inspect(e,!0,2,!0)),e},u.prototype.run=function(e){let t=this.createContext();this.enter(t);try{return c&&h(" BEFORE RUN: "+this.name+" uid:"+l+" len:"+this._set.length+" "+n.inspect(t)),e(t),t}catch(e){throw e&&(e["error@context"]=t),e}finally{c&&h(" AFTER RUN: "+this.name+" uid:"+l+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t)}},u.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},u.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return c&&h(" BEFORE runPromise: "+this.name+" uid:"+l+" len:"+this._set.length+" "+n.inspect(t)),r.then(e=>(c&&h(" AFTER runPromise: "+this.name+" uid:"+l+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e)).catch(e=>{throw e["error@context"]=t,c&&h(" AFTER runPromise: "+this.name+" uid:"+l+" len:"+this._set.length+" "+n.inspect(t)),this.exit(t),e})},u.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e["error@context"]=t),e}finally{r.exit(t)}}},u.prototype.enter=function(e){o.ok(e,"context must be provided for entering"),c&&h("  ENTER "+this.name+" uid:"+l+" len:"+this._set.length+" context: "+n.inspect(e)),this._set.push(this.active),this.active=e},u.prototype.exit=function(e){if(o.ok(e,"context must be provided for exiting"),c&&h("  EXIT "+this.name+" uid:"+l+" len:"+this._set.length+" context: "+n.inspect(e)),this.active===e)return o.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());let t=this._set.lastIndexOf(e);t<0?(c&&h("??ERROR?? context exiting but not entered - ignoring: "+n.inspect(e)),o.ok(t>=0,"context not currently entered; can't exit. \n"+n.inspect(this)+"\n"+n.inspect(e))):(o.ok(t,"can't remove top context"),this._set.splice(t,1))},u.prototype.bindEmitter=function(e){o.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;i(e,(function(e){e&&(e["cls@contexts"]||(e["cls@contexts"]=Object.create(null)),e["cls@contexts"][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e["cls@contexts"])return e;let t=e,r=e["cls@contexts"];return Object.keys(r).forEach((function(e){let n=r[e];t=n.namespace.bind(t,n.context)})),t}))},u.prototype.fromException=function(e){return e["error@context"]},process.namespaces={},a._state&&!a._state.enabled&&a.enable(),c){var m=r(98);for(var g in m.filter._modifiers)m.filter.deattach(g)}},function(e,t,r){"use strict";const n=r(236);if(global._asyncHook){if(global._asyncHook.version!==r(97).version)throw new Error("Conflicting version of async-hook-jl found");e.exports=global._asyncHook}else{r(98).filter.attach((function(e,t){return t.filter((function(e){const t=e.getFileName();return!(t&&t.slice(0,__dirname.length)===__dirname)}))})),e.exports=global._asyncHook=new n}},function(e,t,r){"use strict";const n=process.binding("async_wrap"),o=n.Providers.TIMERWRAP,i={nextTick:r(237),promise:r(238),timers:r(239)},a=new Set;function s(){this.enabled=!1,this.counter=0}function c(){const e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(t,r,n,i){if(r!==o)for(const o of e)o(t,this,r,n,i);else a.add(t)},this.pre=function(e){if(!a.has(e))for(const r of t)r(e,this)},this.post=function(e,t){if(!a.has(e))for(const n of r)n(e,this,t)},this.destroy=function(e){if(a.has(e))a.delete(e);else for(const t of n)t(e)}}function l(e,t){const r=e.indexOf(t);-1!==r&&e.splice(r,1)}function u(){this._state=new s,this._hooks=new c,this.version=r(97).version,this.providers=n.Providers;for(const e of Object.keys(i))i[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),n.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}c.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)},c.prototype.remove=function(e){e.init&&l(this.initFns,e.init),e.pre&&l(this.preFns,e.pre),e.post&&l(this.postFns,e.post),e.destroy&&l(this.destroyFns,e.destroy)},e.exports=u,u.prototype.addHooks=function(e){this._hooks.add(e)},u.prototype.removeHooks=function(e){this._hooks.remove(e)},u.prototype.enable=function(){this._state.enabled=!0,n.enable()},u.prototype.disable=function(){this._state.enabled=!1,n.disable()}},function(e,t,r){"use strict";function n(){}e.exports=function(){const e=this._hooks,t=this._state,r=process.nextTick;process.nextTick=function(){if(!t.enabled)return r.apply(process,arguments);const o=new Array(arguments.length);for(let e=0;e<arguments.length;e++)o[e]=arguments[e];const i=o[0];if("function"!=typeof i)throw new TypeError("callback is not a function");const a=new n,s=--t.counter;return e.init.call(a,s,0,null,null),o[0]=function(){e.pre.call(a,s);let t=!0;try{i.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(a,s,!0),e.destroy.call(null,s)}))}e.post.call(a,s,!1),e.destroy.call(null,s)},r.apply(process,o)}}},function(e,t,r){"use strict";function n(){}e.exports=function(){const e=this._hooks,t=this._state,r=global.Promise,o=r.prototype.then;function i(t,r,n,o){return"function"!=typeof t?o?function(t){return function(r){return e.destroy.call(null,t),r}}(n):function(t){return function(r){throw e.destroy.call(null,t),r}}(n):function(){e.pre.call(r,n);try{return t.apply(this,arguments)}finally{e.post.call(r,n,!1),e.destroy.call(null,n)}}}r.prototype.then=function(r,a){if(!t.enabled)return o.call(this,r,a);const s=new n,c=--t.counter;return e.init.call(s,c,0,null,null),o.call(this,i(r,s,c,!0),i(a,s,c,!1))}}},function(e,t,r){"use strict";const n=r(96);function o(){}function i(){}function a(){}const s=new Map,c=new Map,l=new Map;let u=null,p=!1;function d(e,t,r,o,i,a,s){const c=n[r],l=n[o];n[r]=function(){if(!t.enabled)return c.apply(n,arguments);const r=new Array(arguments.length);for(let e=0;e<arguments.length;e++)r[e]=arguments[e];const o=r[0];if("function"!=typeof o)throw new TypeError('"callback" argument must be a function');const l=new i,d=--t.counter;let h=void 0;return e.init.call(l,d,0,null,null),r[0]=function(){u=h,e.pre.call(l,d);let t=!0;try{o.apply(this,arguments),t=!1}finally{t&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",(function(){e.post.call(l,d,!0),a.delete(h),e.destroy.call(null,d)}))}e.post.call(l,d,!1),u=null,(s||p)&&(p=!1,a.delete(h),e.destroy.call(null,d))},h=c.apply(n,r),a.set(h,d),h},n[o]=function(t){if(u===t&&null!==t)p=!0;else if(a.has(t)){const r=a.get(t);a.delete(t),e.destroy.call(null,r)}l.apply(n,arguments)}}e.exports=function(){d(this._hooks,this._state,"setTimeout","clearTimeout",o,s,!0),d(this._hooks,this._state,"setInterval","clearInterval",i,c,!1),d(this._hooks,this._state,"setImmediate","clearImmediate",a,l,!0),global.setTimeout=n.setTimeout,global.setInterval=n.setInterval,global.setImmediate=n.setImmediate,global.clearTimeout=n.clearTimeout,global.clearInterval=n.clearInterval,global.clearImmediate=n.clearImmediate}},function(e,t,r){var n=r(241);function o(){this.extend=new s,this.filter=new s,this.format=new c,this.version=r(99).version}var i=!1;o.prototype.callSite=function e(t){t||(t={}),i=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return i=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var a=new o;function s(){this._modifiers=[]}function c(){this._formater=n,this._previous=void 0}s.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t},s.prototype.attach=function(e){this._modifiers.push(e)},s.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return-1!==t&&(this._modifiers.splice(t,1),!0)},c.prototype.replace=function(e){e?this._formater=e:this.restore()},c.prototype.restore=function(){this._formater=n,this._previous=void 0},c.prototype._backup=function(){this._previous=this._formater},c.prototype._roolback=function(){this._previous===n?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&a.format.replace(Error.prepareStackTrace);var l=!1;function u(e,t){if(i)return t;if(l)return n(e,t);var r=t.concat();r=a.extend._modify(e,r),r=(r=a.filter._modify(e,r)).slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&void 0===Object.getOwnPropertyDescriptor(e,"callSite")&&(e.callSite={original:t,mutated:r}),l=!0;var o=a.format._formater(e,r);return l=!1,o}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return u},set:function(e){e===u?a.format._roolback():(a.format._backup(),a.format.replace(e))}}),Object.defineProperty(Error.prototype,"callSite",{get:function(){return this.stack,this.callSite},set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0}),e.exports=a},function(e,t){e.exports=function(e,t){var r=[];r.push(function(e){try{return Error.prototype.toString.call(e)}catch(e){try{return"<error: "+e+">"}catch(e){return"<error>"}}}(e));for(var n=0;n<t.length;n++){var o,i=t[n];try{o=i.toString()}catch(e){try{o="<error: "+e+">"}catch(e){o="<error>"}}r.push("    at "+o)}return r.join("\n")}},function(e,t,r){"use strict";var n=r(26),o=r(61);function i(e){this.name=e,this.active=null,this._set=[],this.id=null}function a(e){return process.namespaces[e]}function s(e){var t=a(e);n.ok(t,"can't delete nonexistent namespace!"),n.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function c(){process.namespaces&&Object.keys(process.namespaces).forEach((function(e){s(e)})),process.namespaces=Object.create(null)}process.addAsyncListener||r(243),i.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t},i.prototype.get=function(e){if(this.active)return this.active[e]},i.prototype.createContext=function(){return Object.create(this.active)},i.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(e){throw e&&(e["error@context"]=t),e}finally{this.exit(t)}},i.prototype.runAndReturn=function(e){var t;return this.run((function(r){t=e(r)})),t},i.prototype.bind=function(e,t){t||(t=this.active?this.active:this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(e){throw e&&(e["error@context"]=t),e}finally{r.exit(t)}}},i.prototype.enter=function(e){n.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e},i.prototype.exit=function(e){if(n.ok(e,"context must be provided for exiting"),this.active===e)return n.ok(this._set.length,"can't remove top context"),void(this.active=this._set.pop());var t=this._set.lastIndexOf(e);n.ok(t>=0,"context not currently entered; can't exit"),n.ok(t,"can't remove top context"),this._set.splice(t,1)},i.prototype.bindEmitter=function(e){n.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;o(e,(function(e){e&&(e["cls@contexts"]||(e["cls@contexts"]=Object.create(null)),e["cls@contexts"][r]={namespace:t,context:t.active})}),(function(e){if(!e||!e["cls@contexts"])return e;var t=e,r=e["cls@contexts"];return Object.keys(r).forEach((function(e){var n=r[e];t=n.namespace.bind(t,n.context)})),t}))},i.prototype.fromException=function(e){return e["error@context"]},process.namespaces||c(),e.exports={getNamespace:a,createNamespace:function(e){n.ok(e,"namespace must be given a name!");var t=new i(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(e,r){r&&t.enter(r)},after:function(e,r){r&&t.exit(r)},error:function(e){e&&t.exit(e)}}),process.namespaces[e]=t,t},destroyNamespace:s,reset:c}},function(e,t,r){"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var n=r(62),o=r(244),i=n.wrap,a=n.massWrap,s=r(245),c=r(20),l=o.gte(process.version,"6.0.0"),u=o.gte(process.version,"7.0.0"),p=o.gte(process.version,"8.0.0"),d=o.gte(process.version,"11.0.0"),h=r(246);function f(e){return function(){this.on("connection",(function(e){e._handle&&(e._handle.onread=s(e._handle.onread))}));try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=s(this._handle.onconnection))}}}function m(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=s(t._originalOnread)}}u&&!h._normalizeArgs?h._normalizeArgs=function(e){if(0===e.length)return[{},null];var t,r,n=e[0],o={};"object"==typeof n&&null!==n?o=n:"string"==typeof(t=n)&&!1===(r=t,(r=Number(r))>=0&&r)?o.path=n:(o.port=n,e.length>1&&"string"==typeof e[1]&&(o.host=e[1]));var i=e[e.length-1];return"function"!=typeof i?[o,null]:[o,i]}:u||h._normalizeConnectArgs||(h._normalizeConnectArgs=function(e){var t,r={};"object"==typeof e[0]&&null!==e[0]?r=e[0]:"string"==typeof e[0]&&!1===(t=e[0],(t=Number(t))>=0&&t)?r.path=e[0]:(r.port=e[0],"string"==typeof e[1]&&(r.host=e[1]));var n=e[e.length-1];return"function"==typeof n?[r,n]:[r]}),"_setUpListenHandle"in h.Server.prototype?i(h.Server.prototype,"_setUpListenHandle",f):i(h.Server.prototype,"_listen2",f),i(h.Socket.prototype,"connect",(function(e){return function(){var t;(t=p&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?arguments[0]:u?h._normalizeArgs(arguments):h._normalizeConnectArgs(arguments))[1]&&(t[1]=s(t[1]));var r=e.apply(this,t);return m(this),r}}));var g=r(38);i(g.Agent.prototype,"addRequest",(function(e){return function(t){var r=t.onSocket;return t.onSocket=s((function(e){return m(e),r.apply(this,arguments)})),e.apply(this,arguments)}}));var y=r(39);function v(e){Array.isArray(e.stdio)&&e.stdio.forEach((function(e){e&&e._handle&&(e._handle.onread=s(e._handle.onread),i(e._handle,"close",A))})),e._handle&&(e._handle.onexit=s(e._handle.onexit))}y.ChildProcess?i(y.ChildProcess.prototype,"spawn",(function(e){return function(){var t=e.apply(this,arguments);return v(this),t}})):a(y,["execFile","fork","spawn"],(function(e){return function(){var t=e.apply(this,arguments);return v(t),t}})),process._fatalException||(process._originalNextTick=process.nextTick);var b=[];process._nextDomainTick&&b.push("_nextDomainTick"),process._tickDomainCallback&&b.push("_tickDomainCallback"),a(process,b,N),i(process,"nextTick",A);var w=["setTimeout","setInterval"];global.setImmediate&&w.push("setImmediate");var S=r(96),E=global.setTimeout===S.setTimeout;a(S,w,A),E&&a(global,w,A);var P=r(247);a(P,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],N),P.resolveNaptr&&i(P,"resolveNaptr",N);var T,_,D=r(4);a(D,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],N),D.lchown&&i(D,"lchown",N),D.lchmod&&i(D,"lchmod",N),D.ftruncate&&i(D,"ftruncate",N);try{T=r(100)}catch(e){}if(T&&T.Deflate&&T.Deflate.prototype){var C=Object.getPrototypeOf(T.Deflate.prototype);C._transform?i(C,"_transform",N):C.write&&C.flush&&C.end&&a(C,["write","flush","end"],N)}try{_=r(248)}catch(e){}if(_){var x=["pbkdf2","randomBytes"];d||x.push("pseudoRandomBytes"),a(_,x,N)}var I=!!global.Promise&&"function Promise() { [native code] }"===Promise.toString()&&"function toString() { [native code] }"===Promise.toString.toString();if(I){var j=process.addAsyncListener({create:function(){I=!1}});global.Promise.resolve(!0).then((function(){I=!1})),process.removeAsyncListener(j)}function N(e){var t=function(){var t,r=arguments.length-1;if("function"==typeof arguments[r]){t=Array(arguments.length);for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n];t[r]=s(arguments[r])}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof n&&(n=s(n)),e.call(this,r,n))};case 3:return function(r,n,o){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof o&&(o=s(o)),e.call(this,r,n,o))};case 4:return function(r,n,o,i){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof i&&(i=s(i)),e.call(this,r,n,o,i))};case 5:return function(r,n,o,i,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof a&&(a=s(a)),e.call(this,r,n,o,i,a))};case 6:return function(r,n,o,i,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof c&&(c=s(c)),e.call(this,r,n,o,i,a,c))};default:return t}}function A(e){var t=function(){var t;if("function"==typeof arguments[0]){(t=Array(arguments.length))[0]=s(arguments[0]);for(var r=1;r<arguments.length;r++)t[r]=arguments[r]}return e.apply(this,t||arguments)};switch(e.length){case 1:return function(r){return 1!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r))};case 2:return function(r,n){return 2!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r,n))};case 3:return function(r,n,o){return 3!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r,n,o))};case 4:return function(r,n,o,i){return 4!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r,n,o,i))};case 5:return function(r,n,o,i,a){return 5!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r,n,o,i,a))};case 6:return function(r,n,o,i,a,c){return 6!==arguments.length?t.apply(this,arguments):("function"==typeof r&&(r=s(r)),e.call(this,r,n,o,i,a,c))};default:return t}}I&&function(){var e=global.Promise;function t(r){if(!(this instanceof t))return e(r);if("function"!=typeof r)return new e(r);var o,i,a=new e((function(e,t){o=this,i=[function(t){return n(a,!1),e(t)},function(e){return n(a,!1),t(e)}]}));a.__proto__=t.prototype;try{r.apply(o,i)}catch(e){i[1](e)}return a}c.inherits(t,e),i(e.prototype,"then",a),e.prototype.chain&&i(e.prototype,"chain",a);if(l)global.Promise=r(249)(e,n);else{["all","race","reject","resolve","accept","defer"].forEach((function(r){"function"==typeof e[r]&&(t[r]=e[r])})),global.Promise=t}function n(e,t){e.__asl_wrapper&&!t||(e.__asl_wrapper=s(o))}function o(t,r,i,a){var s;try{return{returnVal:s=r.call(t,i),error:!1}}catch(e){return{errorVal:e,error:!0}}finally{s instanceof e?a.__asl_wrapper=function(){var e=s.__asl_wrapper||o;return e.apply(this,arguments)}:n(a,!0)}}function a(e){return function(){var t=this,r=e.apply(t,Array.prototype.map.call(arguments,n));return r.__asl_wrapper=function(e,n,i,a){return t.__asl_wrapper?(t.__asl_wrapper(e,(function(){}),null,r),r.__asl_wrapper(e,n,i,a)):o(e,n,i,a)},r;function n(e){return"function"!=typeof e?e:s((function(n){var i=(t.__asl_wrapper||o)(this,e,n,r);if(i.error)throw i.errorVal;return i.returnVal}))}}}}()},function(e,t){var r;t=e.exports=z,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],i=t.src=[],a=0,s=a++;i[s]="0|[1-9]\\d*";var c=a++;i[c]="[0-9]+";var l=a++;i[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var u=a++;i[u]="("+i[s]+")\\.("+i[s]+")\\.("+i[s]+")";var p=a++;i[p]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var d=a++;i[d]="(?:"+i[s]+"|"+i[l]+")";var h=a++;i[h]="(?:"+i[c]+"|"+i[l]+")";var f=a++;i[f]="(?:-("+i[d]+"(?:\\."+i[d]+")*))";var m=a++;i[m]="(?:-?("+i[h]+"(?:\\."+i[h]+")*))";var g=a++;i[g]="[0-9A-Za-z-]+";var y=a++;i[y]="(?:\\+("+i[g]+"(?:\\."+i[g]+")*))";var v=a++,b="v?"+i[u]+i[f]+"?"+i[y]+"?";i[v]="^"+b+"$";var w="[v=\\s]*"+i[p]+i[m]+"?"+i[y]+"?",S=a++;i[S]="^"+w+"$";var E=a++;i[E]="((?:<|>)?=?)";var P=a++;i[P]=i[c]+"|x|X|\\*";var T=a++;i[T]=i[s]+"|x|X|\\*";var _=a++;i[_]="[v=\\s]*("+i[T]+")(?:\\.("+i[T]+")(?:\\.("+i[T]+")(?:"+i[f]+")?"+i[y]+"?)?)?";var D=a++;i[D]="[v=\\s]*("+i[P]+")(?:\\.("+i[P]+")(?:\\.("+i[P]+")(?:"+i[m]+")?"+i[y]+"?)?)?";var C=a++;i[C]="^"+i[E]+"\\s*"+i[_]+"$";var x=a++;i[x]="^"+i[E]+"\\s*"+i[D]+"$";var I=a++;i[I]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var j=a++;i[j]="(?:~>?)";var N=a++;i[N]="(\\s*)"+i[j]+"\\s+",o[N]=new RegExp(i[N],"g");var A=a++;i[A]="^"+i[j]+i[_]+"$";var k=a++;i[k]="^"+i[j]+i[D]+"$";var R=a++;i[R]="(?:\\^)";var F=a++;i[F]="(\\s*)"+i[R]+"\\s+",o[F]=new RegExp(i[F],"g");var O=a++;i[O]="^"+i[R]+i[_]+"$";var L=a++;i[L]="^"+i[R]+i[D]+"$";var q=a++;i[q]="^"+i[E]+"\\s*("+w+")$|^$";var M=a++;i[M]="^"+i[E]+"\\s*("+b+")$|^$";var B=a++;i[B]="(\\s*)"+i[E]+"\\s*("+w+"|"+i[_]+")",o[B]=new RegExp(i[B],"g");var V=a++;i[V]="^\\s*("+i[_]+")\\s+-\\s+("+i[_]+")\\s*$";var $=a++;i[$]="^\\s*("+i[D]+")\\s+-\\s+("+i[D]+")\\s*$";var H=a++;i[H]="(<|>)?=?\\s*\\*";for(var U=0;U<35;U++)r(U,i[U]),o[U]||(o[U]=new RegExp(i[U]));function G(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?o[S]:o[v]).test(e))return null;try{return new z(e,t)}catch(e){return null}}function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof z){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof z))return new z(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var i=e.trim().match(t.loose?o[S]:o[v]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}t.parse=G,t.valid=function(e,t){var r=G(e,t);return r?r.version:null},t.clean=function(e,t){var r=G(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=z,z.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},z.prototype.toString=function(){return this.version},z.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof z||(e=new z(e,this.options)),this.compareMain(e)||this.comparePre(e)},z.prototype.compareMain=function(e){return e instanceof z||(e=new z(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)},z.prototype.comparePre=function(e){if(e instanceof z||(e=new z(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return X(n,o)}while(++t)},z.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new z(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(Y(e,t))return null;var r=G(e),n=G(t),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var i="prerelease"}for(var a in r)if(("major"===a||"minor"===a||"patch"===a)&&r[a]!==n[a])return o+a;return i},t.compareIdentifiers=X;var W=/^[0-9]+$/;function X(e,t){var r=W.test(e),n=W.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function Q(e,t,r){return new z(e,r).compare(new z(t,r))}function K(e,t,r){return Q(e,t,r)>0}function J(e,t,r){return Q(e,t,r)<0}function Y(e,t,r){return 0===Q(e,t,r)}function Z(e,t,r){return 0!==Q(e,t,r)}function ee(e,t,r){return Q(e,t,r)>=0}function te(e,t,r){return Q(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Y(e,r,n);case"!=":return Z(e,r,n);case">":return K(e,r,n);case">=":return ee(e,r,n);case"<":return J(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===oe?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return X(t,e)},t.major=function(e,t){return new z(e,t).major},t.minor=function(e,t){return new z(e,t).minor},t.patch=function(e,t){return new z(e,t).patch},t.compare=Q,t.compareLoose=function(e,t){return Q(e,t,!0)},t.rcompare=function(e,t,r){return Q(t,e,r)},t.sort=function(e,r){return e.sort((function(e,n){return t.compare(e,n,r)}))},t.rsort=function(e,r){return e.sort((function(e,n){return t.rcompare(e,n,r)}))},t.gt=K,t.lt=J,t.eq=Y,t.neq=Z,t.gte=ee,t.lte=te,t.cmp=re,t.Comparator=ne;var oe={};function ie(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ie)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ie(e.raw,t);if(e instanceof ne)return new ie(e.value,t);if(!(this instanceof ie))return new ie(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function se(e,t,r,n,o,i,a,s,c,l,u,p,d){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(o)?">="+r+"."+n+".0":">="+t)+" "+(s=ae(c)?"":ae(l)?"<"+(+c+1)+".0.0":ae(u)?"<"+c+"."+(+l+1)+".0":p?"<="+c+"."+l+"."+u+"-"+p:"<="+s)).trim()}function ce(e,t,n){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(r(e[o].semver),e[o].semver!==oe&&e[o].semver.prerelease.length>0){var i=e[o].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}function le(e,t,r){try{t=new ie(t,r)}catch(e){return!1}return t.test(e)}function ue(e,t,r,n){var o,i,a,s,c;switch(e=new z(e,n),t=new ie(t,n),r){case">":o=K,i=te,a=J,s=">",c=">=";break;case"<":o=J,i=ee,a=K,s="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(le(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],p=null,d=null;if(u.forEach((function(e){e.semver===oe&&(e=new ne(">=0.0.0")),p=p||e,d=d||e,o(e.semver,p.semver,n)?p=e:a(e.semver,d.semver,n)&&(d=e)})),p.operator===s||p.operator===c)return!1;if((!d.operator||d.operator===s)&&i(e,d.semver))return!1;if(d.operator===c&&a(e,d.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?o[q]:o[M],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new z(r[2],this.options.loose):this.semver=oe},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===oe||("string"==typeof e&&(e=new z(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new ie(e.value,t),le(this.value,r,t);if(""===e.operator)return r=new ie(this.value,t),le(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||i&&a||s||c},t.Range=ie,ie.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[$]:o[V];e=e.replace(n,se),r("hyphen replace",e),e=e.replace(o[B],"$1$2$3"),r("comparator trim",e,o[B]),e=(e=(e=e.replace(o[N],"$1~")).replace(o[F],"$1^")).split(/\s+/).join(" ");var i=t?o[q]:o[M],a=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[L]:o[O];return e.replace(n,(function(t,n,o,i,a){var s;return r("caret",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":a?(r("replaceCaret pr",a),s="0"===n?"0"===o?">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+"-"+a+" <"+(+n+1)+".0.0"):(r("no pr"),s="0"===n?"0"===o?">="+n+"."+o+"."+i+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+" <"+(+n+1)+".0.0"),r("caret return",s),s}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?o[k]:o[A];return e.replace(n,(function(t,n,o,i,a){var s;return r("tilde",e,t,n,o,i,a),ae(n)?s="":ae(o)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(i)?s=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":a?(r("replaceTilde pr",a),s=">="+n+"."+o+"."+i+"-"+a+" <"+n+"."+(+o+1)+".0"):s=">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0",r("tilde return",s),s}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?o[x]:o[C];return e.replace(n,(function(t,n,o,i,a,s){r("xRange",e,t,n,o,i,a,s);var c=ae(o),l=c||ae(i),u=l||ae(a);return"="===n&&u&&(n=""),c?t=">"===n||"<"===n?"<0.0.0":"*":n&&u?(l&&(i=0),a=0,">"===n?(n=">=",l?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",l?o=+o+1:i=+i+1),t=n+o+"."+i+"."+a):l?t=">="+o+".0.0 <"+(+o+1)+".0.0":u&&(t=">="+o+"."+i+".0 <"+o+"."+(+i+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[H],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(i)}))),a=a.map((function(e){return new ne(e,this.options)}),this)},ie.prototype.intersects=function(e,t){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new ie(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new z(e,this.options));for(var t=0;t<this.set.length;t++)if(ce(this.set[t],e,this.options))return!0;return!1},t.satisfies=le,t.maxSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&-1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minSatisfying=function(e,t,r){var n=null,o=null;try{var i=new ie(t,r)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&1!==o.compare(e)||(o=new z(n=e,r)))})),n},t.minVersion=function(e,t){e=new ie(e,t);var r=new z("0.0.0");if(e.test(r))return r;if(r=new z("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new z(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!K(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},t.validRange=function(e,t){try{return new ie(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return ue(e,t,"<",r)},t.gtr=function(e,t,r){return ue(e,t,">",r)},t.outside=ue,t.prerelease=function(e,t){var r=G(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new ie(e,r),t=new ie(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof z)return e;if("string"!=typeof e)return null;var t=e.match(o[I]);if(null==t)return null;return G(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}},function(e,t,r){var n,o,i=r(62).wrap,a=[],s=0,c=!1,l=[];function u(e,t){var r=e.length,n=t.length,o=[];if(0===r&&0===n)return o;for(var i=0;i<r;i++)o[i]=e[i];if(0===n)return o;for(var a=0;a<n;a++){var s=!0;for(i=0;i<r;i++)if(e[i].uid===t[a].uid){s=!1;break}s&&o.push(t[a])}return o}if(process._fatalException){var p,d=!1;n=function(e){var t=a.length;if(d||0===t)return!1;var r=!1;d=!0;for(var n=0;n<t;++n){var o=a[n];if(0!=(8&o.flags)){var i=p&&p[o.uid];r=o.error(i,e)||r}}return d=!1,l.length>0&&(a=l.pop()),p=void 0,r&&!c},o=function(e,t,r){var n=[];c=!0;for(var o=0;o<r;++o){var i=t[o];if(n[i.uid]=i.data,0!=(1&i.flags)){var s=i.create(i.data);void 0!==s&&(n[i.uid]=s)}}return c=!1,function(){p=n,l.push(a),a=u(t,a),c=!0;for(var o=0;o<r;++o)(2&t[o].flags)>0&&t[o].before(this,n[t[o].uid]);c=!1;var i=e.apply(this,arguments);for(c=!0,o=0;o<r;++o)(4&t[o].flags)>0&&t[o].after(this,n[t[o].uid]);return c=!1,a=l.pop(),p=void 0,i}},i(process,"_fatalException",(function(e){return function(t){return n(t)||e(t)}}))}else{var h=!1;n=function(e){if(h)throw e;for(var t=!1,r=a.length,n=0;n<r;++n){var o=a[n];0!=(8&o.flags)&&(t=o.error(null,e)||t)}if(!t&&c)throw e},o=function(e,t,r){var o=[];c=!0;for(var i=0;i<r;++i){var s=t[i];if(o[s.uid]=s.data,0!=(1&s.flags)){var p=s.create(s.data);void 0!==p&&(o[s.uid]=p)}}return c=!1,function(){var i,s=!1,p=!1;l.push(a),a=u(t,a),c=!0;for(var d=0;d<r;++d)(2&t[d].flags)>0&&t[d].before(this,o[t[d].uid]);c=!1;try{i=e.apply(this,arguments)}catch(e){s=!0;for(d=0;d<r;++d)if(0!=(8&a[d].flags))try{p=a[d].error(o[t[d].uid],e)||p}catch(e){throw h=!0,e}if(!p)throw process.removeListener("uncaughtException",n),process._originalNextTick((function(){process.addListener("uncaughtException",n)})),e}finally{if(!s||p){for(c=!0,d=0;d<r;++d)(4&t[d].flags)>0&&t[d].after(this,o[t[d].uid]);c=!1}a=l.pop()}return i}},process.addListener("uncaughtException",n)}function f(e,t){"function"==typeof e.create&&(this.create=e.create,this.flags|=1),"function"==typeof e.before&&(this.before=e.before,this.flags|=2),"function"==typeof e.after&&(this.after=e.after,this.flags|=4),"function"==typeof e.error&&(this.error=e.error,this.flags|=8),this.uid=++s,this.data=void 0===t?null:t}function m(e,t){if("object"!=typeof e||!e)throw new TypeError("callbacks argument must be an object");return e instanceof f?e:new f(e,t)}f.prototype.create=void 0,f.prototype.before=void 0,f.prototype.after=void 0,f.prototype.error=void 0,f.prototype.data=void 0,f.prototype.uid=0,f.prototype.flags=0,process.createAsyncListener=m,process.addAsyncListener=function(e,t){var r;r=e instanceof f?e:m(e,t);for(var n=!1,o=0;o<a.length;o++)if(r===a[o]){n=!0;break}return n||a.push(r),r},process.removeAsyncListener=function(e){for(var t=0;t<a.length;t++)if(e===a[t]){a.splice(t,1);break}},e.exports=function(e){var t=a.length;if(0===t)return e;for(var r=a.slice(),n=0;n<t;++n)if(r[n].flags>0)return o(e,r,t);return function(e,t,r){c=!0;for(var n=0;n<r;++n){var o=t[n];o.create&&o.create(o.data)}return c=!1,function(){l.push(a),a=u(t,a);var r=e.apply(this,arguments);return a=l.pop(),r}}(e,r,t)}},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("dns")},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";e.exports=(e,t)=>class extends e{constructor(e){var r,n;super((function(e,i){r=this,n=[function(r){return t(o,!1),e(r)},function(e){return t(o,!1),i(e)}]}));var o=this;try{e.apply(r,n)}catch(e){n[1](e)}return o}}},function(e,t,r){"use strict";var n=r(60),o=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(e,t){n.IsInitialized&&(r(251).enable(e&&t,this._client),r(269).enable(e,this._client),r(270).enable(e,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),o=r(5),i=[],a=function(e){var t=e.data.message;i.forEach((function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf("\n")==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?n.SeverityLevel.Warning:n.SeverityLevel.Information}))}))};t.enable=function(e,t){e?(0===i.length&&o.channel.subscribe("console",a),i.push(t)):0===(i=i.filter((function(e){return e!=t}))).length&&o.channel.unsubscribe("console",a)},t.dispose=function(){o.channel.unsubscribe("console",a),i=[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(101),o=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();t.RemoteDependencyDataConstants=o,t.domainSupportsProperties=function(e){return"properties"in e||e instanceof n.EventData||e instanceof n.ExceptionData||e instanceof n.MessageData||e instanceof n.MetricData||e instanceof n.PageViewData||e instanceof n.RemoteDependencyData||e instanceof n.RequestData}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n=function(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"};e.exports=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){return e.call(this)||this}return o(t,e),t}(r(102));e.exports=i},function(e,t,r){"use strict";var n=r(103),o=function(){this.kind=n.Measurement};e.exports=o},function(e,t,r){"use strict";var n=function(){this.ver=1,this.sampleRate=100,this.tags={}};e.exports=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n=function(){this.hasFullStack=!0,this.parsedStack=[]};e.exports=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return o(t,e),t}(r(104));e.exports=i},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return o(t,e),t}(r(19));e.exports=i},function(e,t,r){"use strict";var n;!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n=function(){};e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(268))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.telemetryTypeToBaseType=function(e){switch(e){case n.Event:return"EventData";case n.Exception:return"ExceptionData";case n.Trace:return"MessageData";case n.Metric:return"MetricData";case n.Request:return"RequestData";case n.Dependency:return"RemoteDependencyData";case n.Availability:return"AvailabilityData"}},t.baseTypeToTelemetryType=function(e){switch(e){case"EventData":return n.Event;case"ExceptionData":return n.Exception;case"MessageData":return n.Trace;case"MetricData":return n.Metric;case"RequestData":return n.Request;case"RemoteDependencyData":return n.Dependency;case"AvailabilityData":return n.Availability}},t.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData"},function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability"}(n=t.TelemetryType||(t.TelemetryType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),o=r(5),i=[],a={10:n.SeverityLevel.Verbose,20:n.SeverityLevel.Verbose,30:n.SeverityLevel.Information,40:n.SeverityLevel.Warning,50:n.SeverityLevel.Error,60:n.SeverityLevel.Critical},s=function(e){var t=e.data.result;i.forEach((function(r){var n=a[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})}))};t.enable=function(e,t){e?(0===i.length&&o.channel.subscribe("bunyan",s),i.push(t)):0===(i=i.filter((function(e){return e!=t}))).length&&o.channel.unsubscribe("bunyan",s)},t.dispose=function(){o.channel.unsubscribe("bunyan",s),i=[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),o=r(5),i=[],a={syslog:function(e){var t={emerg:n.SeverityLevel.Critical,alert:n.SeverityLevel.Critical,crit:n.SeverityLevel.Critical,error:n.SeverityLevel.Error,warning:n.SeverityLevel.Warning,notice:n.SeverityLevel.Information,info:n.SeverityLevel.Information,debug:n.SeverityLevel.Verbose};return void 0===t[e]?n.SeverityLevel.Information:t[e]},npm:function(e){var t={error:n.SeverityLevel.Error,warn:n.SeverityLevel.Warning,info:n.SeverityLevel.Information,verbose:n.SeverityLevel.Verbose,debug:n.SeverityLevel.Verbose,silly:n.SeverityLevel.Verbose};return void 0===t[e]?n.SeverityLevel.Information:t[e]},unknown:function(e){return n.SeverityLevel.Information}},s=function(e){var t=e.data.message;i.forEach((function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=a[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}}))};t.enable=function(e,t){e?(0===i.length&&o.channel.subscribe("winston",s),i.push(t)):0===(i=i.filter((function(e){return e!=t}))).length&&o.channel.unsubscribe("winston",s)},t.dispose=function(){o.channel.unsubscribe("winston",s),i=[]}},function(e,t,r){"use strict";var n=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||13===parseInt(r[0])&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;if(!this._exceptionListenerHandle){var n=function(t,n,o){void 0===o&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),t&&n&&1===process.listeners(n).length&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();e.exports=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=r(30),a=r(12),s=r(16),c=r(31),l=r(105),u=r(23),p=function(e){function t(r,n){var o=e.call(this)||this;return n&&n.method&&r&&(o.method=n.method,o.url=t._getUrlFromRequestOptions(r,n),o.startTime=+new Date),o}return o(t,e),t.prototype.onError=function(e){this._setStatus(void 0,e)},t.prototype.onResponse=function(e){this._setStatus(e.statusCode,void 0),this.correlationId=s.getCorrelationContextTarget(e,c.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(e,t){var r=i.parse(this.url);r.search=void 0,r.hash=void 0;var n=this.method.toUpperCase()+" "+r.pathname,o=a.RemoteDependencyDataConstants.TYPE_HTTP,s=r.hostname;this.correlationId?(o=a.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==u.correlationIdPrefix&&(s=r.hostname+" | "+this.correlationId)):o=a.RemoteDependencyDataConstants.TYPE_HTTP,r.port&&(s+=":"+r.port);var c={id:t,name:n,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:o,target:s};if(e){for(var l in e)c[l]||(c[l]=e[l]);if(e.properties)for(var l in e.properties)c.properties[l]=e.properties[l]}return c},t._getUrlFromRequestOptions=function(e,t){if("string"==typeof e)e=i.parse(e);else{var r=e;e={},r&&Object.keys(r).forEach((function(t){e[t]=r[t]}))}if(e.path){var n=i.parse(e.path);e.pathname=n.pathname,e.search=n.search}e.host&&e.port&&(!i.parse("http://"+e.host).port&&e.port&&(e.hostname=e.host,delete e.host));return e.protocol=e.protocol||t.agent&&t.agent.protocol||void 0,e.hostname=e.hostname||"localhost",i.format(e)},t}(l);e.exports=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=[];t.subscriber=function(e){e.data.event.commandName,o.forEach((function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",dependencyTypeName:"mongodb"})}))},t.enable=function(e,r){e?(0===o.length&&n.channel.subscribe("mongodb",t.subscriber),o.push(r)):0===(o=o.filter((function(e){return e!=r}))).length&&n.channel.unsubscribe("mongodb",t.subscriber)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=[];t.subscriber=function(e){o.forEach((function(t){var r=e.data.query||{},n=r.sql||"Unknown query",o=!e.data.err,i=(r._connection||{}).config||{},a=i.socketPath?i.socketPath:(i.host||"localhost")+":"+i.port;t.trackDependency({target:a,data:n,name:n,duration:e.data.duration,success:o,resultCode:o?"0":"1",dependencyTypeName:"mysql"})}))},t.enable=function(e,r){e?(0===o.length&&n.channel.subscribe("mysql",t.subscriber),o.push(r)):0===(o=o.filter((function(e){return e!=r}))).length&&n.channel.unsubscribe("mysql",t.subscriber)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=[];t.subscriber=function(e){o.forEach((function(t){"info"!==e.data.commandObj.command&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",dependencyTypeName:"redis"})}))},t.enable=function(e,r){e?(0===o.length&&n.channel.subscribe("redis",t.subscriber),o.push(r)):0===(o=o.filter((function(e){return e!=r}))).length&&n.channel.unsubscribe("redis",t.subscriber)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=[];t.subscriber=function(e){o.forEach((function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",o=!e.data.error,i=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:i,data:n,name:n,duration:e.data.duration,success:o,resultCode:o?"0":"1",dependencyTypeName:"postgres"})}))},t.enable=function(e,r){e?(0===o.length&&n.channel.subscribe("postgres",t.subscriber),o.push(r)):0===(o=o.filter((function(e){return e!=r}))).length&&n.channel.unsubscribe("postgres",t.subscriber)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=r(30),a=r(12),s=r(16),c=r(31),l=r(105),u=r(23),p=r(278),d=r(106),h=function(e){function t(t,r){var n=e.call(this)||this;return t&&(n.method=t.method,n.url=n._getAbsoluteUrl(t),n.startTime=+new Date,n.socketRemoteAddress=t.socket&&t.socket.remoteAddress,n.parseHeaders(t,r),t.connection&&(n.connectionRemoteAddress=t.connection.remoteAddress,n.legacySocketRemoteAddress=t.connection.socket&&t.connection.socket.remoteAddress)),n}return o(t,e),t.prototype.onError=function(e,t){this._setStatus(void 0,e),t&&(this.duration=t)},t.prototype.onResponse=function(e,t){this._setStatus(e.statusCode,void 0),t&&(this.duration=t)},t.prototype.getRequestTelemetry=function(e){var t={id:this.requestId,name:this.method+" "+i.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(e){for(var r in e)t[r]||(t[r]=e[r]);if(e.properties)for(var r in e.properties)t.properties[r]=e.properties[r]}return t},t.prototype.getRequestTags=function(e){var r={};for(var n in e)r[n]=e[n];return r[t.keys.locationIp]=e[t.keys.locationIp]||this._getIp(),r[t.keys.sessionId]=e[t.keys.sessionId]||this._getId("ai_session"),r[t.keys.userId]=e[t.keys.userId]||this._getId("ai_user"),r[t.keys.userAuthUserId]=e[t.keys.userAuthUserId]||this._getId("ai_authUser"),r[t.keys.operationName]=this.getOperationName(e),r[t.keys.operationParentId]=this.getOperationParentId(e),r[t.keys.operationId]=this.getOperationId(e),r},t.prototype.getOperationId=function(e){return e[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(e){return e[t.keys.operationParentId]||this.parentId||this.getOperationId(e)},t.prototype.getOperationName=function(e){return e[t.keys.operationName]||this.method+" "+i.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(e){if(!e.headers)return e.url;var t=e.connection?e.connection.encrypted:null,r=i.parse(e.url),n=r.pathname,o=r.search;return i.format({protocol:t?"https":"http",host:e.headers.host,pathname:n,search:o})},t.prototype._getIp=function(){var e=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,t=function(t){var r=e.exec(t);if(r)return r[0]},r=t(this.rawHeaders["x-forwarded-for"])||t(this.rawHeaders["x-client-ip"])||t(this.rawHeaders["x-real-ip"])||t(this.connectionRemoteAddress)||t(this.socketRemoteAddress)||t(this.legacySocketRemoteAddress);return!r&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&"::"===this.connectionRemoteAddress.substr(0,2)&&(r="127.0.0.1"),r},t.prototype._getId=function(e){var r=this.rawHeaders&&this.rawHeaders.cookie&&"string"==typeof this.rawHeaders.cookie&&this.rawHeaders.cookie||"";return t.parseId(s.getCookie(e,r))},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(e,t){if(this.rawHeaders=e.headers||e.rawHeaders,this.userAgent=e.headers&&e.headers["user-agent"],this.sourceCorrelationId=s.getCorrelationContextTarget(e,c.requestContextSourceKey),e.headers){var r=e.headers[c.traceStateHeader],n=e.headers[c.traceparentHeader],o=e.headers[c.requestIdHeader],i=e.headers[c.parentIdHeader],a=e.headers[c.rootIdHeader];this.correlationContextHeader=e.headers[c.correlationContextHeader],u.w3cEnabled&&(n||r)?(this.traceparent=new d(n),this.tracestate=n&&r&&new p(r),this.setBackCompatFromThisTraceContext()):o?u.w3cEnabled?(this.traceparent=new d(null,o),this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=u.generateRequestId(this.parentId),this.operationId=u.getRootId(this.requestId)):u.w3cEnabled?(this.traceparent=new d,this.traceparent.parentId=i,this.traceparent.legacyRootId=a||i,this.setBackCompatFromThisTraceContext()):(this.parentId=i,this.requestId=u.generateRequestId(a||this.parentId),this.correlationContextHeader=null,this.operationId=u.getRootId(this.requestId)),t&&(this.requestId=t,this.operationId=u.getRootId(this.requestId))}},t.parseId=function(e){var t=e.split("|");return t.length>0?t[0]:""},t.keys=new a.ContextTagKeys,t}(l);e.exports=h},function(e,t,r){"use strict";var n=function(){function e(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return e.prototype.toString=function(){var e=this.fieldmap;return e&&0!=e.length?e.join(", "):null},e.validateKeyChars=function(e){var t=e.split("@");if(2==t.length){var r=t[0].trim(),n=t[1].trim(),o=Boolean(r.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),i=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return o&&i}return 1==t.length&&Boolean(e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/))},e.prototype.parseHeader=function(t){var r=[],n={},o=t.split(",");if(o.length>32)return null;for(var i=0,a=o;i<a.length;i++){var s=a[i].trim();if(0!==s.length){var c=s.split("=");if(2!==c.length)return null;if(!e.validateKeyChars(c[0]))return null;if(n[c[0]])return null;n[c[0]]=!0,r.push(s)}}return r},e.strict=!0,e}();e.exports=n},function(e,t,r){"use strict";var n=r(7),o=r(64),i=r(281),a=r(282),s=r(29),c=r(65),l=function(){function e(e,t){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new o(e),this.context=t||new c,this._sender=new a(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(e){this._collectors.push(e)},e.prototype.trackMetric=function(e){this._addMetric(e)},e.prototype.addDocument=function(e){var t=i.telemetryEnvelopeToQuickPulseDocument(e);t&&this._documents.push(t)},e.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(e){this._collectors.forEach((function(t){t.enable(e)}))},e.prototype._addMetric=function(e){var t=e.value,r=e.count||1,n=s.PerformanceToQuickPulseCounter[e.name];n&&(this._metrics[n]?(this._metrics[n].Value=(this._metrics[n].Value*this._metrics[n].Weight+t*r)/(this._metrics[n].Weight+r),this._metrics[n].Weight+=r):(this._metrics[n]=i.createQuickPulseMetric(e),this._metrics[n].Name=n,this._metrics[n].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){var t=this,r=Object.keys(this._metrics).map((function(e){return t._metrics[e]})),n=i.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var o=this._isCollectingData?e.POST_INTERVAL:e.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref()},e.prototype._ping=function(e){this._sender.ping(e,this._quickPulseDone.bind(this))},e.prototype._post=function(e){this._sender.post(e,this._quickPulseDone.bind(this))},e.prototype._quickPulseDone=function(e,t){null!=e?(this._isCollectingData!==e&&(n.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,t&&t.statusCode<300&&t.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();e.exports=l},function(e,t,r){"use strict";var n=r(29),o=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR).reduce((function(t,r){var n=r.split(e._FIELD_KEY_VALUE_SEPARATOR);if(2===n.length){var o=n[0].toLowerCase(),i=n[1];t[o]=i}return t}),{});if(Object.keys(r).length>0){if(r.endpointsuffix){var o=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+o+"dc."+r.endpointsuffix,r.liveendpoint=r.liveendpoint||"https://"+o+"live."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||n.DEFAULT_BREEZE_ENDPOINT,r.liveendpoint=r.liveendpoint||n.DEFAULT_LIVEMETRICS_ENDPOINT}return r},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();e.exports=o},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o=r(9),i=r(12),a=r(29),s=r(16),c=r(7),l=s.w3cTraceId(),u=function(){function e(){}return e.createQuickPulseEnvelope=function(e,t,r,n){var i=o&&"function"==typeof o.hostname&&o.hostname()||"Unknown",a=n.tags&&n.keys&&n.keys.cloudRoleInstance&&n.tags[n.keys.cloudRoleInstance]||i;return{Documents:t.length>0?t:null,InstrumentationKey:r.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:n.tags[n.keys.internalSdkVersion],StreamId:l,MachineName:i,Instance:a}},e.createQuickPulseMetric=function(e){return{Name:e.name,Value:e.value,Weight:e.count||1}},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case i.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case i.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case i.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case i.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case i.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),o=t.data.baseData.name;return n({},r,{Name:o})},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),o=t.data.baseData.severityLevel||0;return n({},r,{Message:t.data.baseData.message,SeverityLevel:i.SeverityLevel[o]})},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),o=t.data.baseData.exceptions,i="",a="",s="";return o&&o.length>0&&(o[0].parsedStack&&o[0].parsedStack.length>0?o[0].parsedStack.forEach((function(e){i+=e.assembly+"\n"})):o[0].stack&&o[0].stack.length>0&&(i=o[0].stack),a=o[0].message,s=o[0].typeName),n({},r,{Exception:i,ExceptionMessage:a,ExceptionType:s})},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),o=t.data.baseData;return n({},r,{Name:o.name,Success:o.success,Duration:o.duration,ResponseCode:o.responseCode,OperationName:o.name})},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),o=t.data.baseData;return n({},r,{Name:o.name,Target:o.target,Success:o.success,Duration:o.duration,ResultCode:o.resultCode,CommandName:o.data,OperationName:r.OperationId,DependencyTypeName:o.type})},e.createQuickPulseDocument=function(t){var r,n;return t.data.baseType?(n=a.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=a.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):c.warn("Document type invalid; not sending live metric document",t.data.baseType),{DocumentType:r,__type:n,OperationId:t.tags[e.keys.operationId],Version:"1.0",Properties:e.aggregateProperties(t)}},e.aggregateProperties=function(e){var t=[],r=e.data.baseData.measurements||{};for(var n in r)if(r.hasOwnProperty(n)){var o={key:n,value:r[n]};t.push(o)}var i=e.data.baseData.properties||{};for(var n in i)if(i.hasOwnProperty(n)){o={key:n,value:i[n]};t.push(o)}return t},e.keys=new i.ContextTagKeys,e}();e.exports=u},function(e,t,r){"use strict";var n=r(41),o=r(40),i=r(7),a="POST",s="x-ms-qps-transmission-time",c="x-ms-qps-subscribed",l=function(){function e(e){this._config=e,this._consecutiveErrors=0}return e.prototype.ping=function(e,t){this._submitData(e,t,"ping")},e.prototype.post=function(e,t){this._submitData([e],t,"post")},e.prototype._submitData=function(t,r,l){var u,p,d=this,h=JSON.stringify(t),f=((u={})[o.disableCollectionRequestOption]=!0,u.host=this._config.quickPulseHost,u.method=a,u.path="/QuickPulseService.svc/"+l+"?ikey="+this._config.instrumentationKey,u.headers=((p={Expect:"100-continue"})[s]=1e4*Date.now(),p["Content-Type"]="application/json",p["Content-Length"]=Buffer.byteLength(h),p),u),m=n.request(f,(function(e){var t="true"===e.headers[c];d._consecutiveErrors=0,r(t,e)}));m.on("error",(function(t){d._consecutiveErrors++;var n="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";d._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN==0?(n="Live Metrics endpoint could not be reached "+d._consecutiveErrors+" consecutive times. Most recent error:",i.warn(e.TAG,n,t)):i.info(e.TAG,n,t),r()})),m.write(h),m.end()},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();e.exports=l},function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(64),i=r(65),a=r(7),s=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>=6},e.prototype.enable=function(t,n,o){var i=this;if(void 0===n&&(n={}),void 0===o&&(o=6e4),e.isNodeVersionCompatible()){if(null==e._metricsAvailable&&t&&!this._isInitialized)try{var s=r(284);e._emitter=new s,e._metricsAvailable=!0,a.info("Native metrics module successfully loaded!")}catch(t){return void(e._metricsAvailable=!1)}this._isEnabled=t,this._disabledMetrics=n,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,o),this._handle=setInterval((function(){return i._trackNativeMetrics()}),o),this._handle.unref()):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(e){var t=process.env[o.ENV_nativeMetricsDisableAll],r=process.env[o.ENV_nativeMetricsDisablers];if(t)return{isEnabled:!1,disabledMetrics:{}};if(r){var i=r.split(","),a={};if(i.length>0)for(var s=0,c=i;s<c.length;s++){a[c[s]]=!0}return"object"==typeof e?{isEnabled:!0,disabledMetrics:n({},e,a)}:{isEnabled:e,disabledMetrics:a}}return"boolean"==typeof e?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},e.prototype._trackNativeMetrics=function(){var e=!0;"object"!=typeof this._isEnabled&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var t,r=e._emitter.getGCData();for(var n in r){var o=r[n].metrics,a=n+" Garbage Collection Duration",s=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:a,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:s,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,t)})}}},e.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var t=e._emitter.getLoopData().loopUsage;if(0!=t.count){var r,n=Math.sqrt(t.sumSquares/t.count-Math.pow(t.total/t.count,2))||0;this._client.trackMetric({name:"Event Loop CPU Time",value:t.total,count:t.count,min:t.min,max:t.max,stdDev:n,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,r)})}}},e.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var e,t,r,n=process.memoryUsage(),o=n.heapUsed,a=n.heapTotal,s=n.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:o,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:a,count:1,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,t)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:s-a,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+i.sdkVersion,r)})}},e}();t.AutoCollectNativePerformance=s},function(e,t){e.exports=require("applicationinsights-native-metrics")},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=r(286),a=r(107),s=r(40),c=r(7),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.trackNodeHttpRequestSync=function(e){e&&e.request&&e.response&&e.duration?a.trackRequestSync(this,e):c.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(e){(e.duration||e.error)&&c.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),e&&e.request&&e.response?a.trackRequest(this,e):c.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(e){e&&e.request?s.trackRequest(this,e):c.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(i);e.exports=l},function(e,t,r){"use strict";var n=r(30),o=r(64),i=r(65),a=r(12),s=r(287),c=r(288),l=r(28),u=r(291),p=r(16),d=r(7),h=r(292),f=function(){function e(e){this._telemetryProcessors=[];var t=new o(e);this.config=t,this.context=new i,this.commonProperties={};var r=new u(this.config);this.channel=new s((function(){return t.disableAppInsights}),(function(){return t.maxBatchSize}),(function(){return t.maxBatchIntervalMs}),r)}return e.prototype.trackAvailability=function(e){this.track(e,a.TelemetryType.Availability)},e.prototype.trackTrace=function(e){this.track(e,a.TelemetryType.Trace)},e.prototype.trackMetric=function(e){this.track(e,a.TelemetryType.Metric)},e.prototype.trackException=function(e){e&&e.exception&&!p.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,a.TelemetryType.Exception)},e.prototype.trackEvent=function(e){this.track(e,a.TelemetryType.Event)},e.prototype.trackRequest=function(e){this.track(e,a.TelemetryType.Request)},e.prototype.trackDependency=function(e){e&&!e.target&&e.data&&(e.target=n.parse(e.data).host),this.track(e,a.TelemetryType.Dependency)},e.prototype.flush=function(e){this.channel.triggerSend(!!e&&!!e.isAppCrashing,e?e.callback:void 0)},e.prototype.track=function(e,t){if(e&&a.telemetryTypeToBaseType(t)){var r=h.createEnvelope(e,t,this.commonProperties,this.context,this.config);e.time&&(r.time=e.time.toISOString());var n=this.runTelemetryProcessors(r,e.contextObjects);n=n&&c.samplingTelemetryProcessor(r,{correlationContext:l.CorrelationContextManager.getCurrentContext()}),c.performanceMetricsTelemetryProcessor(r,this.quickPulseClient),n&&this.channel.send(r)}else d.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(e,t){var r=!0,n=this._telemetryProcessors.length;if(0===n)return r;(t=t||{}).correlationContext=l.CorrelationContextManager.getCurrentContext();for(var o=0;o<n;++o)try{var i=this._telemetryProcessors[o];if(i&&!1===i.apply(null,[e,t])){r=!1;break}}catch(t){r=!0,d.warn("One of telemetry processors failed, telemetry item will be sent.",t,e)}return r},e}();e.exports=f},function(e,t,r){"use strict";var n=r(7),o=function(){function e(e,t,r,n){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=t,this._getBatchIntervalMs=r,this._sender=n}return e.prototype.setUseDiskRetryCaching=function(e,t,r){this._sender.setDiskRetryMode(e,t,r)},e.prototype.send=function(e){var t=this;if(!this._isDisabled())if(e){var r=this._stringify(e);"string"==typeof r&&(this._buffer.push(r),this._buffer.length>=this._getBatchSize()?this.triggerSend(!1):!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout((function(){t._timeoutHandle=null,t.triggerSend(!1)}),this._getBatchIntervalMs())))}else n.warn("Cannot send null/undefined telemetry")},e.prototype.triggerSend=function(e,t){var r=this._buffer.length<1;if(!r){var n=this._buffer.join("\n");e?(this._sender.saveOnCrash(n),"function"==typeof t&&t("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(n):new Buffer(n),t)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,r&&"function"==typeof t&&t("no data to send")},e.prototype._stringify=function(e){try{return JSON.stringify(e)}catch(t){n.warn("Failed to serialize payload",t,e)}},e}();e.exports=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(289)),n(r(290))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);function o(e){var t=5381;if(!e)return 0;for(;e.length<8;)e+=e;for(var r=0;r<e.length;r++)t=((t<<5)+t|0)+e.charCodeAt(r)|0;return(t=t<=-2147483648?2147483647:Math.abs(t))/2147483647*100}t.samplingTelemetryProcessor=function(e,t){var r=e.sampleRate;return null==r||r>=100||(!(!e.data||n.TelemetryType.Metric!==n.baseTypeToTelemetryType(e.data.baseType))||(t.correlationContext&&t.correlationContext.operation?o(t.correlationContext.operation.id)<r:100*Math.random()<r))},t.getSamplingHashCode=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(63),o=r(12);t.performanceMetricsTelemetryProcessor=function(e,t){switch(t&&t.addDocument(e),e.data.baseType){case o.TelemetryTypeString.Exception:n.countException();break;case o.TelemetryTypeString.Request:var r=e.data.baseData;n.countRequest(r.duration,r.success);break;case o.TelemetryTypeString.Dependency:var i=e.data.baseData;n.countDependency(i.duration,i.success)}return!0}},function(e,t,r){"use strict";var n=r(4),o=r(9),i=r(0),a=r(100),s=r(39),c=r(7),l=r(40),u=r(16),p=function(){function e(t,r,o){if(this._config=t,this._onSuccess=r,this._onError=o,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=n.existsSync(e.ICACLS_PATH)}catch(e){}e.OS_PROVIDES_FILE_PROTECTION||c.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,"number"==typeof r&&r>=0&&(this._resendInterval=Math.floor(r)),"number"==typeof n&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,c.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},e.prototype.send=function(t,r){var n=this,o=this._config.endpointUrl,i={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};a.gzip(t,(function(a,s){var p=s;a?(c.warn(a),p=t,i.headers["Content-Length"]=t.length.toString()):(i.headers["Content-Encoding"]="gzip",i.headers["Content-Length"]=s.length),c.info(e.TAG,i),i[l.disableCollectionRequestOption]=!0;var d=u.makeRequest(n._config,o,i,(function(o){o.setEncoding("utf-8");var i="";o.on("data",(function(e){i+=e})),o.on("end",(function(){n._numConsecutiveFailures=0,c.info(e.TAG,i),"function"==typeof n._onSuccess&&n._onSuccess(i),"function"==typeof r&&r(i),n._enableDiskRetryMode&&(200===o.statusCode?setTimeout((function(){return n._sendFirstFileOnDisk()}),n._resendInterval).unref():408!==o.statusCode&&429!==o.statusCode&&439!==o.statusCode&&500!==o.statusCode&&503!==o.statusCode||n._storeToDisk(t))}))}));d.on("error",(function(o){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var i="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(i="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),c.warn(e.TAG,i,o)}else{i="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";c.info(e.TAG,i,o)}if(n._onErrorHelper(o),"function"==typeof r){var a="error sending telemetry";o&&"function"==typeof o.toString&&(a=o.toString()),r(a)}n._enableDiskRetryMode&&n._storeToDisk(t)})),d.write(p),d.end()}))},e.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(e)},e.prototype._runICACLS=function(t,r){var n=s.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",(function(e){return r(e)})),n.on("close",(function(e,t){return r(0===e?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+e+")"))}))},e.prototype._runICACLSSync=function(t){if(!s.spawnSync)throw new Error("Could not synchronously call ICACLS under current version of Node.js");var r=s.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(0!==r.status)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=s.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",(function(e){return n+=e})),r.on("error",(function(e){return t(e,null)})),r.on("close",(function(r,o){return e.ACL_IDENTITY=n&&n.trim(),t(0===r?null:new Error("Getting ACL identity did not succeed (PS returned code "+r+")"),e.ACL_IDENTITY)}))},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(s.spawnSync){var t=s.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(0!==t.status)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(e,t){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",t+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;return e.USE_ICACLS?void 0!==e.ACLED_DIRECTORIES[t]?r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)")):(e.ACLED_DIRECTORIES[t]=!1,void this._getACLIdentity((function(o,i){if(o)return e.ACLED_DIRECTORIES[t]=!1,r(o);n._runICACLS(n._getACLArguments(t,i),(function(n){return e.ACLED_DIRECTORIES[t]=!n,r(n)}))}))):r(null)},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(void 0===e.ACLED_DIRECTORIES[t])return this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),void(e.ACLED_DIRECTORIES[t]=!0);if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(e,t){var r=this;n.lstat(e,(function(o,i){o&&"ENOENT"===o.code?n.mkdir(e,(function(n){n&&"EEXIST"!==n.code?t(n):r._applyACLRules(e,t)})):!o&&i.isDirectory()?r._applyACLRules(e,t):t(o||new Error("Path existed but was not a directory"))}))},e.prototype._getShallowDirectorySize=function(e,t){n.readdir(e,(function(r,o){if(r)return t(r,-1);var a=null,s=0,c=0;if(0!==o.length)for(var l=0;l<o.length;l++)n.stat(i.join(e,o[l]),(function(e,r){c++,e?a=e:r.isFile()&&(s+=r.size),c===o.length&&t(a,a?-1:s)}));else t(null,0)}))},e.prototype._getShallowDirectorySizeSync=function(e){for(var t=n.readdirSync(e),r=0,o=0;o<t.length;o++)r+=n.statSync(i.join(e,t[o])).size;return r},e.prototype._storeToDisk=function(t){var r=this,a=i.join(o.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);c.info(e.TAG,"Checking existance of data storage directory: "+a),this._confirmDirExists(a,(function(o){if(o)return c.warn(e.TAG,"Error while checking/creating directory: "+(o&&o.message)),void r._onErrorHelper(o);r._getShallowDirectorySize(a,(function(o,s){if(o||s<0)return c.warn(e.TAG,"Error while checking directory size: "+(o&&o.message)),void r._onErrorHelper(o);if(s>r._maxBytesOnDisk)c.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+s);else{var l=(new Date).getTime()+".ai.json",u=i.join(a,l);c.info(e.TAG,"saving data to disk at: "+u),n.writeFile(u,t,{mode:384},(function(e){return r._onErrorHelper(e)}))}}))}))},e.prototype._storeToDiskSync=function(t){var r=i.join(o.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);try{c.info(e.TAG,"Checking existance of data storage directory: "+r),n.existsSync(r)||n.mkdirSync(r),this._applyACLRulesSync(r);var a=this._getShallowDirectorySizeSync(r);if(a>this._maxBytesOnDisk)return void c.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);var s=(new Date).getTime()+".ai.json",l=i.join(r,s);c.info(e.TAG,"saving data before crash to disk at: "+l),n.writeFileSync(l,t,{mode:384})}catch(t){c.warn(e.TAG,"Error while saving data to disk: "+(t&&t.message)),this._onErrorHelper(t)}},e.prototype._sendFirstFileOnDisk=function(){var t=this,r=i.join(o.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);n.exists(r,(function(e){e&&n.readdir(r,(function(e,o){if(e)t._onErrorHelper(e);else if((o=o.filter((function(e){return i.basename(e).indexOf(".ai.json")>-1}))).length>0){var a=o[0],s=i.join(r,a);n.readFile(s,(function(e,r){e?t._onErrorHelper(e):n.unlink(s,(function(e){e?t._onErrorHelper(e):t.send(r)}))}))}}))}))},e.prototype._onErrorHelper=function(e){"function"==typeof this._onError&&this._onError(e)},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=6e4,e.MAX_BYTES_ON_DISK=5e7,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS="Windows_NT"===o.type(),e}();e.exports=p},function(e,t,r){"use strict";var n=r(12),o=r(16),i=r(28),a=function(){function e(){}return e.createEnvelope=function(t,r,i,a,s){var c=null;switch(r){case n.TelemetryType.Trace:c=e.createTraceData(t);break;case n.TelemetryType.Dependency:c=e.createDependencyData(t);break;case n.TelemetryType.Event:c=e.createEventData(t);break;case n.TelemetryType.Exception:c=e.createExceptionData(t);break;case n.TelemetryType.Request:c=e.createRequestData(t);break;case n.TelemetryType.Metric:c=e.createMetricData(t);break;case n.TelemetryType.Availability:c=e.createAvailabilityData(t)}if(i&&n.domainSupportsProperties(c.baseData)){if(c&&c.baseData)if(c.baseData.properties)for(var l in i)c.baseData.properties[l]||(c.baseData.properties[l]=i[l]);else c.baseData.properties=i;c.baseData.properties=o.validateStringMap(c.baseData.properties)}var u=s&&s.instrumentationKey||"",p=new n.Envelope;return p.data=c,p.iKey=u,p.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+c.baseType.substr(0,c.baseType.length-4),p.tags=this.getTags(a,t.tagOverrides),p.time=(new Date).toISOString(),p.ver=1,p.sampleRate=s?s.samplingPercentage:100,r===n.TelemetryType.Metric&&(p.sampleRate=100),p},e.createTraceData=function(e){var t=new n.MessageData;t.message=e.message,t.properties=e.properties,isNaN(e.severity)?t.severityLevel=n.SeverityLevel.Information:t.severityLevel=e.severity;var r=new n.Data;return r.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Trace),r.baseData=t,r},e.createDependencyData=function(e){var t=new n.RemoteDependencyData;"string"==typeof e.name&&(t.name=e.name.length>1024?e.name.slice(0,1021)+"...":e.name),t.data=e.data,t.target=e.target,t.duration=o.msToTimeSpan(e.duration),t.success=e.success,t.type=e.dependencyTypeName,t.properties=e.properties,t.resultCode=e.resultCode?e.resultCode+"":"",e.id?t.id=e.id:t.id=o.w3cTraceId();var r=new n.Data;return r.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Dependency),r.baseData=t,r},e.createEventData=function(e){var t=new n.EventData;t.name=e.name,t.properties=e.properties,t.measurements=e.measurements;var r=new n.Data;return r.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Event),r.baseData=t,r},e.createExceptionData=function(e){var t=new n.ExceptionData;t.properties=e.properties,isNaN(e.severity)?t.severityLevel=n.SeverityLevel.Error:t.severityLevel=e.severity,t.measurements=e.measurements,t.exceptions=[];var r=e.exception.stack,i=new n.ExceptionDetails;i.message=e.exception.message,i.typeName=e.exception.name,i.parsedStack=this.parseStack(r),i.hasFullStack=o.isArray(i.parsedStack)&&i.parsedStack.length>0,t.exceptions.push(i);var a=new n.Data;return a.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Exception),a.baseData=t,a},e.createRequestData=function(e){var t=new n.RequestData;e.id?t.id=e.id:t.id=o.w3cTraceId(),t.name=e.name,t.url=e.url,t.source=e.source,t.duration=o.msToTimeSpan(e.duration),t.responseCode=e.resultCode?e.resultCode+"":"",t.success=e.success,t.properties=e.properties;var r=new n.Data;return r.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Request),r.baseData=t,r},e.createMetricData=function(e){var t=new n.MetricData;t.metrics=[];var r=new n.DataPoint;r.count=isNaN(e.count)?1:e.count,r.kind=n.DataPointType.Aggregation,r.max=isNaN(e.max)?e.value:e.max,r.min=isNaN(e.min)?e.value:e.min,r.name=e.name,r.stdDev=isNaN(e.stdDev)?0:e.stdDev,r.value=e.value,t.metrics.push(r),t.properties=e.properties;var o=new n.Data;return o.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Metric),o.baseData=t,o},e.createAvailabilityData=function(e){var t=new n.AvailabilityData;e.id?t.id=e.id:t.id=o.w3cTraceId(),t.name=e.name,t.duration=o.msToTimeSpan(e.duration),t.success=e.success,t.runLocation=e.runLocation,t.message=e.message,t.measurements=e.measurements,t.properties=e.properties;var r=new n.Data;return r.baseType=n.telemetryTypeToBaseType(n.TelemetryType.Availability),r.baseData=t,r},e.getTags=function(e,t){var r=i.CorrelationContextManager.getCurrentContext(),n={};if(e&&e.tags)for(var o in e.tags)n[o]=e.tags[o];if(t)for(var o in t)n[o]=t[o];return r&&(n[e.keys.operationId]=n[e.keys.operationId]||r.operation.id,n[e.keys.operationName]=n[e.keys.operationName]||r.operation.name,n[e.keys.operationParentId]=n[e.keys.operationParentId]||r.operation.parentId),n},e.parseStack=function(e){var t=void 0;if("string"==typeof e){var r=e.split("\n");t=[];for(var n=0,o=0,i=0;i<=r.length;i++){var a=r[i];if(s.regex.test(a)){var c=new s(r[i],n++);o+=c.sizeInBytes,t.push(c)}}if(o>32768)for(var l=0,u=t.length-1,p=0,d=l,h=u;l<u;){if((p+=t[l].sizeInBytes+t[u].sizeInBytes)>32768){var f=h-d+1;t.splice(d,f);break}d=l,h=u,l++,u--}}return t},e}(),s=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=o.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=o.trim(n[2])||this.method,this.fileName=o.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}();e.exports=a},function(e,t){t.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",auml:"",Aring:"",aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:" ",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}},function(e,t){var r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+r.source+n.source+"*(?::"+r.source+n.source+"*)?$");function i(){}function a(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function s(e,t,r,n,o,i){for(var a,s=++t,c=0;;){var l=e.charAt(s);switch(l){case"=":if(1===c)a=e.slice(t,s),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(i.warning('attribute value must after "="'),a=e.slice(t,s)),t=s+1,!((s=e.indexOf(l,t))>0))throw new Error("attribute value no end '"+l+"' match");u=e.slice(t,s).replace(/&#?\w+;/g,o),r.add(a,u,t-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');u=e.slice(t,s).replace(/&#?\w+;/g,o),r.add(a,u,t),i.warning('attribute "'+a+'" missed start quot('+l+")!!"),t=s+1,c=5}break;case"/":switch(c){case 0:r.setTagName(e.slice(t,s));case 5:case 6:case 7:c=7,r.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),0==c&&r.setTagName(e.slice(t,s)),s;case">":switch(c){case 0:r.setTagName(e.slice(t,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(u=e.slice(t,s)).slice(-1)&&(r.closed=!0,u=u.slice(0,-1));case 2:2===c&&(u=a),4==c?(i.warning('attribute "'+u+'" missed quot(")!!'),r.add(a,u.replace(/&#?\w+;/g,o),t)):("http://www.w3.org/1999/xhtml"===n[""]&&u.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),r.add(u,u,t));break;case 3:throw new Error("attribute value missed!!")}return s;case"":l=" ";default:if(l<=" ")switch(c){case 0:r.setTagName(e.slice(t,s)),c=6;break;case 1:a=e.slice(t,s),c=2;break;case 4:var u=e.slice(t,s).replace(/&#?\w+;/g,o);i.warning('attribute "'+u+'" missed quot(")!!'),r.add(a,u,t);case 5:c=6}else switch(c){case 2:r.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&a.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),r.add(a,a,t),t=s,c=1;break;case 5:i.warning('attribute space is required"'+a+'"!!');case 6:c=1,t=s;break;case 3:c=4,t=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function c(e,t,r){for(var n=e.tagName,o=null,i=e.length;i--;){var a=e[i],s=a.qName,c=a.value;if((h=s.indexOf(":"))>0)var l=a.prefix=s.slice(0,h),u=s.slice(h+1),d="xmlns"===l&&u;else u=s,l=null,d="xmlns"===s&&"";a.localName=u,!1!==d&&(null==o&&(o={},p(r,r={})),r[d]=o[d]=c,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,c))}for(i=e.length;i--;){(l=(a=e[i]).prefix)&&("xml"===l&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(a.uri=r[l||""]))}var h;(h=n.indexOf(":"))>0?(l=e.prefix=n.slice(0,h),u=e.localName=n.slice(h+1)):(l=null,u=e.localName=n);var f=e.uri=r[l||""];if(t.startElement(f,u,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=o,!0;if(t.endElement(f,u,n),o)for(l in o)t.endPrefixMapping(l)}function l(e,t,r,n,o){if(/^(?:script|textarea)$/i.test(r)){var i=e.indexOf("</"+r+">",t),a=e.substring(t+1,i);if(/[&<]/.test(a))return/^script$/i.test(r)?(o.characters(a,0,a.length),i):(a=a.replace(/&#?\w+;/g,n),o.characters(a,0,a.length),i)}return t+1}function u(e,t,r,n){var o=n[r];return null==o&&((o=e.lastIndexOf("</"+r+">"))<t&&(o=e.lastIndexOf("</"+r)),n[r]=o),o<t}function p(e,t){for(var r in e)t[r]=e[r]}function d(e,t,r,n){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(o=e.indexOf("--\x3e",t+4))>t?(r.comment(e,t+4,o-t-4),o+3):(n.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,o-t-9),r.endCDATA(),o+3}var i=function(e,t){var r,n=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;o.lastIndex=t,o.exec(e);for(;r=o.exec(e);)if(n.push(r),r[1])return n}(e,t),a=i.length;if(a>1&&/!doctype/i.test(i[0][0])){var s=i[1][0],c=a>3&&/^public$/i.test(i[2][0])&&i[3][0],l=a>4&&i[4][0],u=i[a-1];return r.startDTD(s,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),u.index+u[0].length}}return-1}function h(e,t,r){var n=e.indexOf("?>",t);if(n){var o=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return r.processingInstruction(o[1],o[2]),n+2}return-1}return-1}function f(e){}i.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),p(t,t={}),function(e,t,r,n,o){function i(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function p(t){if(t>E){var r=e.substring(E,t).replace(/&#?\w+;/g,i);b&&m(E),n.characters(r,0,t-E),E=t}}function m(t,r){for(;t>=y&&(r=v.exec(e));)g=r.index,y=g+r[0].length,b.lineNumber++;b.columnNumber=t-g+1}var g=0,y=0,v=/.*(?:\r\n?|\n)|.*$/g,b=n.locator,w=[{currentNSMap:t}],S={},E=0;for(;;){try{var P=e.indexOf("<",E);if(P<0){if(!e.substr(E).match(/^\s*$/)){var T=n.doc,_=T.createTextNode(e.substr(E));T.appendChild(_),n.currentElement=_}return}switch(P>E&&p(P),e.charAt(P+1)){case"/":var D=e.indexOf(">",P+3),C=e.substring(P+2,D),x=w.pop();D<0?(C=e.substring(P+2).replace(/[\s<].*/,""),o.error("end tag name: "+C+" is not complete:"+x.tagName),D=P+1+C.length):C.match(/\s</)&&(C=C.replace(/[\s<].*/,""),o.error("end tag name: "+C+" maybe not complete"),D=P+1+C.length);var I=x.localNSMap,j=x.tagName==C;if(j||x.tagName&&x.tagName.toLowerCase()==C.toLowerCase()){if(n.endElement(x.uri,x.localName,C),I)for(var N in I)n.endPrefixMapping(N);j||o.fatalError("end tag name: "+C+" is not match the current start tagName:"+x.tagName)}else w.push(x);D++;break;case"?":b&&m(P),D=h(e,P,n);break;case"!":b&&m(P),D=d(e,P,n,o);break;default:b&&m(P);var A=new f,k=w[w.length-1].currentNSMap,R=(D=s(e,P,A,k,i,o),A.length);if(!A.closed&&u(e,D,A.tagName,S)&&(A.closed=!0,r.nbsp||o.warning("unclosed xml attribute")),b&&R){for(var F=a(b,{}),O=0;O<R;O++){var L=A[O];m(L.offset),L.locator=a(b,{})}n.locator=F,c(A,n,k)&&w.push(A),n.locator=b}else c(A,n,k)&&w.push(A);"http://www.w3.org/1999/xhtml"!==A.uri||A.closed?D++:D=l(e,D,A.tagName,i,n)}}catch(e){o.error("element parse error: "+e),D=-1}D>E?E=D:p(Math.max(P,E)+1)}}(e,t,r,n,this.errorHandler),n.endDocument()}},f.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!o.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=i},function(e,t,r){function n(e){let t;for(e.content+=e.options.lineSeparator,t=0;t<e.level;t++)e.content+=e.options.indentation}function o(e,t){e.content+=t}function i(e,t,r,c){if("string"==typeof e.content)!function(e,t,r){(""!==e.content.trim()||r)&&(!r&&t.content.length>0&&n(t),o(t,e.content))}(e,t,r);else if("Element"===e.type)!function(e,t,r,s){!r&&t.content.length>0&&n(t);if(o(t,"<"+e.name),a(t,e.attributes),null===e.children){const e=s.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";o(t,e)}else if(0===e.children.length)o(t,"></"+e.name+">");else{o(t,">"),t.level++;let a="preserve"===e.attributes["xml:space"];if(!a&&t.options.collapseContent){e.children.some((function(e){return"Text"===e.type&&""!==e.content.trim()}))&&(a=!0)}e.children.forEach((function(e){i(e,t,r||a,s)})),t.level--,r||a||n(t),o(t,"</"+e.name+">")}}(e,t,r,c);else{if("ProcessingInstruction"!==e.type)throw new Error("Unknown node type: "+e.type);s(e,t)}}function a(e,t){Object.keys(t).forEach((function(r){o(e," "+r+'="'+t[r]+'"')}))}function s(e,t){t.content.length>0&&n(t),o(t,"<?"+e.name),a(t,e.attributes),o(t,"?>")}e.exports=function(e,t={}){(t=t||{}).indentation=t.indentation||"    ",t.collapseContent=!0===t.collapseContent,t.lineSeparator=t.lineSeparator||"\r\n",t.whiteSpaceAtEndOfSelfclosingTag=!!t.whiteSpaceAtEndOfSelfclosingTag;const n=r(296)(e,{filter:t.filter}),o={content:"",level:0,options:t};return n.declaration&&s(n.declaration,o),n.children.forEach((function(e){i(e,o,!1,t)})),o.content}},function(e,t){e.exports=function(e,t={}){function r(){return i()||function(){const e=c(/^([^<]+)/);if(e){const r={type:"Text",content:e[1]};return{excluded:!1===t.filter(r),node:r}}}()||a()||function(){const e=c(/^<!\[CDATA\[[^\]\]>]*]]>/);if(e){const r={type:"CDATA",content:e[0]};return{excluded:!1===t.filter(r),node:r}}}()}function n(){return c(/\s*/),i(!0)||a()||function(){const e=c(/^<!DOCTYPE\s+[^>]*>/);if(e){const r={type:"DocumentType",content:e[0]};return{excluded:!1===t.filter(r),node:r}}}()||o(!1)}function o(e){const r=c(e?/^<\?(xml)\s*/:/^<\?([\w-:.]+)\s*/);if(!r)return;const n={name:r[1],type:"ProcessingInstruction",attributes:{}};for(;!l()&&!u("?>");){const e=s();if(!e)return n;n.attributes[e.name]=e.value}return c(/\?>/),{excluded:!e&&!1===t.filter(n),node:n}}function i(e){const n=c(/^<([\w-:.]+)\s*/);if(!n)return;const o={type:"Element",name:n[1],attributes:{},children:[]};for(;!(l()||u(">")||u("?>")||u("/>"));){const e=s();if(!e)return o;o.attributes[e.name]=e.value}const i=!e&&!1===t.filter(o);if(c(/^\s*\/>/))return o.children=null,{excluded:i,node:o};if(c(/\??>/),!i){let e=r();for(;e;)e.excluded||o.children.push(e.node),e=r()}return c(/^<\/[\w-:.]+>/),{excluded:i,node:o}}function a(){const e=c(/^<!--[\s\S]*?-->/);if(e){const r={type:"Comment",content:e[0]};return{excluded:!1===t.filter(r),node:r}}}function s(){const e=c(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);var t;if(e)return{name:e[1],value:(t=e[2],t.replace(/^['"]|['"]$/g,""))}}function c(t){const r=e.match(t);if(r)return e=e.slice(r[0].length),r}function l(){return 0===e.length}function u(t){return 0===e.indexOf(t)}return t.filter=t.filter||(()=>!0),e=e.trim(),function(){const e=o(!0),t=[];let r,i=n();for(;i;){if("Element"===i.node.type){if(r)throw new Error("Found multiple root nodes");r=i.node}i.excluded||t.push(i.node),i=n()}if(!r)throw new Error("Failed to parse XML");return{declaration:e?e.node:null,root:r,children:t}}()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constructDataSourceTreeItem=t.SqlConnectionDataSourceTreeItem=t.DataSourcesTreeItem=void 0;const n=r(2),o=r(0),i=r(32),a=r(1),s=r(57),c=r(15);class l extends i.BaseProjectTreeItem{constructor(e){super(n.Uri.file(o.join(e.projectUri.path,a.dataSourcesNodeName)),e),this.dataSources=[],this.construct()}construct(){for(const e of this.parent.project.dataSources)this.dataSources.push(d(e,this))}get children(){return this.dataSources}get treeItem(){const e=new n.TreeItem(this.projectUri,n.TreeItemCollapsibleState.Collapsed);return e.contextValue=a.DatabaseProjectItemType.dataSourceRoot,e.iconPath=c.IconPathHelper.dataSourceGroup,e}}t.DataSourcesTreeItem=l;class u extends i.BaseProjectTreeItem{}class p extends u{constructor(e,t){super(n.Uri.file(o.join(t.projectUri.path,e.name)),t),this.dataSource=e}get treeItem(){let e=new n.TreeItem(this.projectUri,n.TreeItemCollapsibleState.Collapsed);return e.label=`${this.dataSource.name} (${this.dataSource.typeFriendlyName})`,e.iconPath=c.IconPathHelper.dataSourceSql,e}get children(){const e=[];for(const t of Object.keys(this.dataSource.connectionStringComponents).sort())e.push(new i.MessageTreeItem(`${t}: ${this.dataSource.connectionStringComponents[t]}`,this));return e}}function d(e,t){switch(e.type){case s.SqlConnectionDataSource.type:return new p(e,t);default:throw new Error(a.unknownDataSourceType+e.type)}}t.SqlConnectionDataSourceTreeItem=p,t.constructDataSourceTreeItem=d},function(e,t,r){const n=r(25);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},function(e,t,r){const n=r(25);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},function(e,t,r){const n=r(8);e.exports=(e,t,r,o)=>{"string"==typeof r&&(o=r,r=void 0);try{return new n(e,r).inc(t,o).version}catch(e){return null}}},function(e,t,r){const n=r(25),o=r(68);e.exports=(e,t)=>{if(o(e,t))return null;{const r=n(e),o=n(t),i=r.prerelease.length||o.prerelease.length,a=i?"pre":"",s=i?"prerelease":"";for(const e in r)if(("major"===e||"minor"===e||"patch"===e)&&r[e]!==o[e])return a+e;return s}}},function(e,t,r){const n=r(8);e.exports=(e,t)=>new n(e,t).major},function(e,t,r){const n=r(8);e.exports=(e,t)=>new n(e,t).minor},function(e,t,r){const n=r(8);e.exports=(e,t)=>new n(e,t).patch},function(e,t,r){const n=r(25);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},function(e,t,r){const n=r(13);e.exports=(e,t,r)=>n(t,e,r)},function(e,t,r){const n=r(13);e.exports=(e,t)=>n(e,t,!0)},function(e,t,r){const n=r(69);e.exports=(e,t)=>e.sort((e,r)=>n(e,r,t))},function(e,t,r){const n=r(69);e.exports=(e,t)=>e.sort((e,r)=>n(r,e,t))},function(e,t,r){const n=r(8),o=r(25),{re:i,t:a}=r(24);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=i[a.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),i[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[a.COERCERTL].lastIndex=-1}else r=e.match(i[a.COERCE]);return null===r?null:o(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},function(e,t,r){"use strict";const n=r(312),o=Symbol("max"),i=Symbol("length"),a=Symbol("lengthCalculator"),s=Symbol("allowStale"),c=Symbol("maxAge"),l=Symbol("dispose"),u=Symbol("noDisposeOnSet"),p=Symbol("lruList"),d=Symbol("cache"),h=Symbol("updateAgeOnGet"),f=()=>1;const m=(e,t,r)=>{const n=e[d].get(t);if(n){const t=n.value;if(g(e,t)){if(v(e,n),!e[s])return}else r&&(e[h]&&(n.value.now=Date.now()),e[p].unshiftNode(n));return t.value}},g=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[c]&&r>e[c]},y=e=>{if(e[i]>e[o])for(let t=e[p].tail;e[i]>e[o]&&null!==t;){const r=t.prev;v(e,t),t=r}},v=(e,t)=>{if(t){const r=t.value;e[l]&&e[l](r.key,r.value),e[i]-=r.length,e[d].delete(r.key),e[p].removeNode(t)}};class b{constructor(e,t,r,n,o){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=o||0}}const w=(e,t,r,n)=>{let o=r.value;g(e,o)&&(v(e,r),e[s]||(o=void 0)),o&&t.call(n,o.value,o.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[o]=e.max||1/0;const t=e.length||f;if(this[a]="function"!=typeof t?f:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[l]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[h]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,y(this)}get max(){return this[o]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,y(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[a]&&(this[a]=e,this[i]=0,this[p].forEach(e=>{e.length=this[a](e.value,e.key),this[i]+=e.length})),y(this)}get lengthCalculator(){return this[a]}get length(){return this[i]}get itemCount(){return this[p].length}rforEach(e,t){t=t||this;for(let r=this[p].tail;null!==r;){const n=r.prev;w(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[p].head;null!==r;){const n=r.next;w(this,e,r,t),r=n}}keys(){return this[p].toArray().map(e=>e.key)}values(){return this[p].toArray().map(e=>e.value)}reset(){this[l]&&this[p]&&this[p].length&&this[p].forEach(e=>this[l](e.key,e.value)),this[d]=new Map,this[p]=new n,this[i]=0}dump(){return this[p].map(e=>!g(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[p]}set(e,t,r){if((r=r||this[c])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,s=this[a](t,e);if(this[d].has(e)){if(s>this[o])return v(this,this[d].get(e)),!1;const a=this[d].get(e).value;return this[l]&&(this[u]||this[l](e,a.value)),a.now=n,a.maxAge=r,a.value=t,this[i]+=s-a.length,a.length=s,this.get(e),y(this),!0}const h=new b(e,t,s,n,r);return h.length>this[o]?(this[l]&&this[l](e,t),!1):(this[i]+=h.length,this[p].unshift(h),this[d].set(e,this[p].head),y(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!g(this,t)}get(e){return m(this,e,!0)}peek(e){return m(this,e,!1)}pop(){const e=this[p].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],o=n.e||0;if(0===o)this.set(n.k,n.v);else{const e=o-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[d].forEach((e,t)=>m(this,t,!1))}}},function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,o=arguments.length;r<o;r++)t.push(arguments[r]);return t}function o(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function i(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=s,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,o=this.head;null!==o;)r.push(e.call(t,o.value,this)),o=o.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,o=this.tail;null!==o;)r.push(e.call(t,o.value,this)),o=o.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var o=0;null!==n;o++)r=e(r,n.value,o),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var o=this.length-1;null!==n;o--)r=e(r,n.value,o),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var o=0,i=this.head;null!==i&&o<e;o++)i=i.next;for(;null!==i&&o<t;o++,i=i.next)r.push(i.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var o=this.length,i=this.tail;null!==i&&o>t;o--)i=i.prev;for(;null!==i&&o>e;o--,i=i.prev)r.push(i.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var a=[];for(n=0;i&&n<t;n++)a.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(n=0;n<r.length;n++)i=o(this,i,r[n]);return a},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(313)(n)}catch(e){}},function(e,t,r){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,r){const n=r(14);e.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,r){const n=r(8),o=r(14);e.exports=(e,t,r)=>{let i=null,a=null,s=null;try{s=new o(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&-1!==a.compare(e)||(i=e,a=new n(i,r)))}),i}},function(e,t,r){const n=r(8),o=r(14);e.exports=(e,t,r)=>{let i=null,a=null,s=null;try{s=new o(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&1!==a.compare(e)||(i=e,a=new n(i,r)))}),i}},function(e,t,r){const n=r(8),o=r(14),i=r(47);e.exports=(e,t)=>{e=new o(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const o=e.set[t];let a=null;o.forEach(e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!i(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!a||r&&!i(r,a)||(r=a)}return r&&e.test(r)?r:null}},function(e,t,r){const n=r(14);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,r){const n=r(73);e.exports=(e,t,r)=>n(e,t,">",r)},function(e,t,r){const n=r(73);e.exports=(e,t,r)=>n(e,t,"<",r)},function(e,t,r){const n=r(14);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t))},function(e,t,r){const n=r(49),o=r(13);e.exports=(e,t,r)=>{const i=[];let a=null,s=null;const c=e.sort((e,t)=>o(e,t,r));for(const e of c){n(e,t,r)?(s=e,a||(a=e)):(s&&i.push([a,s]),s=null,a=null)}a&&i.push([a,null]);const l=[];for(const[e,t]of i)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push("<="+t):l.push(`${e} - ${t}`):l.push(">="+e):l.push("*");const u=l.join(" || "),p="string"==typeof t.raw?t.raw:String(t);return u.length<p.length?u:t}},function(e,t,r){const n=r(14),o=r(48),{ANY:i}=o,a=r(49),s=r(13),c=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=r.includePrerelease?[new o(">=0.0.0-0")]:[new o(">=0.0.0")]}if(1===t.length&&t[0].semver===i){if(r.includePrerelease)return!0;t=[new o(">=0.0.0")]}const n=new Set;let c,p,d,h,f,m,g;for(const t of e)">"===t.operator||">="===t.operator?c=l(c,t,r):"<"===t.operator||"<="===t.operator?p=u(p,t,r):n.add(t.semver);if(n.size>1)return null;if(c&&p){if(d=s(c.semver,p.semver,r),d>0)return null;if(0===d&&(">="!==c.operator||"<="!==p.operator))return null}for(const e of n){if(c&&!a(e,String(c),r))return null;if(p&&!a(e,String(p),r))return null;for(const n of t)if(!a(e,String(n),r))return!1;return!0}let y=!(!p||r.includePrerelease||!p.semver.prerelease.length)&&p.semver,v=!(!c||r.includePrerelease||!c.semver.prerelease.length)&&c.semver;y&&1===y.prerelease.length&&"<"===p.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,c)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(h=l(c,e,r),h===e&&h!==c)return!1}else if(">="===c.operator&&!a(c.semver,String(e),r))return!1;if(p)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(f=u(p,e,r),f===e&&f!==p)return!1}else if("<="===p.operator&&!a(p.semver,String(e),r))return!1;if(!e.operator&&(p||c)&&0!==d)return!1}return!(c&&m&&!p&&0!==d)&&(!(p&&g&&!c&&0!==d)&&(!v&&!y))},l=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let o=!1;e:for(const n of e.set){for(const e of t.set){const t=c(n,e,r);if(o=o||null!==t,t)continue e}if(o)return!1}return!0}},function(e,t,r){"use strict";var n=r(325);Object.defineProperty(t,"__esModule",{value:!0}),t.promisifyChildProcess=a,t.spawn=function(e,t,r){return a(o.default.spawn(e,t,r),Array.isArray(t)?r:t)},t.fork=function(e,t,r){return a(o.default.fork(e,t,r),Array.isArray(t)?r:t)},t.execFile=t.exec=void 0;var o=n(r(39));function i(e,t){if(e[0]instanceof Buffer){var r=Buffer.concat(e);return t?r.toString(t):r}return e.join("")}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Promise((function(r,n){var o,a=t.encoding,s=t.killSignal,c=null!=a||null!=t.maxBuffer,l=t.maxBuffer||204800,u=0,p=[],d=[],h=function(t){return function(r){var n=l-u;r.length>n&&(o=new Error("maxBuffer size exceeded"),e.kill(s||"SIGTERM"),r=r.slice(0,n)),u+=r.length,t.push(r)}};function f(e,t){function s(e){c?(e.stdout=i(p,a),e.stderr=i(d,a)):Object.defineProperties(e,{stdout:{configurable:!0,enumerable:!0,get:function(){return console.error(new Error("To get stdout from a spawned or forked process, set the `encoding` or `maxBuffer` option").stack.replace(/^Error/,"Warning")),null}},stderr:{configurable:!0,enumerable:!0,get:function(){return console.error(new Error("To get stderr from a spawned or forked process, set the `encoding` or `maxBuffer` option").stack.replace(/^Error/,"Warning")),null}}})}o||(null!=e&&0!==e?o=new Error("Process exited with code ".concat(e)):null!=t&&(o=new Error("Process was killed with ".concat(t))));var l={};s(l);var u=o;u?(u.code=e,u.signal=t,s(u),n(u)):r(l)}c&&(e.stdout&&e.stdout.on("data",h(p)),e.stderr&&e.stderr.on("data",h(d))),e.on("error",n),e.on("close",f),e.on("exit",f)}));return Object.create(e,{then:{value:r.then.bind(r)},catch:{value:r.catch.bind(r)}})}function s(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o,i=new Promise((function(t,n){o=e.apply(void 0,r.concat([function(e,r,o){e?(e.stdout=r,e.stderr=o,n(e)):t({stdout:r,stderr:o})}]))}));if(!o)throw new Error("unexpected error: child has not been initialized");return Object.create(o,{then:{value:i.then.bind(i)},catch:{value:i.catch.bind(i)}})}}var c=s(o.default.exec);t.exec=c;var l=s(o.default.execFile);t.execFile=l},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuildHelper=void 0;const n=r(2),o=r(0),i=r(4),a=r(3),s=r(1),c=["Microsoft.Data.SqlClient.dll","Microsoft.Data.Tools.Schema.Sql.dll","Microsoft.Data.Tools.Schema.Tasks.Sql.dll","Microsoft.Data.Tools.Utilities.dll","Microsoft.SqlServer.Dac.dll","Microsoft.SqlServer.Dac.Extensions.dll","Microsoft.SqlServer.TransactSql.ScriptDom.dll","Microsoft.SqlServer.Types.dll","System.ComponentModel.Composition.dll","System.IO.Packaging.dll","Microsoft.Data.Tools.Schema.SqlTasks.targets"];t.BuildHelper=class{constructor(){var e,t;this.initialized=!1;const r=a.getAzdataApi()?"Microsoft.sql-database-projects":"ms-mssql.sql-database-projects-vscode";this.extensionDir=null!==(t=null===(e=n.extensions.getExtension(r))||void 0===e?void 0:e.extensionPath)&&void 0!==t?t:"",this.extensionBuildDir=o.join(this.extensionDir,"BuildDirectory")}async createBuildDirFolder(){if(this.initialized)return;await a.exists(this.extensionBuildDir)||await i.promises.mkdir(this.extensionBuildDir);const e=await this.getBuildDirPathFromMssqlTools();c.forEach(async t=>{await a.exists(o.join(e,t))&&await i.promises.copyFile(o.join(e,t),o.join(this.extensionBuildDir,t))}),this.initialized=!0}async getBuildDirPathFromMssqlTools(){var e,t;try{return a.getAzdataApi()?(null===(e=n.extensions.getExtension("Microsoft.mssql"))||void 0===e?void 0:e.exports).sqlToolsServicePath:(null===(t=n.extensions.getExtension("ms-mssql.mssql"))||void 0===t?void 0:t.exports).sqlToolsServicePath}catch(e){throw new Error(s.errorFindingBuildFilesLocation(e))}}get extensionBuildDirPath(){return this.extensionBuildDir}constructBuildArguments(e,t,r){return e=a.getQuotedPath(e),t=a.getQuotedPath(t),r?` build ${e} /p:NetCoreBuild=true`:` build ${e} /p:NetCoreBuild=true /p:NETCoreTargetsPath=${t}`}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Status=t.PublishData=t.DashboardData=void 0;class n{constructor(e,t,r,n){this.projectFile=e,this.status=t,this.target=r,this.timeToCompleteAction="",this.startDate=n}}t.DashboardData=n;t.PublishData=class extends n{constructor(e,t,r,n,o,i){super(e,t,r,n),this.targetDatabase=o,this.targetServer=i}},function(e){e[e.success=0]="success",e[e.failed=1]="failed",e[e.inProgress=2]="inProgress"}(t.Status||(t.Status={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchPublishToDockerContainerQuickpick=t.launchDeployAppIntegrationQuickpick=void 0;const n=r(2),o=r(1),i=r(3),a=r(59),s=r(122),c=r(121),l=r(0),u=r(35);t.launchDeployAppIntegrationQuickpick=async function(e){let t="";const r=l.join(e.projectFolderPath,o.azureFunctionLocalSettingsFileName),a=await u.pathExists(r);if(a){let e={},r={placeHolder:o.appSettingPrompt};e[o.yesString]=!0,e[o.noString]=!1;let a=await n.window.showQuickPick(Object.keys(e).map(e=>({label:e})),r);if(!a)return;if(void 0!==a&&e[a.label]&&(t=await n.window.showInputBox({title:o.enterConnectionStringEnvName,ignoreFocusOut:!0,value:o.defaultConnectionStringEnvVarName,validateInput:e=>i.isEmptyString(e)?o.valueCannotBeEmpty:void 0,placeHolder:o.enterConnectionStringEnvNameDescription}),!t))return}return{envVariableName:t,appSettingFile:a?r:void 0,appSettingType:a?s.AppSettingType.AzureFunction:s.AppSettingType.None}},t.launchPublishToDockerContainerQuickpick=async function(e){var t,r;let s,l=await n.window.showInputBox({title:o.enterPortNumber,ignoreFocusOut:!0,value:o.defaultPortNumber,validateInput:e=>i.validateSqlServerPortNumber(e)?void 0:o.portMustBeNumber});if(!l)return;let u="";if(u=await n.window.showInputBox({title:o.enterPassword,ignoreFocusOut:!0,value:u,validateInput:e=>i.isValidSQLPassword(e)?void 0:o.invalidSQLPasswordMessage,password:!0}),!u)return;let p="";if(p=await n.window.showInputBox({title:o.confirmPassword,ignoreFocusOut:!0,value:p,validateInput:e=>e!==u?o.passwordNotMatch:void 0,password:!0}),!p)return;const d=a.getDockerBaseImages(),h=await n.window.showQuickPick(d.map(e=>e.name),{title:o.selectBaseImage,ignoreFocusOut:!0});if(!h)return;if(!await async function(e){let t=!1;const r=a.getDockerBaseImages().find(t=>t.name===e),i=null==r?void 0:r.agreementInfo;if(i){const e={iconPath:new n.ThemeIcon("link-external"),tooltip:o.openEulaString},r=n.window.createQuickPick();r.items=[{label:o.yesString},{label:o.noString}],r.title=a.getAgreementDisplayText(i),r.ignoreFocusOut=!0,r.buttons=[e];const s=[];try{const e=new Promise(e=>{s.push(r.onDidHide(()=>{e(!1)}),r.onDidTriggerButton(async()=>{await n.env.openExternal(n.Uri.parse(i.link.url))}),r.onDidChangeSelection(t=>{e(t[0].label===o.yesString)}))});r.show(),t=await e,r.hide()}finally{s.forEach(e=>e.dispose())}return t}return!1}(h))return;const f=d.find(e=>e.name===h);s={serverName:o.defaultLocalServerName,userName:o.defaultLocalServerAdminName,dbName:e.projectFileName,password:u,port:+l,dockerBaseImage:h,dockerBaseImageEula:(null===(r=null===(t=null==f?void 0:f.agreementInfo)||void 0===t?void 0:t.link)||void 0===r?void 0:r.url)||""};let m=await c.getPublishDatabaseSettings(e,!1);return m?(m.serverName=s.serverName,s.dbName=m.databaseName,{localDbSetting:s,deploySettings:m}):void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeployService=void 0;const n=r(122),o=r(92),i=r(1),a=r(3),s=r(35),c=r(0),l=r(2),u=r(9),p=r(37),d=r(74);t.DeployService=class{constructor(e,t){this._outputChannel=e,this.DefaultSqlRetryTimeoutInSec=10,this.DefaultSqlNumberOfRetries=3,this._shellExecutionHelper=null!=t?t:new d.ShellExecutionHelper(this._outputChannel)}createConnectionStringTemplate(e){switch(null==e?void 0:e.toLocaleLowerCase()){case"dotnet":return i.defaultConnectionStringTemplate}return""}findAppRuntime(e,t){switch(e.appSettingType){case n.AppSettingType.AzureFunction:return null==t?void 0:t.Values.FUNCTIONS_WORKER_RUNTIME}}async updateAppSettings(e,t){var r,n,o,a,c,l,u,d;if(!e.appSettingFile)return;this.logToOutput(i.deployAppSettingUpdating(e.appSettingFile));let h=JSON.parse(s.readFileSync(e.appSettingFile,"utf8"));if(h&&h.Values){let f="";if(t&&t.localDbSetting){const i=this.findAppRuntime(e,h);let s=this.createConnectionStringTemplate(i);const u={SERVER:(null===(r=null==t?void 0:t.localDbSetting)||void 0===r?void 0:r.serverName)||"",PORT:(null===(o=null===(n=null==t?void 0:t.localDbSetting)||void 0===n?void 0:n.port)||void 0===o?void 0:o.toString())||"",USER:(null===(a=null==t?void 0:t.localDbSetting)||void 0===a?void 0:a.userName)||"",SA_PASSWORD:(null===(c=null==t?void 0:t.localDbSetting)||void 0===c?void 0:c.password)||"",DATABASE:(null===(l=null==t?void 0:t.localDbSetting)||void 0===l?void 0:l.dbName)||""};f=p.macroExpansion(s,u)}else(null===(u=null==t?void 0:t.deploySettings)||void 0===u?void 0:u.connectionUri)&&(f=await this.getConnectionString(null===(d=null==t?void 0:t.deploySettings)||void 0===d?void 0:d.connectionUri));f&&e.envVariableName?(h.Values[e.envVariableName]=f,await s.writeFileSync(e.appSettingFile,JSON.stringify(h,void 0,4)),this.logToOutput(`app setting '${e.appSettingFile}' has been updated. env variable name: ${e.envVariableName} connection String: ${f}`)):this.logToOutput(i.deployAppSettingUpdateFailed(e.appSettingFile))}}async verifyDocker(){try{await this.executeCommand("docker version --format {{.Server.APIVersion}}")}catch(e){throw Error(i.dockerNotRunningError(a.getErrorMessage(e)))}}getDockerImageSpec(e,t,r){r=null!=r?r:o.generateUuid();const n=/[^a-zA-Z0-9_,\-]/g;let a=e.replace(n,"");const s=t.replace(":","-").replace(i.sqlServerDockerRegistry,"").replace(n,"");a=a.substring(0,128-(i.dockerImageNamePrefix.length+s.length+2));return{label:`${i.dockerImageLabelPrefix}-${a}`.toLocaleLowerCase(),tag:`${i.dockerImageNamePrefix}-${a}-${s}`.toLocaleLowerCase(),containerName:`${i.dockerImageNamePrefix}-${a}-${r}`.toLocaleLowerCase()}}async deploy(e,t){return await this.executeTask(i.deployDbTaskName,async()=>{if(!e.localDbSetting)return;await this.verifyDocker(),this.logToOutput(i.dockerImageMessage),this.logToOutput(e.localDbSetting.dockerBaseImage),this.logToOutput(i.dockerImageEulaMessage),this.logToOutput(e.localDbSetting.dockerBaseImageEula);const r=this.getDockerImageSpec(t.projectFileName,e.localDbSetting.dockerBaseImage),n=t.projectFolderPath,o=c.join(n,i.mssqlFolderName),s=c.join(o,i.commandsFolderName),u=c.join(o,i.dockerFileName),p=c.join(s,i.startCommandName);e.localDbSetting.profileName||(e.localDbSetting.profileName=r.containerName),this.logToOutput(i.cleaningDockerImagesMessage);const d=await this.getCurrentDockerContainer(r.label);if(d.length>0){await l.window.showWarningMessage(i.containerAlreadyExistForProject,i.yesString,i.noString)===i.yesString&&(this.logToOutput(i.cleaningDockerImagesMessage),await this.cleanDockerObjects(d,["docker stop","docker rm"]))}this.logToOutput(i.creatingDeploymentSettingsMessage),await this.createCommands(o,s,u,p,r.label,e.localDbSetting.dockerBaseImage),this.logToOutput(i.runningDockerMessage);const h=await this.buildAndRunDockerContainer(u,r,n,e.localDbSetting);this.logToOutput("Docker container created. Id: "+h);const f=await a.retry("Validating the docker container",async()=>this.executeCommand(`docker ps -q -a --filter label=${r.label} -q`),e=>Promise.resolve({validated:void 0!==e,errorMessage:i.dockerContainerNotRunningErrorMessage}),e=>Promise.resolve(e),this._outputChannel);if(f)return this.logToOutput(i.dockerContainerCreatedMessage(f)),await this.getConnection(e.localDbSetting,!1,"master");this.logToOutput(i.dockerContainerFailedToRunErrorMessage),h&&await this.executeCommand(i.dockerLogMessage(h))})}async buildAndRunDockerContainer(e,t,r,n){const o=[n.password];return this.logToOutput("Building docker image ..."),await this.executeCommand("docker pull "+n.dockerBaseImage),await this.executeCommand(`docker build -f ${e} -t ${t.tag} ${r}`),await this.executeCommand("docker images --filter label="+t.label),this.logToOutput("Running docker container ..."),await this.executeCommand(`docker run -p ${n.port}:1433 -e "MSSQL_SA_PASSWORD=${n.password}" -d --name ${t.containerName} ${t.tag}`,o),await this.executeCommand(`docker ps -q -a --filter label=${t.label} -q`)}async getConnectionString(e){const t=await a.getAzdataApi();if(t){const r=await t.connection.getConnection(e);if(r)return await t.connection.getConnectionString(r.connectionId,!0)}}async connectToDatabase(e,t,r){const n=await a.getAzdataApi(),o=n?void 0:await a.getVscodeMssqlApi();if(n){const o={password:e.password,serverName:`${e.serverName},${e.port}`,database:r,savePassword:t,userName:e.userName,providerName:"MSSQL",saveProfile:!1,id:"",connectionName:e.profileName,options:[],authenticationType:"SqlLogin"};return await n.connection.connect(o,t,!1)}if(o){const n={password:e.password,server:""+e.serverName,port:e.port,database:r,savePassword:t,user:e.userName,authenticationType:"SqlLogin",encrypt:!1,connectTimeout:30,applicationName:"SQL Database Project",accountId:void 0,azureAccountToken:void 0,applicationIntent:void 0,attachDbFilename:void 0,connectRetryCount:void 0,connectRetryInterval:void 0,connectionString:void 0,currentLanguage:void 0,email:void 0,failoverPartner:void 0,loadBalanceTimeout:void 0,maxPoolSize:void 0,minPoolSize:void 0,multiSubnetFailover:void 0,multipleActiveResultSets:void 0,packetSize:void 0,persistSecurityInfo:void 0,pooling:void 0,replication:void 0,trustServerCertificate:void 0,typeSystemVersion:void 0,workstationId:void 0,profileName:e.profileName};return await o.connect(n,t)}}async validateConnection(e){const t=await a.getAzdataApi();if(e){if(t){const t=e;if(t){const e=void 0!==t&&t.connected&&void 0!==t.connectionId;return{validated:e,errorMessage:e?"":i.connectionFailedError(null==t?void 0:t.errorMessage)}}return{validated:!1,errorMessage:i.connectionFailedError("")}}return{validated:void 0!==e,errorMessage:i.connectionFailedError("")}}return{validated:!1,errorMessage:i.connectionFailedError("No result returned")}}async formatConnectionResult(e){const t=await a.getAzdataApi(),r=void 0!==e&&t?e:void 0;return r?r.connectionId:e}async getConnection(e,t,r){const n=await a.getAzdataApi();let o=await a.retry(i.connectingToSqlServerOnDockerMessage,async()=>await this.connectToDatabase(e,t,r),this.validateConnection,this.formatConnectionResult,this._outputChannel,this.DefaultSqlNumberOfRetries,e.connectionRetryTimeout||this.DefaultSqlRetryTimeoutInSec);if(o){const e=o;return n?await n.connection.getUriForConnection(e.connectionId):o}}async executeTask(e,t){const r=await a.getAzdataApi();return r?new Promise((n,o)=>{let a=e;r.tasks.startBackgroundOperation({displayName:a,description:a,isCancelable:!1,operation:async a=>{try{let e=await t();a.updateStatus(r.TaskStatus.Succeeded),n(e)}catch(t){let n=i.taskFailedError(e,t?t.message:"");a.updateStatus(r.TaskStatus.Failed,n),o(n)}}})}):await t()}logToOutput(e){this._outputChannel.appendLine(e)}async createCommands(e,t,r,n,o,s){await a.createFolderIfNotExist(e),await a.createFolderIfNotExist(t),await this.createFile(n,"echo starting the container!"),"win32"!==u.platform()&&await this.executeCommand(`chmod +x '${n}'`),await this.createFile(r,`\nFROM ${s}\nENV ACCEPT_EULA=Y\nENV MSSQL_PID=Developer\nLABEL ${o}\nRUN mkdir -p /opt/sqlproject\nCOPY ${i.mssqlFolderName}/${i.commandsFolderName}/ /opt/commands\nRUN ["/bin/bash", "/opt/commands/start.sh"]\n`)}async createFile(e,t){this.logToOutput(`Creating file ${e}, content:${t}`),await s.writeFile(e,t)}async executeCommand(e,t=[],r=3e5){return await this._shellExecutionHelper.runStreamedCommand(e,void 0,t,r)}async getCurrentDockerContainer(e){const t=await this.executeCommand("docker ps -q -a --filter label="+e);return t?t.split(/\r?\n/):[]}async cleanDockerObjects(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n)for(let e=0;e<t.length;e++){const r=t[e];await this.executeCommand(`${r} ${n}`)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutorestHelper=void 0;const n=r(2),o=r(1),i=r(3),a=r(114),s=r(43),c=r(74);class l extends c.ShellExecutionHelper{constructor(e){super(e)}get autorestSqlPackageVersion(){let e=n.workspace.getConfiguration(s.DBProjectConfigurationKey).autorestSqlVersion;return e&&a.valid(e.trim())?e.trim():"latest"}async detectInstallation(){if(await i.detectCommandInstallation("autorest"))return"autorest";if(await i.detectCommandInstallation("npx")){this._outputChannel.appendLine(o.nodeButNotAutorestFound);const e=await n.window.showInformationMessage(o.nodeButNotAutorestFoundPrompt,o.installGlobally,o.runViaNpx);if(e===o.installGlobally)return this._outputChannel.appendLine(o.userSelectionInstallGlobally),await this.runStreamedCommand("npm install autorest -g"),"autorest";if(e===o.runViaNpx)return this._outputChannel.appendLine(o.userSelectionRunNpx),"npx autorest";this._outputChannel.appendLine(o.userSelectionCancelled)}else this._outputChannel.appendLine(o.nodeNotFound)}async generateAutorestFiles(e,t){const r=await this.detectInstallation();if(!r){if(!0!==n.workspace.getConfiguration(s.DBProjectConfigurationKey).nodejsDoNotAsk)return;const e=await n.window.showErrorMessage(o.nodeNotFound,o.DoNotAskAgain,o.Install);if(e===o.Install){const e="https://nodejs.dev/download";await n.env.openExternal(n.Uri.parse(e))}else if(e===o.DoNotAskAgain){const e=n.workspace.getConfiguration(s.DBProjectConfigurationKey);await e.update("nodejsDoNotAsk",!0,n.ConfigurationTarget.Global)}return}const i=this.constructAutorestCommand(r,e,t);return await this.runStreamedCommand(i)}constructAutorestCommand(e,t,r){return`${e} --use:autorest-sql-testing@${this.autorestSqlPackageVersion} --input-file="${t}" --output-folder="${r}" --clear-output-folder --verbose`}}t.AutorestHelper=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNewProjectFromDatabaseWithQuickpick=void 0;const n=r(2),o=r(0),i=r(1),a=r(3),s=r(120),c=r(119);t.createNewProjectFromDatabaseWithQuickpick=async function(e){const t=await a.getVscodeMssqlApi();let r=null!=e?e:await t.promptForConnection(!0);if(!r)return;let l="",u=void 0;for(;!u;)try{l=await t.connect(r),u=(await t.listDatabases(l)).filter(e=>!i.systemDbs.includes(e))}catch(e){if(r=await t.promptForConnection(!0),!r)return}if(r.database&&r.database!==i.master){const e=u.indexOf(r.database);e>=0&&u.splice(e,1),u.unshift(r.database)}const p=await n.window.showQuickPick(u,{title:i.selectDatabase,ignoreFocusOut:!0});if(!p)return;const d=await n.window.showInputBox({title:i.projectNamePlaceholderText,value:s.defaultProjectNameFromDb(p),validateInput:e=>e?void 0:i.nameMustNotBeEmpty,ignoreFocusOut:!0});if(!d)return;const h=s.defaultProjectSaveLocation(),f=[i.browseEllipsisWithIcon];h&&f.push(h.fsPath);let m="",g=i.projectLocationPlaceholderText;for(;;){const e=await n.window.showQuickPick(f,{title:g,ignoreFocusOut:!0});if(!e)return;if(e===i.browseEllipsisWithIcon){const e=await n.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,openLabel:i.selectString,title:i.selectProjectLocation,defaultUri:h});if(!e){g=i.projectLocationPlaceholderText;continue}m=e[0].fsPath}else m=e;if(!await a.exists(o.join(m,d)))break;g=i.folderAlreadyExistsChooseNewLocation(d)}const y=await n.window.showQuickPick([i.file,i.flat,i.objectType,i.schema,i.schemaObjectType],{title:i.selectFolderStructure,ignoreFocusOut:!0});return y?{connectionUri:l,database:p,projName:d,filePath:m,version:"1.0.0.0",extractTarget:c.mapExtractTargetEnum(y)}:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDatabaseReferenceQuickpick=void 0;const n=r(0),o=r(2),i=r(1),a=r(3),s=r(118);async function c(){return o.window.showQuickPick(i.locationDropdownValues,{title:i.location,ignoreFocusOut:!0})}async function l(e){return o.window.showInputBox({title:i.databaseName,value:e,validateInput:e=>e?void 0:i.nameMustNotBeEmpty,ignoreFocusOut:!0})}async function u(){return await o.window.showQuickPick([i.noStringDefault,i.yesString],{title:i.suppressMissingDependenciesErrors,ignoreFocusOut:!0})===i.yesString}async function p(e,t){const r={};if(e!==i.sameDatabase){const e=await l(t);if(!e)return;r.dbName=e;const n=await async function(e){var t;return null!==(t=await o.window.showInputBox({title:i.databaseVariable,value:e,validateInput:e=>a.isValidSqlCmdVariableName(e)?"":i.notValidVariableName(e),ignoreFocusOut:!0}))&&void 0!==t?t:""}(e);r.dbVariable=n}if(e===i.differentDbDifferentServer){const e=await async function(){return o.window.showInputBox({title:i.serverName,value:i.otherServer,validateInput:e=>e?void 0:i.nameMustNotBeEmpty,ignoreFocusOut:!0})}();if(!e)return;r.serverName=e;const t=await async function(){var e;return null!==(e=await o.window.showInputBox({title:i.serverVariable,value:i.otherSeverVariable,validateInput:e=>a.isValidSqlCmdVariableName(e)?"":i.notValidVariableName(e),ignoreFocusOut:!0}))&&void 0!==e?e:""}();if(!t)return;r.serverVariable=t}return r}t.addDatabaseReferenceQuickpick=async function(e){const t=(await a.getSqlProjectsInWorkspace()).filter(t=>t.fsPath!==e.projectFilePath),r=t.length>0?[i.projectLabel,i.systemDatabase,i.dacpacText]:[i.systemDatabase,i.dacpacText],d=await o.window.showQuickPick(r,{title:i.referenceType,ignoreFocusOut:!0});if(d)switch(d){case i.projectLabel:return async function(e){const t=e.map(e=>({label:n.parse(e.fsPath).name,uri:e})),r=await o.window.showQuickPick(t,{title:i.databaseProject,ignoreFocusOut:!0});if(!r)return;const a=await c();if(!a)return;const s={projectName:r.label,projectGuid:"",projectRelativePath:void 0,databaseName:void 0,databaseVariable:void 0,serverName:void 0,serverVariable:void 0,suppressMissingDependenciesErrors:!1},l=await p(a,r.label);if(!l)return;s.databaseName=l.dbName,s.databaseVariable=l.dbVariable,s.serverName=l.serverName,s.serverVariable=l.serverVariable;const d=await u();return s.suppressMissingDependenciesErrors=d,s}(t);case i.systemDatabase:return async function(e){const t=await o.window.showQuickPick(s.getSystemDbOptions(e),{title:i.systemDatabase,ignoreFocusOut:!0});if(!t)return;const r=await l(t),n=await u();return{databaseName:r,systemDb:s.getSystemDatabase(t),suppressMissingDependenciesErrors:n}}(e);case i.dacpacText:return async function(){var e;const t=await c();if(!t)return;if(!await o.window.showQuickPick([i.browseEllipsisWithIcon],{title:i.selectDacpac,ignoreFocusOut:!0}))return;const r=null===(e=await s.promptDacpacLocation())||void 0===e?void 0:e[0];if(!r)return;const l=await p(t,n.parse(r.fsPath).name);if(!l)return;const d=await u();return{databaseName:l.dbName,dacpacFileLocation:r,databaseVariable:a.removeSqlCmdVariableFormatting(l.dbVariable),serverName:l.serverName,serverVariable:a.removeSqlCmdVariableFormatting(l.serverVariable),suppressMissingDependenciesErrors:d}}();default:return void console.log("Unknown reference type "+d)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqlDatabaseProjectProvider=void 0;const n=r(2),o=r(1),i=r(15),a=r(3),s=r(334),c=r(108);t.SqlDatabaseProjectProvider=class{constructor(e){this.projectController=e}async getProjectTreeDataProvider(e){const t=new s.SqlDatabaseProjectTreeViewProvider,r=await c.Project.openProject(e.fsPath);return t.load([r]),t}get supportedProjectTypes(){return[{id:o.emptySqlDatabaseProjectTypeId,projectFileExtension:o.sqlprojExtension.replace(/\./g,""),displayName:o.emptyProjectTypeDisplayName,description:o.emptyProjectTypeDescription,icon:i.IconPathHelper.colorfulSqlProject,targetPlatforms:Array.from(o.targetPlatformToVersion.keys()),defaultTargetPlatform:o.defaultTargetPlatform},{id:o.edgeSqlDatabaseProjectTypeId,projectFileExtension:o.sqlprojExtension.replace(/\./g,""),displayName:o.edgeProjectTypeDisplayName,description:o.edgeProjectTypeDescription,icon:i.IconPathHelper.sqlEdgeProject}]}async createProject(e,t,r,o){const i=await this.projectController.createNewProject({newProjName:e,folderUri:t,projectTypeId:r,targetPlatform:o});return n.Uri.file(i)}openProject(e){return c.Project.openProject(e)}get projectToolbarActions(){return[{actions:[{id:o.addItemAction,icon:i.IconPathHelper.add,run:e=>this.projectController.addItemPromptFromNode(e)},{id:o.schemaCompareAction,icon:i.IconPathHelper.schemaCompare,run:e=>this.projectController.schemaCompare(e)},{id:o.buildAction,icon:i.IconPathHelper.build,run:e=>this.projectController.buildProject(e)},{id:o.publishAction,icon:i.IconPathHelper.publish,run:e=>this.projectController.publishProject(e)}]},{id:o.changeTargetPlatformAction,icon:i.IconPathHelper.targetPlatform,run:e=>this.projectController.changeTargetPlatform(e)}]}getDashboardComponents(e){return[{name:o.PublishHistory,columns:[{displayName:o.Status,width:200,type:"icon"},{displayName:o.Date,width:200},{displayName:o.Time,width:200},{displayName:o.TargetPlatform,width:200},{displayName:o.TargetServer,width:200},{displayName:o.TargetDatabase,width:200}],data:this.projectController.getDashboardPublishData(e)},{name:o.BuildHistory,columns:[{displayName:o.Status,width:200,type:"icon"},{displayName:o.Date,width:200},{displayName:o.Time,width:200},{displayName:o.TargetPlatform,width:200}],data:this.projectController.getDashboardBuildData(e)}]}get image(){return i.IconPathHelper.dashboardSqlProj}async openSqlNewProjectDialog(e){let t=Array.from(o.targetPlatformToVersion.keys());e&&(t=t.filter(t=>e.toString().includes(t)));const r={id:o.emptySqlDatabaseProjectTypeId,projectFileExtension:o.sqlprojExtension.replace(/\./g,""),displayName:o.emptyProjectTypeDisplayName,description:o.emptyProjectTypeDescription,icon:i.IconPathHelper.colorfulSqlProject,targetPlatforms:t,defaultTargetPlatform:o.defaultTargetPlatform};return a.getDataWorkspaceExtensionApi().openSpecificProjectNewProjectDialog(r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqlDatabaseProjectTreeViewProvider=void 0;const n=r(2),o=r(1),i=r(32),a=r(112);t.SqlDatabaseProjectTreeViewProvider=class{constructor(){this._onDidChangeTreeData=new n.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.roots=[],this.initialize()}initialize(){this.roots=[]}notifyTreeDataChanged(){this._onDidChangeTreeData.fire(void 0)}getTreeItem(e){return e.treeItem}getChildren(e){return void 0===e?this.roots:e.children}getParent(e){if(!e.parent)throw new Error(o.parentTreeItemUnknown);return e.parent}load(e){let t=[];for(const r of e)t.push(new a.ProjectRootTreeItem(r)),t.push(i.SpacerTreeItem);t[t.length-1]===i.SpacerTreeItem&&t.pop(),this.roots=t,this._onDidChangeTreeData.fire(void 0)}setTreeView(e){if(this.treeView)throw new Error("TreeView should not be set multiple times.");this.treeView=e}async focus(e){var t;const r=this.roots.find(t=>t instanceof a.ProjectRootTreeItem&&t.project===e);r&&await(null===(t=this.treeView)||void 0===t?void 0:t.reveal(r,{focus:!0,expand:!0}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launchAddSqlBindingQuickpick=void 0;const n=r(2),o=r(0),i=r(1),a=r(3),s=r(123),c=r(27);t.launchAddSqlBindingQuickpick=async function(e,t){var r,l;if(c.TelemetryReporter.sendActionEvent(c.TelemetryViews.SqlBindingsQuickPick,c.TelemetryActions.startAddSqlBinding),!e&&(e=n.window.activeTextEditor.document.uri,n.window.activeTextEditor.document.isDirty)){if(await n.window.showWarningMessage(i.saveChangesInFile,{modal:!0},i.save)!==i.save)return;await n.window.activeTextEditor.document.save()}const u=await a.getAzureFunctionService();let p;try{p=await u.getAzureFunctions(e.fsPath)}catch(e){return void n.window.showErrorMessage(a.getErrorMessage(e))}const d=p.azureFunctions;if(0===d.length)return void n.window.showErrorMessage(i.noAzureFunctionsInFile);const h=await n.window.showQuickPick(d,{canPickMany:!1,title:i.selectAzureFunction,ignoreFocusOut:!0});if(!h)return;const f=[{label:i.input,type:0},{label:i.output,type:1}],m=await n.window.showQuickPick(f,{canPickMany:!1,title:i.selectBindingType,ignoreFocusOut:!0});if(!m)return;const g=await n.window.showInputBox({prompt:0===m.type?i.sqlTableOrViewToQuery:i.sqlTableToUpsert,placeHolder:i.placeHolderObject,validateInput:e=>e?void 0:i.nameMustNotBeEmpty,ignoreFocusOut:!0});if(!g)return;let y,v;try{y=await s.getAFProjectContainingFile(e)}catch(e){}if(y){let e;try{e=await s.getLocalSettingsJson(o.join(o.dirname(y.fsPath),i.azureFunctionLocalSettingsFileName))}catch(e){return void n.window.showErrorMessage(a.getErrorMessage(e))}let t=[];(null==e?void 0:e.Values)&&(t=Object.keys(e.Values).map(e=>({label:e}))),t.unshift({label:i.createNewLocalAppSettingWithIcon,isCreateNew:!0});let c=t.find(e=>e.label===i.sqlConnectionStringSetting);for(;!v;){const e=await n.window.showQuickPick(t,{canPickMany:!1,title:i.selectSetting,ignoreFocusOut:!0});if(!e)return;if(e.isCreateNew){const e=null!==(r=await n.window.showInputBox({title:i.enterConnectionStringSettingName,ignoreFocusOut:!0,value:c?"":i.sqlConnectionStringSetting,validateInput:e=>e?void 0:i.nameMustNotBeEmpty}))&&void 0!==r?r:"";if(!e)continue;const t=null!==(l=await n.window.showInputBox({title:i.enterConnectionString,ignoreFocusOut:!0,value:"Server=localhost;Initial Catalog={db_name};User ID=sa;Password={your_password};Persist Security Info=False",validateInput:e=>e?void 0:i.valueMustNotBeEmpty}))&&void 0!==l?l:"";if(!t)continue;try{await s.setLocalAppSetting(o.dirname(y.fsPath),e,t)&&(v=e)}catch(e){n.window.showErrorMessage(a.getErrorMessage(e))}}else v=e.label}}else v=await n.window.showInputBox({prompt:i.connectionStringSetting,placeHolder:i.connectionStringSettingPlaceholder,ignoreFocusOut:!0});if(v){try{const t=await u.addSqlBinding(m.type,e.fsPath,h,g,v);if(!t.success)return n.window.showErrorMessage(t.errorMessage),void c.TelemetryReporter.sendErrorEvent(c.TelemetryViews.SqlBindingsQuickPick,c.TelemetryActions.finishAddSqlBinding);c.TelemetryReporter.createActionEvent(c.TelemetryViews.SqlBindingsQuickPick,c.TelemetryActions.finishAddSqlBinding).withAdditionalProperties({bindingType:m.label}).send()}catch(e){return n.window.showErrorMessage(a.getErrorMessage(e)),void c.TelemetryReporter.sendErrorEvent(c.TelemetryViews.SqlBindingsQuickPick,c.TelemetryActions.finishAddSqlBinding)}await t.addPackageToAFProjectContainingFile(e,i.sqlExtensionPackageName)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineAndColumnFromOffset=t.parseJson=void 0;const n=r(338),o=r(1);function i(e,t){const r=e.split("\n");let n=0,o=0,i=0;for(const e of r){o+=1;const r=e.length+1;if(n+=r,n>=t){i=t-(n-r);break}}return[o,i]}t.parseJson=function(e){65279===e.charCodeAt(0)&&(e=e.slice(1));const t=[],r=n.parse(e,t,{allowTrailingComma:!0});if(t.length>0){const[r,a]=i(e,t[0].offset);throw new Error(o.jsonParseError(n.printParseErrorCode(t[0].error),r,a))}return r},t.getLineAndColumnFromOffset=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageHelper=void 0;const n=r(2),o=r(3),i=r(123),a=r(1),s=r(43);t.PackageHelper=class{constructor(e){this.netCoreTool=new s.NetCoreTool(e),this._outputChannel=e}constructAddPackageArguments(e,t,r){const n=o.getQuotedPath(e.fsPath);return r?` add ${n} package ${t} -v ${r}`:` add ${n} package ${t} --prerelease`}async addPackage(e,t,r){const n={commandTitle:a.addPackage,argument:this.constructAddPackageArguments(e,t,r)};await this.netCoreTool.runDotnetCommand(n,!0)}async addPackageToAFProjectContainingFile(e,t,r){try{const o=await i.getAFProjectContainingFile(e);o?await this.addPackage(o,t,r):n.window.showInformationMessage(a.addPackageReferenceMessage,a.moreInformation).then(e=>{e===a.moreInformation&&n.env.openExternal(n.Uri.parse(a.sqlBindingsHelpLink))})}catch(e){await n.window.showErrorMessage(a.addSqlBindingPackageError,a.checkoutOutputMessage)===a.checkoutOutputMessage&&this._outputChannel.show()}}}},function(e,t,r){"use strict";function n(e,t){void 0===t&&(t=!1);var r=e.length,n=0,s="",c=0,l=16,u=0,p=0,d=0,h=0,f=0;function m(t,r){for(var o=0,i=0;o<t||!r;){var a=e.charCodeAt(n);if(a>=48&&a<=57)i=16*i+a-48;else if(a>=65&&a<=70)i=16*i+a-65+10;else{if(!(a>=97&&a<=102))break;i=16*i+a-97+10}n++,o++}return o<t&&(i=-1),i}function g(){if(s="",f=0,c=n,p=u,h=d,n>=r)return c=r,l=17;var t=e.charCodeAt(n);if(o(t)){do{n++,s+=String.fromCharCode(t),t=e.charCodeAt(n)}while(o(t));return l=15}if(i(t))return n++,s+=String.fromCharCode(t),13===t&&10===e.charCodeAt(n)&&(n++,s+="\n"),u++,d=n,l=14;switch(t){case 123:return n++,l=1;case 125:return n++,l=2;case 91:return n++,l=3;case 93:return n++,l=4;case 58:return n++,l=6;case 44:return n++,l=5;case 34:return n++,s=function(){for(var t="",o=n;;){if(n>=r){t+=e.substring(o,n),f=2;break}var a=e.charCodeAt(n);if(34===a){t+=e.substring(o,n),n++;break}if(92!==a){if(a>=0&&a<=31){if(i(a)){t+=e.substring(o,n),f=2;break}f=6}n++}else{if(t+=e.substring(o,n),++n>=r){f=2;break}switch(e.charCodeAt(n++)){case 34:t+='"';break;case 92:t+="\\";break;case 47:t+="/";break;case 98:t+="\b";break;case 102:t+="\f";break;case 110:t+="\n";break;case 114:t+="\r";break;case 116:t+="\t";break;case 117:var s=m(4,!0);s>=0?t+=String.fromCharCode(s):f=4;break;default:f=5}o=n}}return t}(),l=10;case 47:var g=n-1;if(47===e.charCodeAt(n+1)){for(n+=2;n<r&&!i(e.charCodeAt(n));)n++;return s=e.substring(g,n),l=12}if(42===e.charCodeAt(n+1)){n+=2;for(var v=r-1,b=!1;n<v;){var w=e.charCodeAt(n);if(42===w&&47===e.charCodeAt(n+1)){n+=2,b=!0;break}n++,i(w)&&(13===w&&10===e.charCodeAt(n)&&n++,u++,d=n)}return b||(n++,f=1),s=e.substring(g,n),l=13}return s+=String.fromCharCode(t),n++,l=16;case 45:if(s+=String.fromCharCode(t),++n===r||!a(e.charCodeAt(n)))return l=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return s+=function(){var t=n;if(48===e.charCodeAt(n))n++;else for(n++;n<e.length&&a(e.charCodeAt(n));)n++;if(n<e.length&&46===e.charCodeAt(n)){if(!(++n<e.length&&a(e.charCodeAt(n))))return f=3,e.substring(t,n);for(n++;n<e.length&&a(e.charCodeAt(n));)n++}var r=n;if(n<e.length&&(69===e.charCodeAt(n)||101===e.charCodeAt(n)))if((++n<e.length&&43===e.charCodeAt(n)||45===e.charCodeAt(n))&&n++,n<e.length&&a(e.charCodeAt(n))){for(n++;n<e.length&&a(e.charCodeAt(n));)n++;r=n}else f=3;return e.substring(t,r)}(),l=11;default:for(;n<r&&y(t);)n++,t=e.charCodeAt(n);if(c!==n){switch(s=e.substring(c,n)){case"true":return l=8;case"false":return l=9;case"null":return l=7}return l=16}return s+=String.fromCharCode(t),n++,l=16}}function y(e){if(o(e)||i(e))return!1;switch(e){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}return{setPosition:function(e){n=e,s="",c=0,l=16,f=0},getPosition:function(){return n},scan:t?function(){var e;do{e=g()}while(e>=12&&e<=15);return e}:g,getToken:function(){return l},getTokenValue:function(){return s},getTokenOffset:function(){return c},getTokenLength:function(){return n-c},getTokenStartLine:function(){return p},getTokenStartCharacter:function(){return c-h},getTokenError:function(){return f}}}function o(e){return 32===e||9===e||11===e||12===e||160===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function i(e){return 10===e||13===e||8232===e||8233===e}function a(e){return e>=48&&e<=57}function s(e,t,r){var o,i,a,s,u;if(t){for(s=t.offset,u=s+t.length,a=s;a>0&&!l(e,a-1);)a--;for(var p=u;p<e.length&&!l(e,p);)p++;i=e.substring(a,p),o=function(e,t){var r=0,n=0,o=t.tabSize||4;for(;r<e.length;){var i=e.charAt(r);if(" "===i)n++;else{if("\t"!==i)break;n+=o}r++}return Math.floor(n/o)}(i,r)}else i=e,o=0,a=0,s=0,u=e.length;var d,h=function(e,t){for(var r=0;r<t.length;r++){var n=t.charAt(r);if("\r"===n)return r+1<t.length&&"\n"===t.charAt(r+1)?"\r\n":"\r";if("\n"===n)return"\n"}return e&&e.eol||"\n"}(r,e),f=!1,m=0;d=r.insertSpaces?c(" ",r.tabSize||4):"\t";var g=n(i,!1),y=!1;function v(){return h+c(d,o+m)}function b(){var e=g.scan();for(f=!1;15===e||14===e;)f=f||14===e,e=g.scan();return y=16===e||0!==g.getTokenError(),e}var w=[];function S(t,r,n){!y&&r<u&&n>s&&e.substring(r,n)!==t&&w.push({offset:r,length:n-r,content:t})}var E=b();if(17!==E){var P=g.getTokenOffset()+a;S(c(d,o),a,P)}for(;17!==E;){for(var T=g.getTokenOffset()+g.getTokenLength()+a,_=b(),D="";!f&&(12===_||13===_);){S(" ",T,g.getTokenOffset()+a),T=g.getTokenOffset()+g.getTokenLength()+a,D=12===_?v():"",_=b()}if(2===_)1!==E&&(m--,D=v());else if(4===_)3!==E&&(m--,D=v());else{switch(E){case 3:case 1:m++,D=v();break;case 5:case 12:D=v();break;case 13:D=f?v():" ";break;case 6:D=" ";break;case 10:if(6===_){D="";break}case 7:case 8:case 9:case 11:case 2:case 4:12===_||13===_?D=" ":5!==_&&17!==_&&(y=!0);break;case 16:y=!0}!f||12!==_&&13!==_||(D=v())}S(D,T,g.getTokenOffset()+a),E=_}return w}function c(e,t){for(var r="",n=0;n<t;n++)r+=e;return r}function l(e,t){return-1!=="\r\n".indexOf(e.charAt(t))}var u;function p(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=u.DEFAULT);var n={type:"array",offset:-1,length:-1,children:[],parent:void 0};function o(e){"property"===n.type&&(n.length=e-n.offset,n=n.parent)}function i(e){return n.children.push(e),e}h(e,{onObjectBegin:function(e){n=i({type:"object",offset:e,length:-1,parent:n,children:[]})},onObjectProperty:function(e,t,r){(n=i({type:"property",offset:t,length:-1,parent:n,children:[]})).children.push({type:"string",value:e,offset:t,length:r,parent:n})},onObjectEnd:function(e,t){o(e+t),n.length=e+t-n.offset,n=n.parent,o(e+t)},onArrayBegin:function(e,t){n=i({type:"array",offset:e,length:-1,parent:n,children:[]})},onArrayEnd:function(e,t){n.length=e+t-n.offset,n=n.parent,o(e+t)},onLiteralValue:function(e,t,r){i({type:f(e),offset:t,length:r,parent:n,value:e}),o(t+r)},onSeparator:function(e,t,r){"property"===n.type&&(":"===e?n.colonOffset=t:","===e&&o(t))},onError:function(e,r,n){t.push({error:e,offset:r,length:n})}},r);var a=n.children[0];return a&&delete a.parent,a}function d(e,t){if(e){for(var r=e,n=0,o=t;n<o.length;n++){var i=o[n];if("string"==typeof i){if("object"!==r.type||!Array.isArray(r.children))return;for(var a=!1,s=0,c=r.children;s<c.length;s++){var l=c[s];if(Array.isArray(l.children)&&l.children[0].value===i){r=l.children[1],a=!0;break}}if(!a)return}else{var u=i;if("array"!==r.type||u<0||!Array.isArray(r.children)||u>=r.children.length)return;r=r.children[u]}}return r}}function h(e,t,r){void 0===r&&(r=u.DEFAULT);var o=n(e,!1);function i(e){return e?function(){return e(o.getTokenOffset(),o.getTokenLength(),o.getTokenStartLine(),o.getTokenStartCharacter())}:function(){return!0}}function a(e){return e?function(t){return e(t,o.getTokenOffset(),o.getTokenLength(),o.getTokenStartLine(),o.getTokenStartCharacter())}:function(){return!0}}var s=i(t.onObjectBegin),c=a(t.onObjectProperty),l=i(t.onObjectEnd),p=i(t.onArrayBegin),d=i(t.onArrayEnd),h=a(t.onLiteralValue),f=a(t.onSeparator),m=i(t.onComment),g=a(t.onError),y=r&&r.disallowComments,v=r&&r.allowTrailingComma;function b(){for(;;){var e=o.scan();switch(o.getTokenError()){case 4:w(14);break;case 5:w(15);break;case 3:w(13);break;case 1:y||w(11);break;case 2:w(12);break;case 6:w(16)}switch(e){case 12:case 13:y?w(10):m();break;case 16:w(1);break;case 15:case 14:break;default:return e}}}function w(e,t,r){if(void 0===t&&(t=[]),void 0===r&&(r=[]),g(e),t.length+r.length>0)for(var n=o.getToken();17!==n;){if(-1!==t.indexOf(n)){b();break}if(-1!==r.indexOf(n))break;n=b()}}function S(e){var t=o.getTokenValue();return e?h(t):c(t),b(),!0}function E(){switch(o.getToken()){case 3:return function(){p(),b();for(var e=!1;4!==o.getToken()&&17!==o.getToken();){if(5===o.getToken()){if(e||w(4,[],[]),f(","),b(),4===o.getToken()&&v)break}else e&&w(6,[],[]);E()||w(4,[],[4,5]),e=!0}return d(),4!==o.getToken()?w(8,[4],[]):b(),!0}();case 1:return function(){s(),b();for(var e=!1;2!==o.getToken()&&17!==o.getToken();){if(5===o.getToken()){if(e||w(4,[],[]),f(","),b(),2===o.getToken()&&v)break}else e&&w(6,[],[]);(10!==o.getToken()?(w(3,[],[2,5]),0):(S(!1),6===o.getToken()?(f(":"),b(),E()||w(4,[],[2,5])):w(5,[],[2,5]),1))||w(4,[],[2,5]),e=!0}return l(),2!==o.getToken()?w(7,[2],[]):b(),!0}();case 10:return S(!0);default:return function(){switch(o.getToken()){case 11:var e=o.getTokenValue(),t=Number(e);isNaN(t)&&(w(2),t=0),h(t);break;case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return b(),!0}()}}return b(),17===o.getToken()?!!r.allowEmptyContent||(w(4,[],[]),!1):E()?(17!==o.getToken()&&w(9,[],[]),!0):(w(4,[],[]),!1)}function f(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":return e?Array.isArray(e)?"array":"object":"null";default:return"null"}}function m(e,t,r,n){for(var o,i=t.slice(),a=p(e,[]),s=void 0,c=void 0;i.length>0&&(c=i.pop(),void 0===(s=d(a,i))&&void 0!==r);)"string"==typeof c?((o={})[c]=r,r=o):r=[r];if(s){if("object"===s.type&&"string"==typeof c&&Array.isArray(s.children)){var l=d(s,[c]);if(void 0!==l){if(void 0===r){if(!l.parent)throw new Error("Malformed AST");var u=s.children.indexOf(l.parent),h=void 0,f=l.parent.offset+l.parent.length;if(u>0)h=(P=s.children[u-1]).offset+P.length;else if(h=s.offset+1,s.children.length>1)f=s.children[1].offset;return g(e,{offset:h,length:f-h,content:""},n)}return g(e,{offset:l.offset,length:l.length,content:JSON.stringify(r)},n)}if(void 0===r)return[];var m=JSON.stringify(c)+": "+JSON.stringify(r),y=void 0;return g(e,y=(T=n.getInsertionIndex?n.getInsertionIndex(s.children.map((function(e){return e.children[0].value}))):s.children.length)>0?{offset:(P=s.children[T-1]).offset+P.length,length:0,content:","+m}:0===s.children.length?{offset:s.offset+1,length:0,content:m}:{offset:s.offset+1,length:0,content:m+","},n)}if("array"===s.type&&"number"==typeof c&&Array.isArray(s.children)){var v=c;if(-1===v){m=""+JSON.stringify(r),y=void 0;if(0===s.children.length)y={offset:s.offset+1,length:0,content:m};else y={offset:(P=s.children[s.children.length-1]).offset+P.length,length:0,content:","+m};return g(e,y,n)}if(void 0===r&&s.children.length>=0){var b=c,w=s.children[b];y=void 0;if(1===s.children.length)y={offset:s.offset+1,length:s.length-2,content:""};else if(s.children.length-1===b){var S=(P=s.children[b-1]).offset+P.length;y={offset:S,length:s.offset+s.length-2-S,content:""}}else y={offset:w.offset,length:s.children[b+1].offset-w.offset,content:""};return g(e,y,n)}if(void 0!==r){y=void 0,m=""+JSON.stringify(r);if(!n.isArrayInsertion&&s.children.length>c){var E=s.children[c];y={offset:E.offset,length:E.length,content:m}}else if(0===s.children.length||0===c)y={offset:s.offset+1,length:0,content:0===s.children.length?m:m+","};else{var P,T=c>s.children.length?s.children.length:c;y={offset:(P=s.children[T-1]).offset+P.length,length:0,content:","+m}}return g(e,y,n)}throw new Error("Can not "+(void 0===r?"remove":n.isArrayInsertion?"insert":"modify")+" Array index "+v+" as length is not sufficient")}throw new Error("Can not add "+("number"!=typeof c?"index":"property")+" to parent of type "+s.type)}if(void 0===r)throw new Error("Can not delete in empty document");return g(e,{offset:a?a.offset:0,length:a?a.length:0,content:JSON.stringify(r)},n)}function g(e,t,r){if(!r.formattingOptions)return[t];var n=y(e,t),o=t.offset,i=t.offset+t.content.length;if(0===t.length||0===t.content.length){for(;o>0&&!l(n,o-1);)o--;for(;i<n.length&&!l(n,i);)i++}for(var a=s(n,{offset:o,length:i-o},r.formattingOptions),c=a.length-1;c>=0;c--){var u=a[c];n=y(n,u),o=Math.min(o,u.offset),i=Math.max(i,u.offset+u.length),i+=u.content.length-u.length}return[{offset:o,length:e.length-(n.length-i)-o,content:n.substring(o,i)}]}function y(e,t){return e.substring(0,t.offset)+t.content+e.substring(t.offset+t.length)}r.r(t),r.d(t,"createScanner",(function(){return v})),r.d(t,"getLocation",(function(){return b})),r.d(t,"parse",(function(){return w})),r.d(t,"parseTree",(function(){return S})),r.d(t,"findNodeAtLocation",(function(){return E})),r.d(t,"findNodeAtOffset",(function(){return P})),r.d(t,"getNodePath",(function(){return T})),r.d(t,"getNodeValue",(function(){return _})),r.d(t,"visit",(function(){return D})),r.d(t,"stripComments",(function(){return C})),r.d(t,"printParseErrorCode",(function(){return x})),r.d(t,"format",(function(){return I})),r.d(t,"modify",(function(){return j})),r.d(t,"applyEdits",(function(){return N})),function(e){e.DEFAULT={allowTrailingComma:!1}}(u||(u={}));var v=n,b=function(e,t){var r=[],n=new Object,o=void 0,i={value:{},offset:0,length:0,type:"object",parent:void 0},a=!1;function s(e,t,r,n){i.value=e,i.offset=t,i.length=r,i.type=n,i.colonOffset=void 0,o=i}try{h(e,{onObjectBegin:function(e,i){if(t<=e)throw n;o=void 0,a=t>e,r.push("")},onObjectProperty:function(e,o,i){if(t<o)throw n;if(s(e,o,i,"property"),r[r.length-1]=e,t<=o+i)throw n},onObjectEnd:function(e,i){if(t<=e)throw n;o=void 0,r.pop()},onArrayBegin:function(e,i){if(t<=e)throw n;o=void 0,r.push(0)},onArrayEnd:function(e,i){if(t<=e)throw n;o=void 0,r.pop()},onLiteralValue:function(e,r,o){if(t<r)throw n;if(s(e,r,o,f(e)),t<=r+o)throw n},onSeparator:function(e,i,s){if(t<=i)throw n;if(":"===e&&o&&"property"===o.type)o.colonOffset=i,a=!1,o=void 0;else if(","===e){var c=r[r.length-1];"number"==typeof c?r[r.length-1]=c+1:(a=!0,r[r.length-1]=""),o=void 0}}})}catch(e){if(e!==n)throw e}return{path:r,previousNode:o,isAtPropertyKey:a,matches:function(e){for(var t=0,n=0;t<e.length&&n<r.length;n++)if(e[t]===r[n]||"*"===e[t])t++;else if("**"!==e[t])return!1;return t===e.length}}},w=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=u.DEFAULT);var n=null,o=[],i=[];function a(e){Array.isArray(o)?o.push(e):null!==n&&(o[n]=e)}return h(e,{onObjectBegin:function(){var e={};a(e),i.push(o),o=e,n=null},onObjectProperty:function(e){n=e},onObjectEnd:function(){o=i.pop()},onArrayBegin:function(){var e=[];a(e),i.push(o),o=e,n=null},onArrayEnd:function(){o=i.pop()},onLiteralValue:a,onError:function(e,r,n){t.push({error:e,offset:r,length:n})}},r),o[0]},S=p,E=d,P=function e(t,r,n){if(void 0===n&&(n=!1),function(e,t,r){return void 0===r&&(r=!1),t>=e.offset&&t<e.offset+e.length||r&&t===e.offset+e.length}(t,r,n)){var o=t.children;if(Array.isArray(o))for(var i=0;i<o.length&&o[i].offset<=r;i++){var a=e(o[i],r,n);if(a)return a}return t}},T=function e(t){if(!t.parent||!t.parent.children)return[];var r=e(t.parent);if("property"===t.parent.type){var n=t.parent.children[0].value;r.push(n)}else if("array"===t.parent.type){var o=t.parent.children.indexOf(t);-1!==o&&r.push(o)}return r},_=function e(t){switch(t.type){case"array":return t.children.map(e);case"object":for(var r=Object.create(null),n=0,o=t.children;n<o.length;n++){var i=o[n],a=i.children[1];a&&(r[i.children[0].value]=e(a))}return r;case"null":case"string":case"number":case"boolean":return t.value;default:return}},D=h,C=function(e,t){var r,o,i=n(e),a=[],s=0;do{switch(o=i.getPosition(),r=i.scan()){case 12:case 13:case 17:s!==o&&a.push(e.substring(s,o)),void 0!==t&&a.push(i.getTokenValue().replace(/[^\r\n]/g,t)),s=i.getPosition()}}while(17!==r);return a.join("")};function x(e){switch(e){case 1:return"InvalidSymbol";case 2:return"InvalidNumberFormat";case 3:return"PropertyNameExpected";case 4:return"ValueExpected";case 5:return"ColonExpected";case 6:return"CommaExpected";case 7:return"CloseBraceExpected";case 8:return"CloseBracketExpected";case 9:return"EndOfFileExpected";case 10:return"InvalidCommentToken";case 11:return"UnexpectedEndOfComment";case 12:return"UnexpectedEndOfString";case 13:return"UnexpectedEndOfNumber";case 14:return"InvalidUnicode";case 15:return"InvalidEscapeCharacter";case 16:return"InvalidCharacter"}return"<unknown ParseErrorCode>"}function I(e,t,r){return s(e,t,r)}function j(e,t,r,n){return m(e,t,r,n)}function N(e,t){for(var r=t.length-1;r>=0;r--)e=y(e,t[r]);return e}}]));
//# sourceMappingURL=https://sqlopsbuilds.blob.core.windows.net/sourcemaps/d0517d8e301ccb71ce43ee8c865ad0285506d4ac/extensions/sql-database-projects/dist/extension.js.map